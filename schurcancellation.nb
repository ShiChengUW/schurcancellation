(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    562065,      14002]
NotebookOptionsPosition[    542061,      13762]
NotebookOutlinePosition[    542433,      13778]
CellTagsIndexPosition[    542390,      13775]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["", "Subsubsection",
 CellChangeTimes->{{3.704380051643804*^9, 3.704380058570722*^9}, 
   3.740117719761499*^9},ExpressionUUID->"3214bd52-3ac3-470e-9c33-\
0eb339b98617"],

Cell[CellGroupData[{

Cell["Note:", "Subsection",
 CellChangeTimes->{{3.740117723367881*^9, 
  3.7401177248221073`*^9}},ExpressionUUID->"4e0797a1-2331-4584-b85a-\
d10ee4232820"],

Cell["This program and \[OpenCurlyDoubleQuote]simple Round shur\
\[CloseCurlyDoubleQuote] are made by Shi Cheng.", "Text",
 CellChangeTimes->{{3.7212903658097973`*^9, 
  3.7212904237642384`*^9}},ExpressionUUID->"05bfe0f4-8cc2-48b3-9057-\
d662e710c60b"],

Cell[TextData[{
 "Note: \n\n1. \nIn order to use the \[OpenCurlyDoubleQuote]Vertex\
\[CloseCurlyDoubleQuote] to canculate partition function, one may be note \
that this program itself is not complete, you also need another program \
called \[OpenCurlyDoubleQuote]arrow round shur\[CloseCurlyDoubleQuote]. Be \
sure that runing this whole \[OpenCurlyDoubleQuote]shurcancellation\
\[CloseCurlyDoubleQuote] to get the program ready.\n\n2. \n In order to use \
this program to expand the partition, you need to redefine partition function \
Z[\[Nu]1,\[Nu]2,\[Nu]3, ...] for different toric diagrams, but it is almost \
automatic, as shown in example document. \n\nThis pargram is used for \
expanding limited number of instantons (at most ten, it is enough, right?), \
for limited number of Young diagrams ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "i"], TraditionalForm]],ExpressionUUID->
  "f9c66509-2883-4cfa-901a-bed04477d986"],
 " from 1...10, 11, 12,14, 18. Anyone can make small change to the code to \
expand partition function with other numbers of left young diagrams ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "i"], TraditionalForm]],ExpressionUUID->
  "d4de908c-cae0-47d2-bc94-e40a9f84ca91"],
 ", such as 13, 15 or 16,  I just too lazy to add more, see the BIG word \
shade with",
 StyleBox[" bright YELLOW color like this ",
  Background->RGBColor[1, 1, 0]],
 "in the program (Only TWO parts in this program were shaded with this \
color). \n\n3.\nThe procedure of using the program: Firstly, run the whole \
\[OpenCurlyDoubleQuote]shurcancellation\[CloseCurlyDoubleQuote]; Secondly, \
open a new document and type in your topological vertex data C[{ t, q, hi, \
\[Mu]^T, \[Nu], \[Lambda]}]  into ~topvex~ , and L[Q,\[Alpha]] pf[...]f[...] \
into ~legfac~. You can change the name ~topvex~ and ~legfac~ to anything in \
\[OpenCurlyDoubleQuote]arrow round shur\[CloseCurlyDoubleQuote], if you like \
more fancy name. Now, when the initial input data ~topvex~ and ~legfac~  is \
ready, you run the whole \[OpenCurlyDoubleQuote]arrow round shur\
\[CloseCurlyDoubleQuote] to get the partition function, you can read \
\[OpenCurlyDoubleQuote]arrow round shur\[CloseCurlyDoubleQuote] to see which \
output is partition function. Be notice that you can safely run \
\[OpenCurlyDoubleQuote]arrow round shur\[CloseCurlyDoubleQuote] repeatedly, \
the output would be the same. Finally, if one want to expand partition \
function, one can just copy the result to define function Z[\[Nu]1,\[Nu]2,\
\[Nu]3, ...]  and extract n-instanton contribution, see example to know how \
to do that. \n\n4. \n\[OpenCurlyDoubleQuote]shurcancellation\
\[CloseCurlyDoubleQuote] is not readable, and only \
\[OpenCurlyDoubleQuote]arrow round shur\[CloseCurlyDoubleQuote] is readable. \
We do not wish any reader to understand this code, since this program is a \
mess and has some useless code as well, and even I sometimes cannot read it. \
Actually, it is not necessary to read it, one can just use it, see the \
example to know how to use it. This program has passed many nontrivial tests \
and I am sure it is correct. If you find it cannot feed back answer, just \
check the initial data or some typos, or framing numbers. If you find it feed \
back wrong answers, please contact me, I have a more silly version, my email \
is   chengshi11@mails.ucas.ac.cn  \n\nThe basic logic of this program is \
that: use SameQ, Exp[x], Log[x]  to teach Mathematica to recognize letters. \
Then put useful data of topological vertex into lists. Finally, turn output \
into functions which could be defined and expanded.\n\nThanks very much."
}], "Text",
 CellChangeTimes->{{3.7043630284673243`*^9, 3.7043632623540773`*^9}, {
   3.704363585481291*^9, 3.7043636928415127`*^9}, {3.704379431812441*^9, 
   3.704379960084098*^9}, {3.704379993991626*^9, 3.704380009987815*^9}, 
   3.704380112756793*^9, {3.704380145609133*^9, 3.7043801932944107`*^9}, {
   3.704380247805593*^9, 3.7043802490888968`*^9}, {3.704380401510845*^9, 
   3.7043804373768597`*^9}, {3.704380531497875*^9, 3.704380535221181*^9}, {
   3.7082524574122562`*^9, 3.708252698022472*^9}, {3.708252729920074*^9, 
   3.7082528390343323`*^9}, {3.708252874872066*^9, 3.708252993990395*^9}, {
   3.708253047193482*^9, 3.7082530925030823`*^9}, {3.70825313375879*^9, 
   3.708253184686475*^9}, 3.721290354868567*^9, 3.721290430817081*^9, {
   3.740108331583496*^9, 3.7401083558719187`*^9}, {3.740109102369431*^9, 
   3.740110746121862*^9}, {3.740110895715784*^9, 3.740110957477915*^9}, {
   3.740112881500167*^9, 3.740113196368823*^9}, {3.740114227832111*^9, 
   3.740114470543292*^9}, {3.74011453828198*^9, 3.740114566962105*^9}, {
   3.74011465475281*^9, 3.740114655596911*^9}, {3.740116850728059*^9, 
   3.740116851070138*^9}, {3.740116971085062*^9, 3.740116973960936*^9}, {
   3.74011722866219*^9, 3.740117243859377*^9}, {3.740117740610126*^9, 
   3.740117849046678*^9}, {3.740126670969832*^9, 3.740126681228161*^9}, {
   3.740127325967811*^9, 
   3.740127365151784*^9}},ExpressionUUID->"c975a68a-856f-4a45-8cde-\
b9a3ded771d2"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Definition for      ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "uv\[Lambda]"], "(", 
    RowBox[{"t", ",", "q"}], ")"}], TraditionalForm]],ExpressionUUID->
  "8f549a75-3ec9-4cc0-9522-8a536985078a"],
 ",  and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"  ", 
    RowBox[{
     RowBox[{
      SubscriptBox["pf", "u"], "(", 
      RowBox[{"t", ",", "q"}], ")"}], ",", "   ", 
     RowBox[{
      RowBox[{
       SubscriptBox["f", "u"], "(", 
       RowBox[{"t", ",", "q"}], ")"}], ".", " "}]}]}], TraditionalForm]],
  ExpressionUUID->"5e1e0a25-de83-4cae-a2e2-5ddfd336ea21"]
}], "Subsection",
 CellChangeTimes->{{3.72551921874842*^9, 3.725519288596766*^9}, {
   3.740113260007037*^9, 3.7401133032658787`*^9}, 3.740113827655088*^9, {
   3.740128073842404*^9, 
   3.740128083702649*^9}},ExpressionUUID->"bd703a7a-d36a-4a87-b558-\
025cf0e64b1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aZZZCC", "[", 
   RowBox[{"{", 
    RowBox[{
    "t_", ",", "q_", ",", "h_", ",", "u_", ",", "su_", ",", "v_", ",", "sv_", 
     ",", "\[Lambda]_", ",", "s\[Lambda]_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"s\[Lambda]", "\[Equal]", "1"}], ",", 
    RowBox[{
     SubscriptBox["Z", "\[Lambda]"], "[", 
     RowBox[{"t", ",", "q"}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"s\[Lambda]", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       SubscriptBox["Z", 
        RowBox[{"\[Lambda]", "^", "T"}]], "[", 
       RowBox[{"t", ",", "q"}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"areorderZZZCC", "[", 
   RowBox[{"{", 
    RowBox[{
    "t_", ",", "q_", ",", "h_", ",", "u_", ",", "su_", ",", "v_", ",", "sv_", 
     ",", "\[Lambda]_", ",", "s\[Lambda]_"}], "}"}], "]"}], ":=", 
  RowBox[{"aZZZCC", "[", 
   RowBox[{"{", 
    RowBox[{
    "t", ",", "q", ",", "h", ",", "u", ",", "su", ",", "v", ",", "sv", ",", 
     "\[Lambda]", ",", "s\[Lambda]"}], "}"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aZZZCC", "::", "usage"}], "=", 
    "\"\< only extract \!\(\*SubscriptBox[\(Z\), \(\[Lambda]\)]\)[t,q] \
insider of \!\(\*SubscriptBox[\(C\), \(u\\\ v\\\ \[Lambda]\)]\)[t,q]\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aExtractZZZ", "[", "a_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exp", "=", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "/.", 
        RowBox[{"{", 
         RowBox[{"C", "\[Rule]", "dataC"}], "}"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"C", "\[Rule]", "areorderZZZCC"}], "}"}]}], "//", 
     "SIMplify"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aExtractZZZ", " ", "::", "usage"}], "=", 
    "\"\< only extract \!\(\*SubscriptBox[\(Z\), \(\[Lambda]\)]\)[t,q] \
insider of initial input data ~topvex~.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aZZZ", "[", "topvex_", "]"}], ":=", 
  RowBox[{"topvex", "//", "aExtractZZZ"}]}]}], "Input",
 CellChangeTimes->{
  3.725513286504703*^9, {3.7255133259164333`*^9, 3.72551344857657*^9}, {
   3.7255136334507*^9, 3.725513633609651*^9}, {3.725513719767604*^9, 
   3.725513738427087*^9}, {3.725514019397973*^9, 3.7255140197777576`*^9}, {
   3.7255145612669764`*^9, 3.725514570122593*^9}, {3.72552593570408*^9, 
   3.725525939615596*^9}, {3.7255260194017687`*^9, 3.725526021732347*^9}, {
   3.740106454399858*^9, 3.740106576046694*^9}, {3.740106879845704*^9, 
   3.740106954096792*^9}, {3.7401072172862167`*^9, 3.740107256310884*^9}, {
   3.740107883673872*^9, 3.740107885718939*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f3cc5a72-9a3c-40a8-9053-eca80c5c9a71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aqCC", "[", 
   RowBox[{"{", 
    RowBox[{
    "t_", ",", "q_", ",", "h_", ",", "\[Mu]_", ",", "su_", ",", "\[Nu]_", ",",
      "sv_", ",", "\[Lambda]_", ",", "s\[Lambda]_"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"su", "\[Equal]", "1"}], "&&", 
     RowBox[{"sv", "\[Equal]", "1"}], "&&", 
     RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["q", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"h", "+", 
          SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", "\[Nu]", "+", 
          SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
      SuperscriptBox["t", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
          RowBox[{"T", " ", 
           SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
      RowBox[{
       SubscriptBox["Z", "\[Lambda]"], "[", 
       RowBox[{"t", ",", "q"}], "]"}], " ", 
      RowBox[{
       SubscriptBox["s", 
        RowBox[{
         SuperscriptBox["\[Mu]", "T"], ",", "h"}]], "[", 
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{"-", "\[Lambda]"}]], " ", 
        SuperscriptBox["t", 
         RowBox[{"-", "p"}]]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["s", 
        RowBox[{"\[Nu]", ",", "h"}]], "[", 
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{"-", "p"}]], " ", 
        SuperscriptBox["t", 
         RowBox[{"-", 
          SuperscriptBox["\[Lambda]", "T"]}]]}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"su", "\[Equal]", "1"}], "&&", 
       RowBox[{"sv", "\[Equal]", "1"}], "&&", 
       RowBox[{"s\[Lambda]", "\[Equal]", 
        RowBox[{"-", "1"}]}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"h", "+", 
            RowBox[{"T", " ", 
             SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", "\[Nu]", 
            "+", 
            SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
        SuperscriptBox["t", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
            RowBox[{"T", " ", 
             SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
        RowBox[{
         SubscriptBox["Z", 
          SuperscriptBox["\[Lambda]", "T"]], "[", 
         RowBox[{"t", ",", "q"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{
           SuperscriptBox["\[Mu]", "T"], ",", "h"}]], "[", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", 
            SuperscriptBox["\[Lambda]", "T"]}]], " ", 
          SuperscriptBox["t", 
           RowBox[{"-", "p"}]]}], "]"}], " ", 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{"\[Nu]", ",", "h"}]], "[", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", "p"}]], " ", 
          SuperscriptBox["t", 
           RowBox[{"-", "\[Lambda]"}]]}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"su", "\[Equal]", "1"}], "&&", 
         RowBox[{"sv", "\[Equal]", 
          RowBox[{"-", "1"}]}], "&&", 
         RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"h", "+", 
              SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", "\[Nu]", 
              "+", 
              RowBox[{"T", " ", 
               SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
          SuperscriptBox["t", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
              SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
          RowBox[{
           SubscriptBox["Z", "\[Lambda]"], "[", 
           RowBox[{"t", ",", "q"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["s", 
            RowBox[{
             SuperscriptBox["\[Mu]", "T"], ",", "h"}]], "[", 
           RowBox[{
            SuperscriptBox["q", 
             RowBox[{"-", "\[Lambda]"}]], " ", 
            SuperscriptBox["t", 
             RowBox[{"-", "p"}]]}], "]"}], " ", 
          RowBox[{
           SubscriptBox["s", 
            RowBox[{
             SuperscriptBox["\[Nu]", "T"], ",", "h"}]], "[", 
           RowBox[{
            SuperscriptBox["q", 
             RowBox[{"-", "p"}]], " ", 
            SuperscriptBox["t", 
             RowBox[{"-", 
              SuperscriptBox["\[Lambda]", "T"]}]]}], "]"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"su", "\[Equal]", 
            RowBox[{"-", "1"}]}], "&&", 
           RowBox[{"sv", "\[Equal]", "1"}], "&&", 
           RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["q", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"h", "+", 
                SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", "\[Nu]", 
                "+", 
                SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
            SuperscriptBox["t", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                RowBox[{"T", " ", 
                 SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
            RowBox[{
             SubscriptBox["Z", "\[Lambda]"], "[", 
             RowBox[{"t", ",", "q"}], "]"}], " ", 
            RowBox[{
             SubscriptBox["s", 
              RowBox[{"\[Mu]", ",", "h"}]], "[", 
             RowBox[{
              SuperscriptBox["q", 
               RowBox[{"-", "\[Lambda]"}]], " ", 
              SuperscriptBox["t", 
               RowBox[{"-", "p"}]]}], "]"}], " ", 
            RowBox[{
             SubscriptBox["s", 
              RowBox[{"\[Nu]", ",", "h"}]], "[", 
             RowBox[{
              SuperscriptBox["q", 
               RowBox[{"-", "p"}]], " ", 
              SuperscriptBox["t", 
               RowBox[{"-", 
                SuperscriptBox["\[Lambda]", "T"]}]]}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"su", "\[Equal]", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{"sv", "\[Equal]", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
            RowBox[{
             RowBox[{
              SuperscriptBox["q", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"h", "+", 
                  SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", 
                  "\[Nu]", "+", 
                  RowBox[{"T", " ", 
                   SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
              SuperscriptBox["t", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                  SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
              RowBox[{
               SubscriptBox["Z", "\[Lambda]"], "[", 
               RowBox[{"t", ",", "q"}], "]"}], " ", 
              RowBox[{
               SubscriptBox["s", 
                RowBox[{"\[Mu]", ",", "h"}]], "[", 
               RowBox[{
                SuperscriptBox["q", 
                 RowBox[{"-", "\[Lambda]"}]], " ", 
                SuperscriptBox["t", 
                 RowBox[{"-", "p"}]]}], "]"}], " ", 
              RowBox[{
               SubscriptBox["s", 
                RowBox[{
                 SuperscriptBox["\[Nu]", "T"], ",", "h"}]], "[", 
               RowBox[{
                SuperscriptBox["q", 
                 RowBox[{"-", "p"}]], " ", 
                SuperscriptBox["t", 
                 RowBox[{"-", 
                  SuperscriptBox["\[Lambda]", "T"]}]]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"su", "\[Equal]", 
                RowBox[{"-", "1"}]}], "&&", 
               RowBox[{"sv", "\[Equal]", "1"}], "&&", 
               RowBox[{"s\[Lambda]", "\[Equal]", 
                RowBox[{"-", "1"}]}]}], ",", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q", 
                 RowBox[{
                  FractionBox["1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"h", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", 
                    "\[Nu]", "+", 
                    SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
                SuperscriptBox["t", 
                 RowBox[{
                  FractionBox["1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
                RowBox[{
                 SubscriptBox["Z", 
                  SuperscriptBox["\[Lambda]", "T"]], "[", 
                 RowBox[{"t", ",", "q"}], "]"}], " ", 
                RowBox[{
                 SubscriptBox["s", 
                  RowBox[{"\[Mu]", ",", "h"}]], "[", 
                 RowBox[{
                  SuperscriptBox["q", 
                   RowBox[{"-", 
                    SuperscriptBox["\[Lambda]", "T"]}]], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"-", "p"}]]}], "]"}], " ", 
                RowBox[{
                 SubscriptBox["s", 
                  RowBox[{"\[Nu]", ",", "h"}]], "[", 
                 RowBox[{
                  SuperscriptBox["q", 
                   RowBox[{"-", "p"}]], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"-", "\[Lambda]"}]]}], "]"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"su", "\[Equal]", "1"}], "&&", 
                 RowBox[{"sv", "\[Equal]", 
                  RowBox[{"-", "1"}]}], "&&", 
                 RowBox[{"s\[Lambda]", "\[Equal]", 
                  RowBox[{"-", "1"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["q", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"h", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", 
                    "\[Nu]", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
                  SuperscriptBox["t", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                    SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
                  RowBox[{
                   SubscriptBox["Z", 
                    SuperscriptBox["\[Lambda]", "T"]], "[", 
                   RowBox[{"t", ",", "q"}], "]"}], " ", 
                  RowBox[{
                   SubscriptBox["s", 
                    RowBox[{
                    SuperscriptBox["\[Mu]", "T"], ",", "h"}]], "[", 
                   RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", 
                    SuperscriptBox["\[Lambda]", "T"]}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "p"}]]}], "]"}], " ", 
                  RowBox[{
                   SubscriptBox["s", 
                    RowBox[{
                    SuperscriptBox["\[Nu]", "T"], ",", "h"}]], "[", 
                   RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", "p"}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "\[Lambda]"}]]}], "]"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"su", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "&&", 
                   RowBox[{"sv", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "&&", 
                   RowBox[{"s\[Lambda]", "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], ",", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"h", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", 
                    "\[Nu]", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                    SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
                    RowBox[{
                    SubscriptBox["Z", 
                    SuperscriptBox["\[Lambda]", "T"]], "[", 
                    RowBox[{"t", ",", "q"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["s", 
                    RowBox[{"\[Mu]", ",", "h"}]], "[", 
                    RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", 
                    SuperscriptBox["\[Lambda]", "T"]}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "p"}]]}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["s", 
                    RowBox[{
                    SuperscriptBox["\[Nu]", "T"], ",", "h"}]], "[", 
                    RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", "p"}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "\[Lambda]"}]]}], "]"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
         "]"}]}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aqCC", "::", "usage"}], "=", 
    "\"\< only give definition to \!\(\*SubscriptBox[\(C\), \(u\\\ v\\\ \
\[Lambda]\)]\)[t,q] \>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"apppCC", "[", 
   RowBox[{"{", 
    RowBox[{
    "t_", ",", "q_", ",", "h_", ",", "\[Mu]_", ",", "su_", ",", "\[Nu]_", ",",
      "sv_", ",", "\[Lambda]_", ",", "s\[Lambda]_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"su", "\[Equal]", "1"}], "&&", 
     RowBox[{"sv", "\[Equal]", "1"}], "&&", 
     RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["q", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"h", "+", 
          SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", "\[Nu]", "+", 
          SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
      SuperscriptBox["t", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
          RowBox[{"T", " ", 
           SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"su", "\[Equal]", "1"}], "&&", 
       RowBox[{"sv", "\[Equal]", "1"}], "&&", 
       RowBox[{"s\[Lambda]", "\[Equal]", 
        RowBox[{"-", "1"}]}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"h", "+", 
            RowBox[{"T", " ", 
             SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", "\[Nu]", 
            "+", 
            SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
        SuperscriptBox["t", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
            RowBox[{"T", " ", 
             SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"su", "\[Equal]", "1"}], "&&", 
         RowBox[{"sv", "\[Equal]", 
          RowBox[{"-", "1"}]}], "&&", 
         RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"h", "+", 
              SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", "\[Nu]", 
              "+", 
              RowBox[{"T", " ", 
               SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
          SuperscriptBox["t", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
              SuperscriptBox["\[Nu]", "2"]}], ")"}]}]]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"su", "\[Equal]", 
            RowBox[{"-", "1"}]}], "&&", 
           RowBox[{"sv", "\[Equal]", "1"}], "&&", 
           RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["q", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"h", "+", 
                SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", "\[Nu]", 
                "+", 
                SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
            SuperscriptBox["t", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                RowBox[{"T", " ", 
                 SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"su", "\[Equal]", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{"sv", "\[Equal]", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
            RowBox[{
             RowBox[{
              SuperscriptBox["q", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"h", "+", 
                  SuperscriptBox["\[Lambda]", "2"], "+", "\[Mu]", "-", 
                  "\[Nu]", "+", 
                  RowBox[{"T", " ", 
                   SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
              SuperscriptBox["t", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                  SuperscriptBox["\[Nu]", "2"]}], ")"}]}]]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"su", "\[Equal]", 
                RowBox[{"-", "1"}]}], "&&", 
               RowBox[{"sv", "\[Equal]", "1"}], "&&", 
               RowBox[{"s\[Lambda]", "\[Equal]", 
                RowBox[{"-", "1"}]}]}], ",", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q", 
                 RowBox[{
                  FractionBox["1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"h", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", 
                    "\[Nu]", "+", 
                    SuperscriptBox["\[Nu]", "2"]}], ")"}]}]], " ", 
                SuperscriptBox["t", 
                 RowBox[{
                  FractionBox["1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"su", "\[Equal]", "1"}], "&&", 
                 RowBox[{"sv", "\[Equal]", 
                  RowBox[{"-", "1"}]}], "&&", 
                 RowBox[{"s\[Lambda]", "\[Equal]", 
                  RowBox[{"-", "1"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["q", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"h", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", 
                    "\[Nu]", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
                  SuperscriptBox["t", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                    SuperscriptBox["\[Nu]", "2"]}], ")"}]}]]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"su", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "&&", 
                   RowBox[{"sv", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "&&", 
                   RowBox[{"s\[Lambda]", "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], ",", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"h", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Lambda]", "2"]}], "+", "\[Mu]", "-", 
                    "\[Nu]", "+", 
                    RowBox[{"T", " ", 
                    SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "h"}], "-", "\[Mu]", "+", "\[Nu]", "-", 
                    SuperscriptBox["\[Nu]", "2"]}], ")"}]}]]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
         "]"}]}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"apppCC", "::", "usage"}], "=", 
    "\"\< only extract the  \!\(\*SuperscriptBox[\(q\), \(..\)]\) \
\!\(\*SuperscriptBox[\(t\), \(...\)]\)  insider of \!\(\*SubscriptBox[\(C\), \
\(u\\\ v\\\ \[Lambda]\)]\)[t,q] \>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ashurinCC", "[", 
   RowBox[{"{", 
    RowBox[{
    "t_", ",", "q_", ",", "h_", ",", "\[Mu]_", ",", "su_", ",", "\[Nu]_", ",",
      "sv_", ",", "\[Lambda]_", ",", "s\[Lambda]_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"su", "\[Equal]", "1"}], "&&", 
     RowBox[{"sv", "\[Equal]", "1"}], "&&", 
     RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", "\[Lambda]"}]], " ", 
          SuperscriptBox["t", 
           RowBox[{"-", "p"}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "1", ",", "h", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", "p"}]], " ", 
          SuperscriptBox["t", 
           RowBox[{"-", 
            SuperscriptBox["\[Lambda]", "T"]}]]}]}], "}"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"su", "\[Equal]", "1"}], "&&", 
       RowBox[{"sv", "\[Equal]", "1"}], "&&", 
       RowBox[{"s\[Lambda]", "\[Equal]", 
        RowBox[{"-", "1"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", 
           RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
           RowBox[{
            SuperscriptBox["q", 
             RowBox[{"-", 
              SuperscriptBox["\[Lambda]", "T"]}]], " ", 
            SuperscriptBox["t", 
             RowBox[{"-", "p"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "h", ",", "1", ",", 
           RowBox[{
            SuperscriptBox["q", 
             RowBox[{"-", "p"}]], " ", 
            SuperscriptBox["t", 
             RowBox[{"-", "\[Lambda]"}]]}]}], "}"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"su", "\[Equal]", "1"}], "&&", 
         RowBox[{"sv", "\[Equal]", 
          RowBox[{"-", "1"}]}], "&&", 
         RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", 
             RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
             RowBox[{
              SuperscriptBox["q", 
               RowBox[{"-", "\[Lambda]"}]], " ", 
              SuperscriptBox["t", 
               RowBox[{"-", "p"}]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", 
             RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
             RowBox[{
              SuperscriptBox["q", 
               RowBox[{"-", "p"}]], " ", 
              SuperscriptBox["t", 
               RowBox[{"-", 
                SuperscriptBox["\[Lambda]", "T"]}]]}]}], "}"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"su", "\[Equal]", 
            RowBox[{"-", "1"}]}], "&&", 
           RowBox[{"sv", "\[Equal]", "1"}], "&&", 
           RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Mu]", ",", "1", ",", "h", ",", "1", ",", 
               RowBox[{
                SuperscriptBox["q", 
                 RowBox[{"-", "\[Lambda]"}]], " ", 
                SuperscriptBox["t", 
                 RowBox[{"-", "p"}]]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "1", ",", "h", ",", "1", ",", 
               RowBox[{
                SuperscriptBox["q", 
                 RowBox[{"-", "p"}]], " ", 
                SuperscriptBox["t", 
                 RowBox[{"-", 
                  SuperscriptBox["\[Lambda]", "T"]}]]}]}], "}"}]}], "}"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"su", "\[Equal]", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{"sv", "\[Equal]", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{"s\[Lambda]", "\[Equal]", "1"}]}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Mu]", ",", "1", ",", "h", ",", "1", ",", 
                 RowBox[{
                  SuperscriptBox["q", 
                   RowBox[{"-", "\[Lambda]"}]], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"-", "p"}]]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Nu]", ",", 
                 RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
                 RowBox[{
                  SuperscriptBox["q", 
                   RowBox[{"-", "p"}]], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"-", 
                    SuperscriptBox["\[Lambda]", "T"]}]]}]}], "}"}]}], "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"su", "\[Equal]", 
                RowBox[{"-", "1"}]}], "&&", 
               RowBox[{"sv", "\[Equal]", "1"}], "&&", 
               RowBox[{"s\[Lambda]", "\[Equal]", 
                RowBox[{"-", "1"}]}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\[Mu]", ",", "1", ",", "h", ",", "1", ",", 
                   RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", 
                    SuperscriptBox["\[Lambda]", "T"]}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "p"}]]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Nu]", ",", "1", ",", "h", ",", "1", ",", 
                   RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", "p"}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "\[Lambda]"}]]}]}], "}"}]}], "}"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"su", "\[Equal]", "1"}], "&&", 
                 RowBox[{"sv", "\[Equal]", 
                  RowBox[{"-", "1"}]}], "&&", 
                 RowBox[{"s\[Lambda]", "\[Equal]", 
                  RowBox[{"-", "1"}]}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Mu]", ",", 
                    RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
                    RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", 
                    SuperscriptBox["\[Lambda]", "T"]}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "p"}]]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Nu]", ",", 
                    RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
                    RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", "p"}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "\[Lambda]"}]]}]}], "}"}]}], "}"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"su", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "&&", 
                   RowBox[{"sv", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "&&", 
                   RowBox[{"s\[Lambda]", "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[Mu]", ",", "1", ",", "h", ",", "1", ",", 
                    RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", 
                    SuperscriptBox["\[Lambda]", "T"]}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "p"}]]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Nu]", ",", 
                    RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
                    RowBox[{
                    SuperscriptBox["q", 
                    RowBox[{"-", "p"}]], " ", 
                    SuperscriptBox["t", 
                    RowBox[{"-", "\[Lambda]"}]]}]}], "}"}]}], "}"}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
         "]"}]}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ashurinCC", "::", "usage"}], "=", 
    "\"\< only extract the data of shur functions insider of \
\!\(\*SubscriptBox[\(C\), \(u\\\ v\\\ \[Lambda]\)]\)[t,q] and put data into \
lists, for the step of cancellation. \>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aSHURDATA", "[", "vertexdata_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ashurinCC", "/@", "vertexdata"}], ",", "1"}], "]"}], "//", 
    "Sort"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aExtractppp", 
   StyleBox["[",
    Background->RGBColor[1, 0.85, 0.85]], 
   StyleBox["aa_",
    Background->RGBColor[1, 0.85, 0.85]], 
   StyleBox["]",
    Background->RGBColor[1, 0.85, 0.85]]}], 
  StyleBox[":=",
   Background->RGBColor[1, 0.85, 0.85]], 
  RowBox[{
   StyleBox["Module",
    Background->RGBColor[1, 0.85, 0.85]], 
   StyleBox["[",
    Background->RGBColor[1, 0.85, 0.85]], 
   RowBox[{
    StyleBox[
     RowBox[{"{", 
      RowBox[{"exp", "=", "aa"}], "}"}],
     Background->RGBColor[1, 0.85, 0.85]], 
    StyleBox[",",
     Background->RGBColor[1, 0.85, 0.85]], 
    StyleBox["\[IndentingNewLine]",
     Background->RGBColor[1, 0.85, 0.85]], 
    RowBox[{
     RowBox[{
      RowBox[{
       StyleBox["exp",
        Background->RGBColor[1, 0.85, 0.85]], 
       StyleBox["/.",
        Background->RGBColor[1, 0.85, 0.85]], 
       RowBox[{
        StyleBox["{",
         Background->RGBColor[1, 0.85, 0.85]], 
        RowBox[{
         StyleBox["C",
          Background->RGBColor[1, 0.85, 0.85]], 
         StyleBox["\[Rule]",
          Background->RGBColor[1, 0.85, 0.85]], "dataC"}], 
        StyleBox["}",
         Background->RGBColor[1, 0.85, 0.85]]}]}], 
      StyleBox["/.",
       Background->RGBColor[1, 0.85, 0.85]], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"C", "\[Rule]", "apppCC"}], "}"}],
       Background->RGBColor[1, 0.85, 0.85]]}], 
     StyleBox["//",
      Background->RGBColor[1, 0.85, 0.85]], 
     StyleBox["SIMplify",
      Background->RGBColor[1, 0.85, 0.85]]}]}], 
   StyleBox["]",
    Background->RGBColor[1, 0.85, 0.85]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aExtractppp", "::", "usage"}], "=", 
    "\"\< only extract the  \!\(\*SuperscriptBox[\(q\), \(..\)]\) \
\!\(\*SuperscriptBox[\(t\), \(...\)]\)  insider of initial data ~topvex~ \
\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aPPP", 
   StyleBox["[",
    Background->RGBColor[0.94, 0.88, 0.94]], 
   StyleBox[
    RowBox[{"topvex_", ",", "legfactor_"}],
    Background->RGBColor[0.94, 0.88, 0.94]], 
   StyleBox["]",
    Background->RGBColor[0.94, 0.88, 0.94]]}], 
  StyleBox[":=",
   Background->RGBColor[0.94, 0.88, 0.94]], 
  StyleBox[
   RowBox[{
    RowBox[{"topvex", "*", "legfactor"}], "//", "aExtractppp"}],
   Background->RGBColor[0.94, 0.88, 0.94]]}]}], "Input",
 CellChangeTimes->{
  3.72551361217568*^9, {3.725513643702197*^9, 3.725513681398267*^9}, 
   3.7255137369160147`*^9, 3.725515278591475*^9, {3.7255154333028803`*^9, 
   3.725515433819591*^9}, {3.725515535234729*^9, 3.725515567031599*^9}, {
   3.725515626411406*^9, 3.725515700743332*^9}, {3.725515817875469*^9, 
   3.72551582555442*^9}, {3.725515904411174*^9, 3.725515916186797*^9}, 
   3.72551680356353*^9, {3.725517299749961*^9, 3.7255173025992813`*^9}, {
   3.7255174967101803`*^9, 3.72551751151536*^9}, 3.72551754665233*^9, {
   3.725517621143004*^9, 3.725517629262041*^9}, {3.72551812939771*^9, 
   3.725518168653137*^9}, {3.7255263437903957`*^9, 3.725526347776425*^9}, {
   3.740107277167677*^9, 3.7401075115595493`*^9}, {3.740107835972402*^9, 
   3.740107878361405*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ffe5f990-4c7a-4bcc-b430-1e65383dadf0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataC", "[", 
   RowBox[{"{", 
    RowBox[{
    "t_", ",", "q_", ",", "h_", ",", "u_", ",", "v_", ",", "\[Lambda]_"}], 
    "}"}], "]"}], ":=", 
  RowBox[{"C", "[", 
   RowBox[{"{", 
    RowBox[{"t", ",", "q", ",", "h", ",", 
     RowBox[{"Tremove", "[", "u", "]"}], ",", 
     RowBox[{"Tcheck", "[", "u", "]"}], ",", 
     RowBox[{"Tremove", "[", "v", "]"}], ",", 
     RowBox[{"Tcheck", "[", "v", "]"}], ",", 
     RowBox[{"Tremove", "[", "\[Lambda]", "]"}], ",", 
     RowBox[{"Tcheck", "[", "\[Lambda]", "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dataC", "::", "usage"}], "=", 
    "\"\< Initial process of initial input ~topvex~, put the data of, for \
example, C[{t,q,h,\!\(\*SuperscriptBox[\(u\), \(T\)]\),v,\[Lambda]}]-> \
C[{t,q,h, u,-1, v,1, \[Lambda],1 }], in an array, since Mathematica does not \
recognize Transpose T, we use -1 to stand for T.  \>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aV", "[", 
   RowBox[{"{", 
    RowBox[{
    "t_", ",", "q_", ",", "h_", ",", "\[Mu]_", ",", "su_", ",", "\[Nu]_", ",",
      "sv_", ",", "\[Lambda]_", ",", "s\[Lambda]_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
   "t", ",", "q", ",", "h", ",", "\[Mu]", ",", "su", ",", "\[Nu]", ",", "sv", 
    ",", "\[Lambda]", ",", "s\[Lambda]"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aExtractvertexdata", "[", "A_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newA", ",", "SnewA"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newA", "=", 
       RowBox[{"APART", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SnewA", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"newA", "/.", 
          RowBox[{"{", 
           RowBox[{"C", "\[Rule]", "dataC"}], "}"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"C", "\[Rule]", "aV"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "SnewA"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aVertexdata", "[", "topvex_", "]"}], ":=", 
   RowBox[{"topvex", "//", "aExtractvertexdata"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tcheck", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"valueequal", "[", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Log", "[", "x", "]"}], "//", "PowerExpand"}], ",", "T"}], 
        "]"}], ",", "0"}], "]"}], "\[Equal]", "1"}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"valueequal", "[", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", "x", "]"}], "//", "PowerExpand"}], ",", "T"}],
           "]"}], ",", "0"}], "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tcheck", "::", "usage"}], "=", 
    "\"\< to check whether the input is Transpose or not; Tcheck[\[Alpha]] = \
1, Tcheck[\!\(\*SuperscriptBox[\(\[Alpha]\), \(T\)]\)] = 1  \>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tremove", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Tcheck", "[", "x", "]"}], "\[Equal]", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", "x", "]"}], "//", "PowerExpand"}], ",", "T"}], 
      "]"}], "//", "Exp"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Tcheck", "[", "x", "]"}], "\[Equal]", "1"}], ",", "x"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tremove", "::", "usage"}], "=", 
    "\"\<to remove the transpose T in \!\(\*SuperscriptBox[\(\[Alpha]\), \
\(T\)]\) to \[Alpha]; Tremove[\!\(\*SuperscriptBox[\(\[Alpha]\), \(T\)]\)]=\
\[Alpha] \>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"RunaqCC", "[", "aa_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "bb", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"aa", "/.", 
        RowBox[{"{", 
         RowBox[{"C", "\[Rule]", "dataC"}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"C", "\[Rule]", "aqCC"}], "}"}]}], "//", "SIMplify"}]}], 
    "]"}]}],
  Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RunaqCC", "::", "usage"}], "=", 
   "\"\< Turn undefined C[\[Alpha],\[Mu],\[Nu],t,q] into aqC[\[Alpha],\[Mu],\
\[Nu],t,q] which are defined topological vertex\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.725516272593363*^9, 3.7255162987157297`*^9}, 
   3.725516329852683*^9, {3.72551644061692*^9, 3.725516482658551*^9}, {
   3.725516513832995*^9, 3.725516525625987*^9}, {3.7255196410545*^9, 
   3.725519642282199*^9}, 3.725519707502284*^9, {3.7255254371371937`*^9, 
   3.725525471166053*^9}, {3.7255255141111403`*^9, 3.7255255158472223`*^9}, {
   3.725525830808178*^9, 3.7255258505809727`*^9}, {3.7255260638174067`*^9, 
   3.725526071907971*^9}, {3.74010575849507*^9, 3.7401060417558403`*^9}, {
   3.74010611374833*^9, 3.74010621342216*^9}, {3.740106711046279*^9, 
   3.7401068629570312`*^9}, {3.7401069926858063`*^9, 3.740107061354495*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"2bb79a27-c23c-411c-ac61-c346824d7d59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pf", "[", 
   RowBox[{"\[Alpha]_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Alpha]", "//", "Tcheck"}], ")"}], "\[Equal]", "1"}], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"-", "\[Alpha]"}]], 
     SuperscriptBox["t", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Alpha]", "2"], "T"}], "2"]], 
     SuperscriptBox["q", 
      FractionBox[
       RowBox[{"-", 
        SuperscriptBox["\[Alpha]", "2"]}], "2"]]}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "//", "Tcheck"}], ")"}], "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}]}]], 
       SuperscriptBox["q", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"T", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}], "2"]}], "2"]}]], 
       " ", 
       SuperscriptBox["t", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}], "2"]}]]}]}], "]"}]}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pf", "::", "usage"}], "=", 
   "\"\< The framing factor for perfered directions: \n\!\(\*StyleBox[\(\\\ \
\\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \
\\\ \\\ \\\ \\\ \\\ \\\ \\\ \*StyleBox[\"  \", \
\"MSG\"]\)]\)\!\(\*StyleBox[\"pf\", \"MSG\"]\)\!\(\*StyleBox[\"[\", \
\"MSG\"]\)\!\(\*StyleBox[\"\[Alpha]\", \"MSG\"]\)\!\(\*StyleBox[\",\", \
\"MSG\"]\)\!\(\*StyleBox[\" \", \"MSG\"]\)\!\(\*StyleBox[\"t\", \
\"MSG\"]\)\!\(\*StyleBox[\",\", \"MSG\"]\)\!\(\*StyleBox[\"q\", \
\"MSG\"]\)\!\(\*StyleBox[\"]\", \"MSG\"]\)\!\(\*StyleBox[\"=\", \
\"MSG\"]\)\!\(\*StyleBox[\" \", \"MSG\"]\)\!\(\*StyleBox[\"(\", \
\"MSG\"]\)\!\(\*StyleBox[\"-\", \"MSG\"]\)\!\(\*StyleBox[\"1\", \
\"MSG\"]\)\!\(\*StyleBox[SuperscriptBox[\")\", RowBox[{\"-\", RowBox[{\"|\", \
\"\[Alpha]\", \"|\"}]}]], \"MSG\"]\)\!\(\*StyleBox[SuperscriptBox[\"t\", \
FractionBox[RowBox[{\"||\", SuperscriptBox[\"\[Alpha]\", \"T\"], \
SuperscriptBox[\"||\", \"2\"]}], \"2\"]], \
\"MSG\"]\)\!\(\*StyleBox[SuperscriptBox[\"q\", FractionBox[RowBox[{\"-\", \
RowBox[{\"||\", \"\[Alpha]\", SuperscriptBox[\"||\", \"2\"]}]}], \"2\"]], \
\"MSG\"]\)\!\(\*StyleBox[\" \", \"MSG\"]\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"\[Alpha]_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Alpha]", "//", "Tcheck"}], ")"}], "\[Equal]", "1"}], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"-", "\[Alpha]"}]], 
     SuperscriptBox["t", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Alpha]", "2"], "T"}], "+", "\[Alpha]"}], "2"]], 
     SuperscriptBox["q", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[Alpha]", "2"], "+", "\[Alpha]"}], "2"]}]]}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "//", "Tcheck"}], ")"}], "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}]}]], " ", 
       SuperscriptBox["q", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}]}], "-", 
           RowBox[{"T", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}], "2"]}]}], 
          ")"}]}]], " ", 
       SuperscriptBox["t", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}], "+", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"\[Alpha]", "//", "Tremove"}], ")"}], "2"]}], 
          ")"}]}]]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "::", "usage"}], "=", 
   "\"\< The framing factor for perfered directions: \n\!\(\*StyleBox[\(\\\ \
\\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \
\\\ \\\ \\\ \\\ \\\ \\\ \\\ \*StyleBox[\"  \", \
\"MSG\"]\)]\)\!\(\*StyleBox[\"f\", \"MSG\"]\)\!\(\*StyleBox[\"[\", \"MSG\"]\)\
\!\(\*StyleBox[\"\[Alpha]\", \"MSG\"]\)\!\(\*StyleBox[\",\", \
\"MSG\"]\)\!\(\*StyleBox[\" \", \"MSG\"]\)\!\(\*StyleBox[\"t\", \
\"MSG\"]\)\!\(\*StyleBox[\",\", \"MSG\"]\)\!\(\*StyleBox[\"q\", \
\"MSG\"]\)\!\(\*StyleBox[\"]\", \"MSG\"]\)\!\(\*StyleBox[\"=\", \
\"MSG\"]\)\!\(\*StyleBox[\" \", \"MSG\"]\)\!\(\*StyleBox[\"(\", \
\"MSG\"]\)\!\(\*StyleBox[\"-\", \"MSG\"]\)\!\(\*StyleBox[\"1\", \
\"MSG\"]\)\!\(\*StyleBox[SuperscriptBox[\")\", RowBox[{\"-\", RowBox[{\"|\", \
\"\[Alpha]\", \"|\"}]}]], \"MSG\"]\)\!\(\*StyleBox[SuperscriptBox[\"t\", \
FractionBox[RowBox[{RowBox[{\"||\", SuperscriptBox[\"\[Alpha]\", \"T\"], \
SuperscriptBox[\"||\", \"2\"], \"+\"}], \"|\", \"\[Alpha]\", \"|\"}], \
\"2\"]], \"MSG\"]\)\!\(\*StyleBox[SuperscriptBox[\"q\", RowBox[{\"-\", \
FractionBox[RowBox[{RowBox[{\"||\", \"\[Alpha]\", SuperscriptBox[\"||\", \
\"2\"], \"+\"}], \"|\", \"\[Alpha]\", \"|\"}], \"2\"]}]], \
\"MSG\"]\)\!\(\*StyleBox[\" \", \"MSG\"]\)\>\""}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7255306657810593`*^9, 3.725530668543532*^9}, 
   3.7256009462394238`*^9, {3.725601183695096*^9, 3.725601184162806*^9}, {
   3.725601265202016*^9, 3.725601272321484*^9}, {3.72560145815208*^9, 
   3.725601472467946*^9}, {3.7256015332197742`*^9, 3.725601536422728*^9}, {
   3.725601664798359*^9, 3.725601666735714*^9}, 3.7258550344928303`*^9, 
   3.725855124302779*^9, 3.725855987784582*^9, {3.7401054574982967`*^9, 
   3.740105669340199*^9}, {3.740105734726953*^9, 3.740105751262754*^9}, {
   3.740107086477208*^9, 3.740107141979972*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"bf8ad9cc-dd40-4da0-9c83-bcca42880762"],

Cell[CellGroupData[{

Cell["other thing unimportant, but used", "Subsubsection",
 CellChangeTimes->{{3.703902876934656*^9, 3.703902881924691*^9}, {
  3.704380370334918*^9, 3.704380371514497*^9}, {3.740113326457312*^9, 
  3.74011336553006*^9}},ExpressionUUID->"b68e8413-6b3a-4dca-9e13-\
185747fb72f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hu", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Product", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Last", "[", "a", "]"}], ")"}], "i"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Last", "[", "b", "]"}], ")"}], "j"]}]}], ")"}], 
      RowBox[{"-", "1"}]], ",", "0"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["0", "T"], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["0", "T"]}], "\[Rule]", "0"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HuT", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Last", "[", "a", "]"}], ")"}], "i"], 
        SuperscriptBox[
         RowBox[{"(", " ", 
          RowBox[{"Last", "[", "b", "]"}], ")"}], "j"]}]}], ")"}], ",", "0"}],
     "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["0", "T"], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["0", "T"]}], "\[Rule]", "0"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.707728701958715*^9, 3.7077287153590307`*^9}, {
  3.7077289717908278`*^9, 3.70772897785958*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"e322785c-cc48-49b6-b078-1532421ff188"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CC", "[", 
     RowBox[{"{", 
      RowBox[{"r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", "h_"}], 
      "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["q", 
       FractionBox[
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"]}], "2"]], 
      SuperscriptBox["t", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["u", 
          RowBox[{"2", "T"}]], "2"]}]], 
      RowBox[{
       SubscriptBox["Z", "v"], "[", 
       RowBox[{"t", ",", "q"}], "]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["q", "t"], ")"}], 
       FractionBox[
        RowBox[{"h", "+", "r", "-", "u"}], "2"]], 
      RowBox[{
       SubscriptBox["s", 
        RowBox[{
         RowBox[{"r", " ", "T"}], ",", "h"}]], "[", 
       RowBox[{
        SuperscriptBox["t", 
         RowBox[{"-", "p"}]], 
        SuperscriptBox["q", 
         RowBox[{"-", "v"}]]}], "]"}], 
      RowBox[{
       SubscriptBox["s", 
        RowBox[{"u", ",", "h"}]], "[", 
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{"-", "p"}]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          SuperscriptBox["v", "T"]}]]}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"Q_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "v"], 
     SuperscriptBox["Q", "v"]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{"Q_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"1", "+", 
      RowBox[{"Q", " ", "x", " ", "y"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dM", "[", 
     RowBox[{"Q_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    SuperscriptBox[
     RowBox[{"{", 
      RowBox[{"1", "-", 
       RowBox[{"Q", " ", "x", " ", "y"}]}], "}"}], 
     RowBox[{"-", "1"}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{"Q_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"Product", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Q", " ", 
          SuperscriptBox["q", 
           RowBox[{"i", "+", "j", "-", "1"}]]}]}], ")"}], 
       RowBox[{"-", "1"}]], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qCC", "[", 
     RowBox[{"{", 
      RowBox[{
      "ss_", ",", "r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", 
       "h_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ss", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{
           SuperscriptBox["u", "2"], "+", 
           SuperscriptBox["v", "2"]}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["u", "2"], "T"}], "2"]}]], 
        RowBox[{
         SubscriptBox["Z", "v"], "[", 
         RowBox[{"t", ",", "q"}], "]"}], 
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{"h", "+", "r", "-", "u"}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"h", "+", "r", "-", "u"}], "2"]}]], " ", 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{
           RowBox[{"r", "^", "T"}], ",", "h"}]], "[", 
         RowBox[{
          SuperscriptBox["t", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["q", 
           RowBox[{"-", "v"}]]}], "]"}], 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{"u", ",", "h"}]], "[", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["t", 
           RowBox[{"-", 
            SuperscriptBox["v", "T"]}]]}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["u", "2"], "T"}], "+", 
           RowBox[{
            SuperscriptBox["v", "2"], "T"}]}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["u", "2"], "2"]}]], 
        RowBox[{
         SubscriptBox["Z", 
          RowBox[{"v", "^", "T"}]], "[", 
         RowBox[{"t", ",", "q"}], "]"}], 
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{"h", "+", "r", "-", "u"}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"h", "+", "r", "-", "u"}], "2"]}]], 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{"r", ",", "h"}]], "[", 
         RowBox[{
          SuperscriptBox["t", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["q", 
           RowBox[{"-", 
            RowBox[{"v", "^", "T"}]}]]}], "]"}], 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{
           RowBox[{"u", "^", "T"}], ",", "h"}]], "[", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["t", 
           RowBox[{"-", "v"}]]}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reorderqCC", "[", 
     RowBox[{"{", 
      RowBox[{
      "ss_", ",", "r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", 
       "h_"}], "}"}], "]"}], ":=", 
    RowBox[{"qCC", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ss", ",", "r", ",", "u", ",", "v", ",", "t", ",", "q", ",", "h"}], 
       "}"}], "//", "reorder"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pppCC", "[", 
     RowBox[{"{", 
      RowBox[{
      "ss_", ",", "r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", 
       "h_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ss", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{
           SuperscriptBox["u", "2"], "+", 
           SuperscriptBox["v", "2"]}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["u", "2"], "T"}], "2"]}]], 
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{"h", "+", "r", "-", "u"}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"h", "+", "r", "-", "u"}], "2"]}]]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["u", "2"], "T"}], "+", 
           RowBox[{
            SuperscriptBox["v", "2"], "T"}]}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["u", "2"], "2"]}]], 
        SuperscriptBox["q", 
         FractionBox[
          RowBox[{"h", "+", "r", "-", "u"}], "2"]], 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"h", "+", "r", "-", "u"}], "2"]}]]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ZZZCC", "[", 
     RowBox[{"{", 
      RowBox[{
      "ss_", ",", "r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", 
       "h_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ss", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["Z", "v"], "[", 
        RowBox[{"t", ",", "q"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["Z", 
         RowBox[{"v", "^", "T"}]], "[", 
        RowBox[{"t", ",", "q"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reorderZZZCC", "[", 
     RowBox[{"{", 
      RowBox[{
      "ss_", ",", "r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", 
       "h_"}], "}"}], "]"}], ":=", 
    RowBox[{"ZZZCC", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ss", ",", "r", ",", "u", ",", "v", ",", "t", ",", "q", ",", "h"}], 
       "}"}], "//", "reorder"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reorderpppCC", "[", 
     RowBox[{"{", 
      RowBox[{
      "ss_", ",", "r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", 
       "h_"}], "}"}], "]"}], ":=", 
    RowBox[{"pppCC", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ss", ",", "r", ",", "u", ",", "v", ",", "t", ",", "q", ",", "h"}], 
       "}"}], "//", "reorder"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reorder", "[", "a_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"RunqCC", "[", "a_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{
        RowBox[{"a", "/.", 
         RowBox[{"{", 
          RowBox[{"C", "\[Rule]", "reorderqCC"}], "}"}]}], "//", 
        "SIMplify"}]}], "]"}]}],
    Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"Extractppp", "[", "a_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "exp", "}"}], ",", 
       RowBox[{
        RowBox[{"exp", "=", "a"}], ";", 
        RowBox[{
         RowBox[{"a", "/.", 
          RowBox[{"{", 
           RowBox[{"C", "\[Rule]", "reorderpppCC"}], "}"}]}], "//", 
         "SIMplify"}]}]}], "]"}]}],
    Background->RGBColor[1, 0.85, 0.85]], 
   StyleBox["\[IndentingNewLine]",
    Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtractZZZ", "[", "a_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "exp", "}"}], ",", 
      RowBox[{
       RowBox[{"exp", "=", "a"}], ";", 
       RowBox[{
        RowBox[{"a", "/.", 
         RowBox[{"{", 
          RowBox[{"C", "\[Rule]", "reorderZZZCC"}], "}"}]}], "//", 
        "SIMplify"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SIMplify", "[", "a_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "ex", "}"}], ",", 
      RowBox[{
       RowBox[{"ex", "=", "a"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ex", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "/.", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["Z", "0"], "[", 
             RowBox[{"t", ",", "q"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["Z", "0"], "[", 
             RowBox[{"q", ",", "t"}], "]"}], "\[Rule]", "1"}]}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ex", "//", "Simplify"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", "a_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "==", "1"}]}], ",", 
      RowBox[{
       SubscriptBox["s", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]], "[", 
       RowBox[{"a", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "==", 
          RowBox[{"-", "1"}]}]}], ",", 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "T"]}]], "[", 
         RowBox[{"a", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "1"}]}], "&&", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "==", "1"}]}], ",", 
          RowBox[{
           SubscriptBox["s", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "T"], ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]], "[", 
           RowBox[{"a", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "==", 
              RowBox[{"-", "1"}]}]}], ",", 
            RowBox[{
             SubscriptBox["s", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "T"], ",", 
               SuperscriptBox[
                RowBox[{"a", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "T"]}]], "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Leg", "[", "a_", "]"}], ":=", 
    SuperscriptBox[
     RowBox[{"a", "[", 
      RowBox[{"[", "2", "]"}], "]"}], 
     RowBox[{"a", "[", 
      RowBox[{"[", "1", "]"}], "]"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.69891383321203*^9, 3.698913897362123*^9}, 
   3.698913942031139*^9, {3.69891482077816*^9, 3.698914855399211*^9}, {
   3.698915395064019*^9, 3.698915449047793*^9}, {3.69891560789295*^9, 
   3.6989156352750273`*^9}, {3.698915791372156*^9, 3.69891581391814*^9}, {
   3.699696704217021*^9, 3.699696717083859*^9}, {3.6997587602446127`*^9, 
   3.699758774503159*^9}, {3.6997590012324047`*^9, 3.6997590039360323`*^9}, {
   3.6997610404741707`*^9, 3.6997610457437983`*^9}, {3.69976123292031*^9, 
   3.6997612335102654`*^9}, {3.699866459265044*^9, 3.699866486360072*^9}, {
   3.700195073460573*^9, 3.700195076274082*^9}, {3.700195126756489*^9, 
   3.70019513035067*^9}, {3.700196067991144*^9, 3.70019608642168*^9}, {
   3.7001961359890337`*^9, 3.7001961698651047`*^9}, {3.7001962845885553`*^9, 
   3.700196355741335*^9}, {3.7001974925703382`*^9, 3.700197493388546*^9}, {
   3.7001978887826357`*^9, 3.7001979055013657`*^9}, {3.700197952668159*^9, 
   3.7001979643680973`*^9}, {3.700198131290703*^9, 3.700198135236596*^9}, {
   3.7001983246543503`*^9, 3.700198335621243*^9}, {3.700220873473236*^9, 
   3.700220877751902*^9}, {3.700220918558029*^9, 3.700220926836712*^9}, {
   3.700221027174179*^9, 3.700221031182322*^9}, {3.700221322714967*^9, 
   3.700221402441312*^9}, {3.700221662068376*^9, 3.700221665355134*^9}, {
   3.7002311428033047`*^9, 3.700231175821419*^9}, {3.700231313794396*^9, 
   3.700231341992187*^9}, {3.70030633762855*^9, 3.700306374816968*^9}, {
   3.700306525502437*^9, 3.700306548310898*^9}, {3.700306660188712*^9, 
   3.700306670122147*^9}, 3.700714981799815*^9, {3.700721316463916*^9, 
   3.7007213225632467`*^9}, {3.700721736898014*^9, 3.700721753195084*^9}, {
   3.700728129089938*^9, 3.7007281318761787`*^9}, {3.700728551088402*^9, 
   3.7007285531440287`*^9}, {3.700735610176272*^9, 3.700735611561179*^9}, {
   3.700735678093549*^9, 3.700735695038108*^9}, {3.7008011198008633`*^9, 
   3.700801120350418*^9}, {3.700986828872542*^9, 3.700986832644219*^9}, {
   3.701060394984359*^9, 3.701060426150172*^9}, {3.7010605426381598`*^9, 
   3.701060546217373*^9}, {3.701060586228916*^9, 3.701060588617581*^9}, {
   3.701060625792966*^9, 3.7010606288974257`*^9}, {3.701060726019696*^9, 
   3.701060748662107*^9}, {3.70747641131809*^9, 3.707476432612949*^9}, {
   3.707476478406592*^9, 3.707476480753523*^9}, {3.707727806921199*^9, 
   3.707727844553418*^9}, 3.707727903401206*^9, {3.707728058849023*^9, 
   3.707728066185444*^9}, {3.707728396967546*^9, 3.7077284088969793`*^9}, {
   3.707970902364995*^9, 3.707970951552812*^9}, {3.707971063003037*^9, 
   3.707971127510413*^9}, {3.707971186619825*^9, 3.707971228556645*^9}, {
   3.7079713057958927`*^9, 3.707971307062763*^9}, {3.707975071442749*^9, 
   3.707975071764186*^9}, {3.707975118629084*^9, 3.707975269815419*^9}, {
   3.7079753102971487`*^9, 3.707975333600997*^9}, {3.707975365880787*^9, 
   3.707975369807356*^9}, 3.7079755654880667`*^9, {3.7079756074590054`*^9, 
   3.707975651673634*^9}, {3.707977224004096*^9, 3.707977228880506*^9}, {
   3.707977321207341*^9, 3.707977408118595*^9}, 3.707977548757337*^9, {
   3.7080835532603207`*^9, 3.708083662290331*^9}, {3.708083706785977*^9, 
   3.708083726299858*^9}, {3.717211119727758*^9, 3.717211157643641*^9}, {
   3.7209488300222683`*^9, 3.720948833137559*^9}, {3.720949005813394*^9, 
   3.720949046643763*^9}, {3.720949178286395*^9, 3.7209491907114277`*^9}, {
   3.7209494418458443`*^9, 3.720949471543394*^9}, {3.721024312410898*^9, 
   3.721024358598885*^9}, {3.722484387221025*^9, 3.722484448574037*^9}, {
   3.7224847478889313`*^9, 3.722484750476882*^9}, 3.722484896906754*^9, 
   3.725601195668564*^9, {3.740104756274109*^9, 3.740104870495544*^9}, 
   3.7401063644928637`*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"1c3ba418-116d-46e1-a657-edb64a2c18c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fL", "[", 
    RowBox[{"{", 
     RowBox[{
     "pfss_", ",", "cs_", ",", "Q_", ",", "\[Alpha]_", ",", "t_", ",", "q_"}],
      "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"pfss", "==", "1"}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"f", "[", 
        RowBox[{"\[Alpha]", ",", "t", ",", "q"}], "]"}], "cs"], 
      RowBox[{"L", "[", 
       RowBox[{"Q", ",", "\[Alpha]"}], "]"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"tf", "[", 
        RowBox[{"\[Alpha]", ",", "t", ",", "q"}], "]"}], "cs"], 
      RowBox[{"L", "[", 
       RowBox[{"Q", ",", "\[Alpha]"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7037418617088823`*^9, 3.703742071270418*^9}, {
  3.703742191104169*^9, 3.7037422020089273`*^9}, {3.7037422447176456`*^9, 
  3.7037423297364607`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"0d989743-2413-455d-ab01-fa9c72b93c80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tfL", "[", 
    RowBox[{"t_", ",", "q_", ",", "Q_", ",", "\[Alpha]_", ",", "cs_"}], "]"}],
    ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"tf", "[", 
      RowBox[{"\[Alpha]", ",", "t", ",", "q"}], "]"}], "cs"], 
    RowBox[{"L", "[", 
     RowBox[{"Q", ",", "\[Alpha]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fL", "[", 
   RowBox[{"t_", ",", "q_", ",", "Q_", ",", "\[Alpha]_", ",", "cs_"}], "]"}], 
  ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"f", "[", 
     RowBox[{"\[Alpha]", ",", "t", ",", "q"}], "]"}], "cs"], 
   RowBox[{"L", "[", 
    RowBox[{"Q", ",", "\[Alpha]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.707971548291481*^9, 3.707971608473192*^9}, {
  3.707974813049429*^9, 3.707974921754909*^9}, {3.707974984989278*^9, 
  3.7079750025531597`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"af776400-ea2e-4fc1-8362-aa130c86d32d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.701061444179419*^9, 3.701061449806963*^9}, 
   3.701062271185977*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"2b17ee49-2fd2-4950-bdba-481acdfed134"],

Cell[TextData[StyleBox["The following two lines are very bad code, do not use \
it randomly.",
 Background->RGBColor[0.94, 0.88, 0.94]]], "Text",
 CellChangeTimes->{{3.701061454388961*^9, 3.7010614751756973`*^9}, {
  3.701062600013735*^9, 
  3.701062609057961*^9}},ExpressionUUID->"4a98b62a-5089-414a-bf02-\
9fb453051978"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    SubscriptBox["S", 
     RowBox[{
      SuperscriptBox["\[Lambda]_", "T"], ",", "h_"}]], "[", "x_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", 
     RowBox[{"-", "1"}], ",", "h", ",", "1", ",", "x"}], "}"}]}],
  Background->RGBColor[0.94, 0.88, 0.94]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    SubscriptBox["S", 
     RowBox[{"\[Lambda]_", ",", "h_"}]], "[", "x_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", "1", ",", "h", ",", "1", ",", "x"}], "}"}]}],
  Background->RGBColor[0.94, 0.88, 0.94]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["V",
    Background->RGBColor[0.94, 0.88, 0.94]], "[", 
   RowBox[{"{", 
    RowBox[{
    "ss_", ",", "t_", ",", "q_", ",", "h_", ",", "r_", ",", "u_", ",", "v_"}],
     "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"ss", ",", "r", ",", "u", ",", "v", ",", "t", ",", "q", ",", "h"}],
    "}"}]}]}], "Input",
 CellChangeTimes->{
  3.7007799366316957`*^9, 3.701061441716557*^9, {3.701063121867234*^9, 
   3.701063122426586*^9}, {3.701063160333478*^9, 3.701063224175373*^9}, {
   3.707975781619522*^9, 3.7079757879780483`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"2aaad92f-e05d-44df-b18d-55bff2e8c5eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    StyleBox["ss",
     Background->RGBColor[0.88, 1, 0.88]], 
    SuperscriptBox["\[Mu]_", "T"]], "[", 
   RowBox[{"x_", ",", "y_", ",", "h_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["s", 
     RowBox[{
      SuperscriptBox["\[Mu]", "T"], ",", "h"}]], "[", "x", "]"}], 
   RowBox[{
    SubscriptBox["s", 
     RowBox[{"h", ",", "0"}]], "[", "y", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.700714464496175*^9, {3.7007205837477903`*^9, 3.700720644594296*^9}, {
   3.700720761808261*^9, 3.700720922709735*^9}, {3.700721010536097*^9, 
   3.7007210412707167`*^9}, {3.7007210860554237`*^9, 3.700721262317709*^9}, 
   3.700721314203616*^9, {3.700779940119516*^9, 3.700780052896117*^9}, {
   3.700780107189487*^9, 3.700780157244534*^9}, {3.700780245821652*^9, 
   3.7007802488457317`*^9}, 3.700780293236577*^9, {3.7007805071350327`*^9, 
   3.700780507627596*^9}, {3.70078068947253*^9, 3.700780720787533*^9}, {
   3.7007807632790203`*^9, 3.7007807650927477`*^9}, 3.700781130721203*^9, {
   3.700781161257546*^9, 3.7007813320001173`*^9}, {3.700781950311842*^9, 
   3.700781954253434*^9}, 3.700783158154332*^9, {3.700869370015963*^9, 
   3.700869412749063*^9}, {3.7008694972716312`*^9, 3.7008695834777727`*^9}, {
   3.700875569847229*^9, 3.7008755702040167`*^9}, {3.700875716779871*^9, 
   3.7008757791149607`*^9}, {3.700875875505563*^9, 3.7008760769112864`*^9}, {
   3.700876164652996*^9, 3.700876303870535*^9}, 3.7008765631070213`*^9, {
   3.7008766646942797`*^9, 3.700876742878428*^9}, {3.700876790270203*^9, 
   3.700876792555894*^9}, {3.7008768287061977`*^9, 3.7008768310864*^9}, {
   3.700877127903721*^9, 3.700877151101699*^9}, {3.700877605480978*^9, 
   3.7008776451152363`*^9}, {3.700878197690371*^9, 3.700878205215365*^9}, {
   3.700878275930262*^9, 3.700878324633505*^9}, {3.700878464301708*^9, 
   3.7008784834670553`*^9}, {3.700878593483931*^9, 3.7008786085058727`*^9}, {
   3.700879422247896*^9, 3.7008794308955517`*^9}, {3.700879553491171*^9, 
   3.7008795671357603`*^9}, {3.700883298044475*^9, 3.70088330950436*^9}, {
   3.7008833917099743`*^9, 3.700883392257833*^9}, {3.700887890878421*^9, 
   3.7008878921474247`*^9}, {3.700903014562549*^9, 3.700903091579831*^9}, {
   3.700978113784527*^9, 3.700978172507114*^9}, {3.700978242040942*^9, 
   3.700978294314582*^9}, {3.700979944801963*^9, 3.7009800262559977`*^9}, {
   3.700980242981238*^9, 3.700980377258253*^9}, {3.700981196145784*^9, 
   3.700981228728897*^9}, {3.7009814727545137`*^9, 3.700981499170801*^9}, {
   3.700982562663756*^9, 3.700982575469716*^9}, {3.7009864458060093`*^9, 
   3.700986448475399*^9}, {3.700986485483803*^9, 3.70098661315646*^9}, {
   3.700986844625613*^9, 3.7009868570722523`*^9}, {3.70098690128023*^9, 
   3.7009869237676497`*^9}, {3.700987028835807*^9, 3.700987069305916*^9}, {
   3.700987223069578*^9, 3.7009872630764914`*^9}, 3.700987753999593*^9, {
   3.700987861590062*^9, 3.700987901937533*^9}, {3.7009931705460453`*^9, 
   3.7009931714819*^9}, {3.740106282987392*^9, 3.7401063048110867`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"a8cf7b71-c1d9-49be-b688-0af6afc25cdc"],

Cell[BoxData[""], "Input",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.700714439755868*^9, 3.70071444147935*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"0ca4a6c9-0f6b-4989-89c2-e60414764d56"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Document \
\[OpenCurlyDoubleQuote]shurcancellation\[CloseCurlyDoubleQuote] and Expanding \
partition function", "Subsection",
 CellChangeTimes->{{3.704016127767434*^9, 3.704016162942889*^9}, {
   3.704016243135047*^9, 3.704016262797154*^9}, {3.7082532811643553`*^9, 
   3.708253294254537*^9}, 3.739238493733221*^9, {3.740113817761265*^9, 
   3.740113819487174*^9}},ExpressionUUID->"3f61200c-ce8b-42b6-ab59-\
9fced51262a1"],

Cell[CellGroupData[{

Cell[TextData[{
 "The cancellation by Cauchy identities:         ",
 Cell[BoxData[
  FormBox[
   RowBox[{"  ", 
    SubscriptBox["s", "u"]}], TraditionalForm]],ExpressionUUID->
  "2dbb1eca-bf42-47ff-b5b6-3ec62dafc96b"],
 "(x) ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["s", "v"], "(", "y", ")"}], "=", " ", 
    RowBox[{"\[Product]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "xy"}], " ", ")"}], " ", 
      RowBox[{
       SubscriptBox["s", "."], "(", "x", ")"}], 
      RowBox[{
       SubscriptBox["s", "."], "(", "y", ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"8630ab4c-6603-4bc9-b596-b72ec615acb0"]
}], "Subsubsection",
 CellChangeTimes->{{3.7039027326661053`*^9, 3.703902745399289*^9}, {
   3.706691276829055*^9, 3.706691278425891*^9}, 3.740119938119343*^9, {
   3.740127448503358*^9, 3.7401274720804253`*^9}, {3.7401276121766644`*^9, 
   3.740127621125193*^9}, {3.7401279473874817`*^9, 
   3.740128047010964*^9}},ExpressionUUID->"12cc1a4c-c7aa-4343-84f5-\
186f081abb49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shurinCC", "[", 
   RowBox[{"{", 
    RowBox[{
    "ss_", ",", "r_", ",", "u_", ",", "v_", ",", "t_", ",", "q_", ",", "h_"}],
     "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ss", "\[Equal]", "1"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["t", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["q", 
           RowBox[{"-", "v"}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "1", ",", "h", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["t", 
           RowBox[{"-", 
            SuperscriptBox["v", "T"]}]]}]}], "}"}]}], "}"}], " ", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", "h", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["t", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["q", 
           RowBox[{"-", 
            RowBox[{"v", "^", "T"}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", 
         RowBox[{"-", "1"}], ",", "h", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["q", 
           RowBox[{"-", "p"}]], 
          SuperscriptBox["t", 
           RowBox[{"-", "v"}]]}]}], "}"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.7003090105372343`*^9, 3.700309226606642*^9}, 
   3.700309608055039*^9, {3.700311641974791*^9, 3.700311644935268*^9}, {
   3.7077290834198637`*^9, 3.707729089666177*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[61]:=",ExpressionUUID->"af49a1ad-0e28-479b-8598-21fcf1d38962"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SHURDATA", "[", "vertexdata_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"shurmatrix", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"shurmatrix", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "[", "vertexdata", "]"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"n", "=", "1"}], ",", 
           RowBox[{"n", "\[LessEqual]", "2"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "++"}], "\[IndentingNewLine]", "shurmatrix"}], "=", 
            
            RowBox[{"Append", "[", 
             RowBox[{"shurmatrix", ",", 
              RowBox[{
               RowBox[{"shurinCC", "[", 
                RowBox[{"vertexdata", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]}], "]"}], "]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"shurmatrix", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"shurmatrix", ",", 
            RowBox[{
             RowBox[{"shurinCC", "[", 
              RowBox[{"vertexdata", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"shurmatrix", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"shurmatrix", ",", 
            RowBox[{
             RowBox[{"shurinCC", "[", 
              RowBox[{"vertexdata", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"shurmatrix", "//", "Sort"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700310015405558*^9, 3.70031019977989*^9}, {
   3.700310320893903*^9, 3.700310413567194*^9}, {3.700311961511491*^9, 
   3.7003119770349293`*^9}, {3.7003123963252077`*^9, 3.7003124432796087`*^9}, 
   3.700312485510318*^9, {3.700312597100759*^9, 3.7003125984405203`*^9}, {
   3.700315502558258*^9, 3.700315502808498*^9}, {3.700673006453738*^9, 
   3.700673009305169*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[62]:=",ExpressionUUID->"43b37b0d-bfcb-4e67-a41f-2e7c20f8f617"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"valuezero", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "value"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", 
      RowBox[{"{", "A", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"value", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"newA", ",", "0"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"value", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "value"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"If", " ", "A"}], "=", "0"}], ",", 
    RowBox[{"return", " ", "1"}], ",", " ", 
    RowBox[{
     RowBox[{"if", " ", "A"}], "\[NotEqual]", "0"}], ",", " ", 
    RowBox[{"return", " ", "0"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.700315778990834*^9, {3.700322107864553*^9, 3.700322211142188*^9}, {
   3.700322254189226*^9, 3.700322357556703*^9}, {3.700322472666348*^9, 
   3.700322524332065*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[63]:=",ExpressionUUID->"5b1b76b4-2c57-45b2-8fd4-c019835edc8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"valueequal", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"(*", "value", "*)"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"value", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"A", "-", "B"}], "}"}], ",", "0"}], "]"}], "]"}], 
          "\[Equal]", "0"}], ",", 
         RowBox[{"value", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "value"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"A", ",", "B"}], "]"}], "\[Equal]", "True"}], ",", "1", ",", 
       "0"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"If", " ", "A"}], "=", "B"}], ",", 
    RowBox[{"return", " ", "1"}], ",", " ", 
    RowBox[{
     RowBox[{"if", " ", "A"}], "\[NotEqual]", "B"}], ",", " ", 
    RowBox[{"return", " ", "0"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7003227751056967`*^9, 3.700322813813786*^9}, {
   3.700322913458864*^9, 3.700322920539481*^9}, {3.70032295083998*^9, 
   3.7003229540998907`*^9}, {3.700323026817307*^9, 3.700323030264832*^9}, {
   3.7003231143328953`*^9, 3.7003231397184477`*^9}, {3.709734976246031*^9, 
   3.709735017956987*^9}, {3.709735067199789*^9, 3.7097351506591377`*^9}, 
   3.709735221197083*^9, {3.709736096802809*^9, 3.709736113825224*^9}, {
   3.7097373929773703`*^9, 3.709737399545711*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[64]:=",ExpressionUUID->"fa4656e4-b5ee-48c5-ba95-5846667ebe47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SIMPLIFY", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "k"}], "}"}], ",", 
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "[", "A", "]"}]}], ",", 
       RowBox[{"k", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"newA", "=", 
          RowBox[{"newA", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "3"}], "]"}], "]"}], "\[Rule]", "0"}], 
            "}"}]}]}]}], "]"}]}], "]"}], ";", "newA"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7003012283662357`*^9, 3.700301291672268*^9}, {
   3.700301327722187*^9, 3.7003014601541758`*^9}, 3.700301703032436*^9, {
   3.700301758613192*^9, 3.700301813117244*^9}, {3.7003018596229887`*^9, 
   3.7003019267011433`*^9}, {3.7003150414771976`*^9, 3.70031507644951*^9}, {
   3.700560931733856*^9, 3.700560949377207*^9}, {3.700582716198595*^9, 
   3.700582721943596*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[65]:=",ExpressionUUID->"34a9967c-f132-4eab-bad3-cdc771ba90e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SIMPLIFYWAY", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"arrow", ",", "newA", ",", "k"}], "}"}], ",", 
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"arrow", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "[", "A", "]"}]}], ",", 
       RowBox[{"k", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"arrow", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"arrow", ",", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "3"}], "]"}], "]"}], "\[Rule]", "0"}]}], 
           "]"}]}]}], "]"}]}], "]"}], ";", "arrow"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7003177137888803`*^9, 3.7003177356605997`*^9}, {
  3.700317799925707*^9, 3.700317842099834*^9}, {3.700317886965331*^9, 
  3.700317995144143*^9}, {3.700410757562505*^9, 3.700410759265748*^9}, {
  3.7005827246801033`*^9, 3.7005827249834633`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[66]:=",ExpressionUUID->"546c6362-22f7-43d6-b087-6075b0a46c58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DROPZERO", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "i"}], 
     RowBox[{"(*", 
      RowBox[{"n", ",", "num"}], "*)"}], "}"}], ",", 
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "A", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"valueequal", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newA", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], "\[Equal]", 
          "1"}], ",", 
         RowBox[{
          RowBox[{"newA", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newA", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newA", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "newA"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.700312949702691*^9, 3.700312974260819*^9}, {
   3.700313048809505*^9, 3.700313057838389*^9}, {3.700313088591929*^9, 
   3.700313140547326*^9}, {3.7003142059567013`*^9, 3.700314327803433*^9}, {
   3.700314365542718*^9, 3.700314489238552*^9}, {3.7003145548735857`*^9, 
   3.700314571279132*^9}, {3.700314835893469*^9, 3.70031490527398*^9}, {
   3.700314948251872*^9, 3.700314965168996*^9}, 3.7003150073078527`*^9, {
   3.700402954400434*^9, 3.700403088948127*^9}, {3.700403126231348*^9, 
   3.7004031846976767`*^9}, {3.70040327478535*^9, 3.700403348340911*^9}, {
   3.700722895569313*^9, 3.700722896941145*^9}, 3.709735210623316*^9, {
   3.70973584601472*^9, 3.709735851307557*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[67]:=",ExpressionUUID->"0d8ff165-1cae-45f3-942e-e94d65a6b2ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DROPONE", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "i"}], "}"}], ",", 
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "A", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"valueequal", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newA", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "\[Equal]", 
          "1"}], ",", 
         RowBox[{
          RowBox[{"newA", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newA", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newA", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "newA"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7005605392775927`*^9, 3.7005605978257*^9}, {
  3.7097352313904343`*^9, 3.709735232530024*^9}, {3.709735857485426*^9, 
  3.70973585914741*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[68]:=",ExpressionUUID->"23fbd455-f7ed-48f3-bae5-1c004cd51a62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FORWARDZERO", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", 
      RowBox[{"(*", 
       RowBox[{"N", ","}], "*)"}], "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"N", "=", 
        RowBox[{"Length", "[", "A", "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "A", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"valueequal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"newA", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "0"}], "]"}], "\[Equal]", 
           "0"}], "&&", 
          RowBox[{
           RowBox[{"valueequal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"newA", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "0"}], "]"}], "\[Equal]", 
           "1"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"newA", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"newA", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", "newA"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700320706134479*^9, 3.700320769366455*^9}, {
  3.700320807427466*^9, 3.700320891741889*^9}, {3.700320944638291*^9, 
  3.700321093165058*^9}, {3.700321175180913*^9, 3.700321311486389*^9}, {
  3.700321357856456*^9, 3.700321360642892*^9}, {3.70056126244518*^9, 
  3.7005612651085052`*^9}, {3.70056131575454*^9, 3.700561507594336*^9}, {
  3.700561641459559*^9, 3.700561648492272*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[69]:=",ExpressionUUID->"21383879-e2c1-468e-9c8a-08dd4d496b67"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"variable", "[", "vertexdata_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"var", "=", "vertexdata"}], 
      RowBox[{"(*", 
       RowBox[{",", "t", ",", "q"}], "*)"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"var", "="}], "*)"}], 
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", "var", "]"}], "//", 
                 "DeleteDuplicates"}], ",", "0"}], "]"}], ",", "1"}], "]"}], 
            ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "t"}], "]"}], ",", "q"}], "]"}],
       "//", "Sort"}]}], 
    RowBox[{"(*", ";", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "var", "*)"}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.700555954867588*^9, 3.700556670410397*^9, {3.70056364484239*^9, 
   3.700563646928525*^9}, {3.7255186547078876`*^9, 3.7255186985057592`*^9}, {
   3.725518756987814*^9, 3.7255187627673273`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[70]:=",ExpressionUUID->"560ccb39-22ab-4af7-8c36-88fa4254b1e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logexpressionQ", "[", "powerexpressionQ_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "KKK", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KKK", "=", "powerexpressionQ"}], ";", "\[IndentingNewLine]", 
     RowBox[{"KKK", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", "powerexpressionQ", " ", "]"}], "//", 
        "PowerExpand"}], "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     "KKK"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7005567627529297`*^9, 3.700556901388137*^9}, {
  3.7005570238242292`*^9, 3.700557051940277*^9}, {3.700557682209756*^9, 
  3.700557682414845*^9}, {3.700673460985257*^9, 3.700673461427754*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[71]:=",ExpressionUUID->"b2fe07ef-9b80-4fb3-85ad-8ed431479874"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EXPRESSIONFORQ", "[", 
   RowBox[{"vertexdata_", ",", "ppp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coelist", ",", "expressQ", ",", "var", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"var", "=", 
      RowBox[{"variable", "[", "vertexdata", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"expressQ", "=", 
      RowBox[{"logexpressionQ", "[", "ppp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coelist", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "var", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.88, 1, 0.88]], 
     StyleBox[
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "var", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coelist", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{"var", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coelist", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "2"}], "]"}], "]"}], "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{"expressQ", ",", 
                RowBox[{"var", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "//", "Expand"}], "//",
              "Exp"}], ")"}]}], ")"}]}]}], "]"}],
      Background->RGBColor[0.88, 1, 0.88]], 
     StyleBox[";",
      Background->RGBColor[0.88, 1, 0.88]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.88, 1, 0.88]], 
     RowBox[{"coelist", "//", "DROPONE"}]}]}], 
   StyleBox["\[IndentingNewLine]",
    Background->RGBColor[0.88, 1, 0.88]], 
   StyleBox["]",
    Background->RGBColor[0.88, 1, 0.88]]}]}]], "Input",
 CellChangeTimes->{{3.700670383885804*^9, 3.7006704501495333`*^9}, {
  3.7006704947137957`*^9, 3.7006705074522667`*^9}, {3.700672455989225*^9, 
  3.7006724617202673`*^9}, {3.700673340317168*^9, 3.7006733528642817`*^9}, {
  3.70067349394144*^9, 3.7006734944053097`*^9}, {3.7172101529405537`*^9, 
  3.717210154376543*^9}, {3.725512063215273*^9, 3.7255120639631567`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"dccb4874-91ca-43a0-b456-65814d8ce538"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EXPRESSIONFORQ2", "[", 
   RowBox[{"vertexdata_", ",", "ppp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "expressionQ2", ",", "powerexpressionQ", ",", "var", ",", "i", ",", 
      "product"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"powerexpressionQ", "=", 
      RowBox[{"logexpressionQ", "[", "ppp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"variable", "[", "vertexdata", "]"}], ",", 
         RowBox[{"variable", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "shurdata", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}], "]"}]}], "]"}], "//", 
       "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"product", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"expressionQ2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "var", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"expressionQ2", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"expressionQ2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Coefficient", "[", 
              RowBox[{"powerexpressionQ", ",", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], "]"}], "*", 
             SuperscriptBox[
              RowBox[{"var", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "2"]}], "//", "Expand"}], "//",
            "Exp"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "expressionQ2", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"product", "=", 
        RowBox[{"product", "*", 
         RowBox[{"expressionQ2", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "\"\<\n\>\"", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
          "product"}], "//", "Factor"}], ",", " ", 
        "\"\<      \n                              , which should be \
left\>\""}], "\[IndentingNewLine]", "]"}], "*)"}], "\[IndentingNewLine]", " ", 
     RowBox[{"product", "//", "Factor"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.700670135285904*^9, 3.700670173967647*^9}, {
   3.700670207020295*^9, 3.700670235280521*^9}, {3.70067060709768*^9, 
   3.7006706402530947`*^9}, {3.700670671402947*^9, 3.700670727227172*^9}, {
   3.7006733633530293`*^9, 3.700673368846643*^9}, {3.700673503365345*^9, 
   3.700673503781734*^9}, {3.700884446665468*^9, 3.70088446488498*^9}, {
   3.700884957029376*^9, 3.700885014262032*^9}, 3.700885066753124*^9, {
   3.707910926181883*^9, 3.7079110141558857`*^9}, {3.7079763810871267`*^9, 
   3.707976440096004*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"df18e937-3211-4eab-9d1b-ef5f290732b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"canceuu", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newa", ",", "newb"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newa", "=", "a"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newb", "=", "b"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newa", ",", "newb", ",", 
        RowBox[{"Hu", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], ",", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["0", "T"]}], "\[Rule]", "0"}]}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7002275307751427`*^9, 3.700227616614027*^9}, {
   3.700227976909693*^9, 3.700227983876523*^9}, 3.700228041723473*^9, {
   3.7002283597474117`*^9, 3.700228380067732*^9}, {3.700228847254345*^9, 
   3.700228917451147*^9}, {3.700229075429123*^9, 3.700229203731814*^9}, {
   3.7002293123805103`*^9, 3.700229409610968*^9}, {3.700229492731572*^9, 
   3.7002295362389183`*^9}, {3.700230523114737*^9, 3.700230543558753*^9}, {
   3.700236189741193*^9, 3.700236193427648*^9}, {3.700303112892726*^9, 
   3.7003031471418056`*^9}, {3.70030319813089*^9, 3.700303227238305*^9}, {
   3.700303272364869*^9, 3.700303295661038*^9}, {3.70030338731938*^9, 
   3.7003033947476683`*^9}, {3.7072982225171213`*^9, 3.7072982229689493`*^9}, 
   3.707298440738106*^9, {3.707728862759778*^9, 3.70772886949467*^9}, {
   3.707728911757978*^9, 3.707728917664504*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[74]:=",ExpressionUUID->"12b348bf-115f-421e-9cee-4f03d3677046"],

Cell[BoxData[
 RowBox[{
  RowBox[{"canceuTu", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newa", ",", "newb"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newa", "=", "a"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"b", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newa", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"b", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newb", "=", "b"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"a", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newb", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"a", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newa", ",", "newb", ",", 
        RowBox[{"HuT", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ",", "1"}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], ",", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["0", "T"]}], "\[Rule]", "0"}]}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.700302886423064*^9, 3.700302968178393*^9}, 
   3.700303009817572*^9, 3.7003030472162027`*^9, {3.700303288867148*^9, 
   3.7003032904572487`*^9}, {3.700303352322961*^9, 3.700303368119958*^9}, {
   3.700303398872422*^9, 3.700303400905231*^9}, {3.7003037522379017`*^9, 
   3.700303757668268*^9}, {3.707298206676161*^9, 3.70729821837049*^9}, 
   3.7072984429254208`*^9, 3.707728873860321*^9, {3.7077289284232197`*^9, 
   3.7077289288084583`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[75]:=",ExpressionUUID->"7295e98e-4fa6-49af-ab9a-ae61f1476b6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"process", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sign", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sign", "=", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"[", "2", "]"}], "]"}], 
       RowBox[{"b", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sign", "\[Equal]", "1"}], ",", 
       RowBox[{"canceuu", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", 
       RowBox[{"canceuTu", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.700307774852077*^9, 3.700307920124148*^9}, {
  3.7003079505445538`*^9, 3.700307973331361*^9}, {3.700403840420967*^9, 
  3.700403898237377*^9}, {3.7004039720291243`*^9, 3.7004040268569603`*^9}, {
  3.700404101708013*^9, 3.700404106750247*^9}, {3.700404187751807*^9, 
  3.70040422083379*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[76]:=",ExpressionUUID->"40f8cf9b-3651-4202-9a59-8149a8c5497c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LEGPROCESS", "[", 
   RowBox[{"legdata_", ",", "readydata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newvar", ",", "newreadydata", ",", "newlegdata", ",", "i", ",", "j"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newlegdata", "=", "legdata"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newreadydata", "=", "readydata"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newvar", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "legdata", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "newvar", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "newreadydata", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"valueequal", "[", 
             RowBox[{
              RowBox[{"newvar", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"newreadydata", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", "1"}], 
           ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"newlegdata", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"newreadydata", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"newlegdata", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"legdata", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newlegdata", "//", "DROPZERO"}], "//", "Legcollect"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7003766111368933`*^9, 3.700376693180214*^9}, {
   3.7003767785778418`*^9, 3.700376800783743*^9}, {3.700376840216753*^9, 
   3.700376883613872*^9}, {3.7003951906576023`*^9, 3.7003952015616837`*^9}, 
   3.7003953474074697`*^9, {3.700395402822212*^9, 3.700395437913065*^9}, {
   3.7003954850649443`*^9, 3.700395670167713*^9}, {3.700395749877647*^9, 
   3.700395808036787*^9}, {3.700395854414062*^9, 3.700395855794937*^9}, {
   3.700395891603445*^9, 3.700395943960025*^9}, {3.700396004297387*^9, 
   3.700396092278857*^9}, {3.700396140455597*^9, 3.700396182825553*^9}, {
   3.7003962239525757`*^9, 3.700396313312364*^9}, {3.700396354224928*^9, 
   3.700396363853476*^9}, {3.7003964393128767`*^9, 3.7003964707148438`*^9}, {
   3.700396544832963*^9, 3.700396555609874*^9}, {3.70039660820039*^9, 
   3.7003966086261*^9}, {3.700396644148101*^9, 3.700396673207164*^9}, 
   3.700400410374914*^9, {3.7004004471151123`*^9, 3.700400449226796*^9}, {
   3.7004006439891987`*^9, 3.70040068885956*^9}, {3.70040072147122*^9, 
   3.700400725537232*^9}, {3.700400795664795*^9, 3.700400811825431*^9}, {
   3.700400842661174*^9, 3.700400887104559*^9}, {3.700401362091728*^9, 
   3.700401362285304*^9}, {3.700402345216784*^9, 3.700402347339593*^9}, {
   3.70040244682421*^9, 3.7004024475189323`*^9}, {3.7004026385563927`*^9, 
   3.700402644231062*^9}, {3.700672606740896*^9, 3.7006726186273327`*^9}, {
   3.700677737093892*^9, 3.700677750272003*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[77]:=",ExpressionUUID->"6d6d07be-0054-4751-b6ec-91c3fe65028b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Legcollect", "[", "A_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newA", ",", "var", ",", "newB", ",", "i", ",", "j"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "A", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "//", "DeleteDuplicates"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newB", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"Length", "[", "var", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "var", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"newB", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{"var", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "newA", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"valueequal", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"newA", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", "1"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"newB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"newB", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "*", 
                RowBox[{
                 RowBox[{"newA", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
       "newB"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.700577515397523*^9, 3.7005776192034616`*^9}, {
   3.700577911312204*^9, 3.700578057106276*^9}, {3.700578091499116*^9, 
   3.700578211998687*^9}, {3.700578257187531*^9, 3.7005782762612343`*^9}, {
   3.7005783190458117`*^9, 3.700578349822661*^9}, {3.700578438113605*^9, 
   3.7005785951607656`*^9}, 3.700579498458686*^9, {3.700579543896634*^9, 
   3.7005795573292513`*^9}, {3.700579606457418*^9, 3.700579629179063*^9}, {
   3.700579736433975*^9, 3.700579743824028*^9}, {3.7005797824552402`*^9, 
   3.7005797932151318`*^9}, {3.7005799106069717`*^9, 3.700579985504506*^9}, {
   3.70058243378992*^9, 3.700582512523876*^9}, {3.700582694919129*^9, 
   3.700582699024913*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[78]:=",ExpressionUUID->"af2c487e-9699-44f3-9212-57a4f922b162"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.701323009976882*^9, 3.701323104066903*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"663df8da-e06b-443e-bf9e-c7ed006ff981"],

Cell[BoxData[
 RowBox[{
  RowBox[{"readycanceldata", "[", 
   RowBox[{"readylegdata_", ",", "readydata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newlegdata", ",", "newreadydata", ",", "i", ",", "j"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newlegdata", "=", "readylegdata"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"newreadydata", "=", "readydata"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newvar", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "legdata", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "newvar", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "newreadydata", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"valueequal", "[", 
             RowBox[{
              RowBox[{"newvar", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"newreadydata", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", "1"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"newreadydata", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"legdata", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{"readydata", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "\[IndentingNewLine]", "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
          "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "newreadydata"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.700673907853386*^9, 3.701322963258411*^9, {3.70132309688822*^9, 
   3.701323108119255*^9}, {3.701323150573304*^9, 3.7013231509956703`*^9}, {
   3.701323260716433*^9, 3.7013232614882917`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"f3d491fd-82f6-4fe0-9331-bd402d6336d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"docandellation", "[", 
   RowBox[{"(*", 
    RowBox[{"legdata_", ","}], "*)"}], "readycancellationdata_", "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "roundshurdata", ",", "Left", ",", "Leftdata", ",", "i"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"roundshurdata", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Left", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Leftdata", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", "readycancellationdata"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"roundshurdata", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"roundshurdata", ",", 
            RowBox[{
             RowBox[{"process", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}]}], ")"}], "&&", 
        
        RowBox[{"(", 
         RowBox[{"Left", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"Left", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"process", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"Leftdata", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"Leftdata", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"process", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"process", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"process", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{"roundshurdata", ",", "Left", ",", "Leftdata"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7004043517893467`*^9, 3.7004044715281677`*^9}, {
   3.7004045063799458`*^9, 3.7004045197298317`*^9}, {3.700404628676517*^9, 
   3.700404629146121*^9}, {3.700404663357069*^9, 3.7004046641605043`*^9}, {
   3.700404695972014*^9, 3.700404728863266*^9}, {3.700404874733863*^9, 
   3.700404877630568*^9}, 3.700404958912204*^9, {3.7004056952512074`*^9, 
   3.700405701055147*^9}, {3.7004057385416193`*^9, 3.7004058962704067`*^9}, {
   3.700406078293798*^9, 3.7004061297104473`*^9}, {3.700406479421192*^9, 
   3.700406497044763*^9}, {3.700408746041102*^9, 3.700408850241056*^9}, {
   3.700408881970952*^9, 3.700409041015568*^9}, {3.700409071705179*^9, 
   3.700409098415729*^9}, 3.700575428064822*^9, {3.7072985070933437`*^9, 
   3.707298576213812*^9}, {3.707298634579627*^9, 3.70729863700599*^9}, {
   3.70729875799088*^9, 3.707298812467484*^9}, {3.707298858664832*^9, 
   3.707298872871438*^9}, {3.7072989166574593`*^9, 3.7072989702467527`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[81]:=",ExpressionUUID->"c87236df-0d7b-4f1b-b4d6-3ca508c77073"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ROUNDSHURDATA", "[", 
   RowBox[{"(*", 
    RowBox[{"legdata_", ","}], "*)"}], "readycancellationdata_", "]"}], ":=", 
  
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"docandellation", "[", 
      RowBox[{"(*", 
       RowBox[{"legdata", ","}], "*)"}], "readycancellationdata", "]"}], "[", 
     
     RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.70040651375242*^9, 3.700406553697928*^9}, {
  3.7004091579779263`*^9, 3.700409185312552*^9}, {3.700575546268011*^9, 
  3.700575553636463*^9}, {3.700673223837969*^9, 3.7006732275403643`*^9}, {
  3.700673683065598*^9, 3.700673745036269*^9}, {3.7006738253112803`*^9, 
  3.700673829822798*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[82]:=",ExpressionUUID->"0f59e6bb-ae0c-4ba6-963d-3d7e232706ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ROUNDLEFT", "[", 
   RowBox[{"(*", 
    RowBox[{"legdata_", ","}], "*)"}], "readycancellationdata_", "]"}], ":=", 
  
  RowBox[{
   RowBox[{"docandellation", "[", 
    RowBox[{"(*", 
     RowBox[{"legdata", ","}], "*)"}], "readycancellationdata", "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700409201300166*^9, 3.700409258530609*^9}, {
  3.7005755589570837`*^9, 3.700575564645602*^9}, {3.700673187860816*^9, 
  3.700673191227539*^9}, {3.7006737520890703`*^9, 3.700673810187931*^9}, {
  3.700673853287245*^9, 3.700673861146653*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[83]:=",ExpressionUUID->"6f769c1a-41dc-46ee-9937-bfc11ec03b6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ROUNDLEFTdata", "[", 
   RowBox[{"(*", 
    RowBox[{"legdata_", ","}], "*)"}], "readycancellationdata_", "]"}], ":=", 
  
  RowBox[{
   RowBox[{"docandellation", "[", 
    RowBox[{"(*", 
     RowBox[{"legdata", ","}], "*)"}], "readycancellationdata", "]"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7072989446457167`*^9, 3.7072989608802967`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"f08a1627-e325-4915-b516-e6f098b71dd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RECOLLECT", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "orderedA", ",", "var", ",", "i", ",", "j"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "newA", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Break", "[", "]"}], "&&"}], "*)"}], 
         RowBox[{
         "Print", "[", 
          "\"\<---  Note! input is EMPTY, you have gone throung all rounds, \
which means your result is complete. ---\>\"", "]"}], ","}]}], "*)"}], 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "newA", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], 
     RowBox[{"(*", "]", "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"orderedA", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Length", "[", "var", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "var", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "newA", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"valueequal", "[", 
             RowBox[{
              RowBox[{"var", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"newA", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", "1"}], 
           ",", 
           RowBox[{
            RowBox[{"orderedA", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"orderedA", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"newA", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orderedA", "//", "DROPZERO"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.700406613602231*^9, 3.7004066531751423`*^9}, {
   3.700406749185774*^9, 3.700406774406889*^9}, {3.700406839939602*^9, 
   3.700406846887959*^9}, {3.7004069933603783`*^9, 3.700407117541768*^9}, {
   3.700407203349415*^9, 3.700407221777768*^9}, {3.700407256976797*^9, 
   3.700407282907816*^9}, {3.700407345009694*^9, 3.700407476015259*^9}, {
   3.700407507797204*^9, 3.700407682560542*^9}, 3.700407732881878*^9, {
   3.7004077708739033`*^9, 3.700407772892241*^9}, {3.700407912738332*^9, 
   3.7004079138192*^9}, {3.700561869093305*^9, 3.700561872736924*^9}, {
   3.700564366816152*^9, 3.7005643726357813`*^9}, {3.7006778276242533`*^9, 
   3.700677931078024*^9}, {3.700677995195491*^9, 3.70067799907479*^9}, {
   3.700678122618845*^9, 3.700678367013303*^9}, 3.7006784029976263`*^9, {
   3.700718340878215*^9, 3.7007183549577427`*^9}, 3.700719091377502*^9, {
   3.700719125342708*^9, 3.700719130758582*^9}, {3.700722230905917*^9, 
   3.700722303814939*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[85]:=",ExpressionUUID->"a824adba-3892-41ce-b87b-9186ff656f7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GOODRECOLLECT", "[", "A_", "]"}], ":=", 
  RowBox[{
   RowBox[{"SPLIT", "[", 
    RowBox[{"RECOLLECT", "[", "A", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700719065430586*^9, 3.700719184422903*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"b9610b0f-162c-48a7-b7e1-c9314282b7e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SPLIT", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "newB", ",", "i", ",", "list0", ",", "list1"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list0", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "newA", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "newA", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "newA", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"newA", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", "2"}], ",", 
         RowBox[{
          RowBox[{"list0", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "1"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newA", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"A", ",", "list0", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newB", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"A", ",", 
        RowBox[{"list1", "-", "list0"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newA", ",", "newB"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700717290236293*^9, 3.700717426091939*^9}, {
  3.700717509083139*^9, 3.7007175827485332`*^9}, {3.700717617589623*^9, 
  3.700717760459407*^9}, {3.7007178243197613`*^9, 3.700717827477375*^9}, {
  3.7007179781621943`*^9, 3.700717994738756*^9}, {3.700718052921111*^9, 
  3.7007180671680307`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"66444588-4396-4767-9cfd-6da6bb921ad6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SHURLEFT", "[", "A_", "]"}], ":=", 
  RowBox[{
   RowBox[{"SPLIT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "//", "SIMPLIFY"}], "//", "DROPZERO"}], "//", 
     "RECOLLECT"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700718521958778*^9, 3.700718589061048*^9}, {
  3.700718644996459*^9, 3.700718673702828*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"d9f0ae8f-6caa-49ab-9cdc-a97064286902"],

Cell[BoxData[
 RowBox[{
  RowBox[{"READYSHURDATA", "[", "shurdata_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"shurdata", "//", "SIMPLIFY"}], "//", "DROPZERO"}], "//", 
    "GOODRECOLLECT"}], "//", "FORWARDZERO"}]}]], "Input",
 CellChangeTimes->{{3.7006716580473137`*^9, 3.7006717056438026`*^9}, {
  3.70071916754875*^9, 3.70071916826153*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"7d445c8c-2d12-465b-9d67-fe143e45f319"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"READYLEGDATA", "[", 
    RowBox[{"legdata_", ",", "shurdata_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"legdata", "//", "DROPZERO"}], "//", "Legcollect"}], ")"}], "/.", 
     RowBox[{"(", 
      RowBox[{"shurdata", "//", "SIMPLIFYWAY"}], ")"}]}], "//", 
    "DROPZERO"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7005572484888697`*^9, 3.7005572548002567`*^9}, {
   3.700671844435351*^9, 3.700671926917203*^9}, {3.7006720276047583`*^9, 
   3.700672032633429*^9}, {3.700672108125649*^9, 3.700672113496114*^9}, 
   3.700717002010137*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"5989b6a8-7790-4ca9-a3e2-76b3be7ed260"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SEESHURLEFT", "[", "shurdata_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "i"}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"SHURLEFT", "[", "shurdata", "]"}], "]"}], "\[NotEqual]", 
        "0"}], ",", 
       "\"\<Because Young tableaux of outer lines many not be empty, the \
folling shur function should be LEFT in the final result -->:\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"SHURLEFT", "[", "shurdata", "]"}], "]"}], "\[NotEqual]", 
        "0"}], ",", 
       RowBox[{"SHURLEFT", "[", "shurdata", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"SHURLEFT", "[", "shurdata", "]"}], "]"}], "\[NotEqual]", 
        "0"}], ",", "\"\<, which is\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"SHURLEFT", "[", "shurdata", "]"}], "]"}], "\[NotEqual]", 
        "0"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"SHURLEFT", "[", "shurdata", "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"A", "=", 
          RowBox[{"A", "*", 
           RowBox[{"S", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"SHURLEFT", "[", "shurdata", "]"}], ",", "1"}], "]"}], 
             "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", "A"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7007219400930567`*^9, 3.7007220250160217`*^9}, {
  3.700722055649572*^9, 3.70072207605399*^9}, {3.7079903760381927`*^9, 
  3.7079904163805933`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"8ecc5067-58b2-4b1a-9625-6b05378cf142"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PRODUCT", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "P", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"newA", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"P", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "A", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"P", "*", 
         RowBox[{"(", 
          RowBox[{"newA", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "P"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700800718466175*^9, 3.700800783385065*^9}, {
  3.700800831771768*^9, 3.700800870441535*^9}, {3.700800949943253*^9, 
  3.700800952491022*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"1e33b7ce-76d7-470c-8583-6b67d02194a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"APART", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "RR", ",", "apart", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "//", "Log"}], "//", "PowerExpand"}], "//", "Expand"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"RR", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"apart", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "newA", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"apart", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"apart", ",", 
          RowBox[{
           RowBox[{"newA", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "//", "Exp"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "apart"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7010618053902063`*^9, 3.7010618234399767`*^9}, {
  3.70106188671329*^9, 3.701061926623946*^9}, {3.7041117496898413`*^9, 
  3.704111750119316*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"42b6f39d-333a-49d5-bff0-8f921f01747a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EXTRACTshurdata", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "SnewA"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", 
      RowBox[{"APART", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SnewA", "=", 
      RowBox[{"newA", "/.", 
       RowBox[{"{", 
        RowBox[{"s", "\[Rule]", "S"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "SnewA"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.70106196840871*^9, 3.701062102135104*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"5e9a3312-328d-4749-9ed2-363fc92b09ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Extractvertexdata", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "SnewA"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", 
      RowBox[{"APART", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SnewA", "=", 
      RowBox[{"newA", "/.", 
       RowBox[{"{", 
        RowBox[{"C", "\[Rule]", "V"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "SnewA"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.701063313293551*^9, 3.7010633588496857`*^9}, 
   3.7010634014230137`*^9, {3.7036676364590607`*^9, 3.703667648360148*^9}, 
   3.707970403367631*^9, {3.70797044432978*^9, 3.707970480640333*^9}, {
   3.707971421546706*^9, 3.7079714329356537`*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->"In[95]:=",ExpressionUUID->"2ee92cc0-3da5-482c-b611-8db66e75635d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BACKtoshur", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newA", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"newA", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"S", "/@", "A"}], ")"}], "//", "PRODUCT"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.70139898170129*^9, 3.701399136735361*^9}, {
  3.70139917158646*^9, 3.701399184638042*^9}},
 Background->RGBColor[1, 0.925, 0.925],
 CellLabel->"In[96]:=",ExpressionUUID->"b1d32c86-f133-4c58-b392-4bd710726434"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    StyleBox["Vertexdata",
     FontColor->RGBColor[1, 0, 0]], "[", "topvex_", "]"}], ":=", 
   RowBox[{"topvex", "//", "Extractvertexdata"}]}]}]], "Input",
 CellChangeTimes->{{3.707993400386813*^9, 3.7079934649105177`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"c63b549a-26fa-479f-a2e1-14e4411cd016"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     StyleBox["PPP",
      FontColor->RGBColor[1, 0, 0]], "[", 
     RowBox[{"topvex_", ",", "legfactor_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"topvex", "*", "legfactor"}], "//", "Extractppp"}]}],
   Background->RGBColor[0.94, 0.88, 0.94]], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZZZ", "[", "topvex_", "]"}], ":=", 
  RowBox[{"topvex", "//", "ExtractZZZ"}]}]}], "Input",
 CellChangeTimes->{{3.707993486782154*^9, 3.7079935295247097`*^9}, {
  3.708083760794422*^9, 3.7080837702981567`*^9}, {3.7080838973137417`*^9, 
  3.708083901722465*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"082aa43d-7a32-476a-adb2-a47a4d4c411b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.707993401929152*^9, 3.708251805323985*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"3d13284f-5a84-44fa-9530-afe7add680d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ROUND", "[", 
    RowBox[{"legdata_", ",", "shurdata_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "j", ",", "readylegdata", ",", "Shurleft", ",", "readydata", 
       ",", "readycancellationdata", ",", "nextshurdata", ",", 
       "nextshurlegdata", ",", "shurshur", ",", "output", ",", "LEFT1", ",", 
       "LEFT2", ",", "NEXTshur"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"readylegdata", "=", 
       RowBox[{"READYLEGDATA", "[", 
        RowBox[{"legdata", ",", "shurdata"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["shurshur",
        FontColor->RGBColor[1, 0, 0]], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"SHURLEFT", "[", "shurdata", "]"}], "]"}], "\[NotEqual]", 
          "0"}], ",", 
         RowBox[{"SEESHURLEFT", "[", "shurdata", "]"}], ",", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Shurleft", "=", 
       RowBox[{"SHURLEFT", "[", "shurdata", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"readydata", "=", 
       RowBox[{"shurdata", "//", "READYSHURDATA"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"readycancellationdata", "=", 
       RowBox[{"readycanceldata", "[", 
        RowBox[{"readylegdata", ",", "readydata"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LEFT1", "=", 
       RowBox[{"ROUNDLEFTdata", "[", "readycancellationdata", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LEFT2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ROUNDLEFT", "[", "readycancellationdata", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "\[Rule]", "1"}], ",", 
           RowBox[{"j", "\[Rule]", "1"}]}], "}"}]}], "//", "Simplify"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nextshurdata", "=", 
       RowBox[{"ROUNDSHURDATA", "[", "readycancellationdata", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"NEXTshur", "=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"nextshurdata", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Shurleft", ",", "1"}], "]"}]}], "]"}], "//", "Sort"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nextshurlegdata", "=", 
       RowBox[{"LEGPROCESS", "[", 
        RowBox[{"readylegdata", ",", "readydata"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "1", "*)"}], "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"Leg", "/@", "nextshurlegdata"}], "//", "PRODUCT"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "2", "*)"}], "  ", "shurshur", ",", 
           "                                              ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "3", "*)"}], "  ", "NEXTshur", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "4", "*)"}], "  ", "nextshurlegdata", ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "5", "*)"}], "  ", "LEFT1", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "6", "*)"}], "  ", "LEFT2"}], 
          "\[IndentingNewLine]", "}"}], ",", "Null"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"output", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"output", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"output", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"output", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
     "*)"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outputroundlist1", "[", 
    RowBox[{"legdata_", ",", "shurdata_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ROUND", "[", 
      RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
     RowBox[{"[", "5", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "\[Rule]", "1"}], ",", 
      RowBox[{"j", "\[Rule]", "1"}]}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outputroundlist2", "[", 
    RowBox[{"legdata_", ",", "shurdata_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ROUND", "[", 
      RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
     RowBox[{"[", "6", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "\[Rule]", "1"}], ",", 
      RowBox[{"j", "\[Rule]", "1"}]}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputroundfactor", "[", 
   RowBox[{"legdata_", ",", "shurdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ROUND", "[", 
       RowBox[{"legdata", ",", "shurdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"output", "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"output", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"output", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "&&", 
       RowBox[{"{", 
        RowBox[{"output", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "}"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"output", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextrounddata", "[", 
   RowBox[{"legdata_", ",", "shurdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ROUND", "[", 
       RowBox[{"legdata", ",", "shurdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"output", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"output", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.707979957530838*^9, 3.7079802472139187`*^9}, {
   3.70798030360693*^9, 3.707980329911119*^9}, {3.7079803789670887`*^9, 
   3.707980381321673*^9}, {3.707980444635571*^9, 3.7079804456181517`*^9}, {
   3.707985360172949*^9, 3.707985363247271*^9}, {3.70798539680054*^9, 
   3.7079854001771173`*^9}, {3.707985548604892*^9, 3.70798557419112*^9}, {
   3.707985638521345*^9, 3.707985649210413*^9}, {3.7079894940377207`*^9, 
   3.70798954714813*^9}, {3.7079899822786283`*^9, 3.707989990750877*^9}, {
   3.707990043507325*^9, 3.707990092818495*^9}, {3.7079918959649057`*^9, 
   3.70799189646063*^9}, {3.708081968168762*^9, 3.708082037467554*^9}, {
   3.7080820871424713`*^9, 3.708082385198228*^9}, {3.708083006795583*^9, 
   3.7080830115128717`*^9}, {3.708083088408142*^9, 3.7080832137056313`*^9}, {
   3.70808544280341*^9, 3.708085443855196*^9}, {3.708085501895074*^9, 
   3.708085519802588*^9}, {3.708087284427318*^9, 3.708087375117094*^9}, {
   3.708087694942918*^9, 3.708087704110745*^9}, {3.708088532045483*^9, 
   3.708088534442582*^9}, {3.708091906269204*^9, 3.7080920011246643`*^9}, {
   3.708092103954794*^9, 3.708092226492654*^9}, 3.7080922570262012`*^9, {
   3.708092308066057*^9, 3.708092324539151*^9}, {3.708092660196879*^9, 
   3.708092663094756*^9}, {3.708094310799058*^9, 3.708094343844328*^9}, {
   3.708094702065228*^9, 3.708094712867977*^9}, {3.7080968112891293`*^9, 
   3.708096816573298*^9}, 3.708142033606905*^9, {3.708142522669848*^9, 
   3.708142557414538*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"13290486-0f4b-48fd-9a7c-524fc4ada8cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"breakornot", "[", "nextshurdata_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{
       RowBox[{"nextshurdata", "//", "SIMPLIFY"}], "//", "DROPZERO"}]}], ";", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"{", "}"}]}], ")"}], ",", 
       "\"\<shurdata={}, Last Round, break the program.\>\"", ",", 
       "\"\<continue\>\""}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.707987079649885*^9, 3.7079872447275667`*^9}, {
  3.70798727812407*^9, 3.707987334936795*^9}, {3.7079874247528152`*^9, 
  3.707987485342153*^9}, {3.707988350370352*^9, 3.7079883562427588`*^9}, {
  3.708059002840041*^9, 3.708059045963258*^9}, {3.708059190112145*^9, 
  3.7080592004087687`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"ec686a75-c0b5-4645-af2c-48636462579a"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"ALLROUND", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"outfactor", ",", 
       RowBox[{"outputlist1", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"outputlist2", "=", 
        RowBox[{"{", "}"}]}], ",", "legg", ",", "shurr", ",", 
       RowBox[{"legdata", "=", "x"}], ",", 
       RowBox[{"shurdata", "=", "y"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"breakornot", "[", "shurdata", "]"}], "\[Equal]", 
         "\"\<continue\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"outfactor", "=", 
          RowBox[{"outputroundfactor", "[", 
           RowBox[{"legdata", ",", "shurdata"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"outputlist1", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"outputlist1", ",", 
            RowBox[{"outputroundlist1", "[", 
             RowBox[{"legdata", ",", "shurdata"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"outputlist2", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"outputlist2", ",", 
            RowBox[{"outputroundlist2", "[", 
             RowBox[{"legdata", ",", "shurdata"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"legg", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"nextrounddata", "[", 
             RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "//", "Sort"}]}], ";", 
         RowBox[{"shurr", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"nextrounddata", "[", 
             RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//", "Sort"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"legdata", "=", "legg"}], ";", "\[IndentingNewLine]", 
         RowBox[{"shurdata", "=", "shurr"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "outfactor", ",", "\[IndentingNewLine]", "outputlist1", ",", 
        "\[IndentingNewLine]", "outputlist2"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}],
  FontColor->GrayLevel[0]]], "Input",
 CellChangeTimes->{{3.708082489322796*^9, 3.708082533125705*^9}, {
   3.708082594815686*^9, 3.708082607619039*^9}, {3.708082662447966*^9, 
   3.708082702148947*^9}, {3.708082733574416*^9, 3.7080827841525793`*^9}, {
   3.7080828294793863`*^9, 3.7080828624152308`*^9}, {3.70808295030895*^9, 
   3.708082952776732*^9}, {3.708084191541667*^9, 3.708084200083927*^9}, {
   3.708084235806418*^9, 3.708084239834938*^9}, {3.7080852656620893`*^9, 
   3.708085268539981*^9}, {3.708085327615898*^9, 3.7080853462319927`*^9}, {
   3.708085447903577*^9, 3.708085490087584*^9}, {3.708087238681286*^9, 
   3.708087267116022*^9}, {3.708087383108109*^9, 3.708087493398265*^9}, {
   3.708087807009193*^9, 3.708087808634907*^9}, {3.70808793614139*^9, 
   3.708087938180287*^9}, {3.708088132052265*^9, 3.7080881372386627`*^9}, {
   3.708088301209259*^9, 3.7080883036268587`*^9}, 3.708089804688539*^9, {
   3.7080937632008743`*^9, 3.708093908269508*^9}, {3.708093982829121*^9, 
   3.708093984246069*^9}, {3.708094127574917*^9, 3.708094217412716*^9}, {
   3.708094249546896*^9, 3.708094287246056*^9}, {3.708094373357972*^9, 
   3.708094475466218*^9}, {3.708094655316249*^9, 3.7080946601007442`*^9}, {
   3.70809614733279*^9, 3.708096147672138*^9}, {3.7080962330704517`*^9, 
   3.7080964181051292`*^9}, {3.708096538150049*^9, 3.708096538778646*^9}, {
   3.7080968541384*^9, 3.708096875635594*^9}, {3.708097086244397*^9, 
   3.70809709881531*^9}, {3.708099278261791*^9, 3.708099417012663*^9}, {
   3.7080998735898857`*^9, 3.708099885175168*^9}, {3.70810005990828*^9, 
   3.708100088445642*^9}, {3.7081001973908043`*^9, 3.708100248917623*^9}, {
   3.7081393145508413`*^9, 3.708139352064868*^9}, {3.7081395310357113`*^9, 
   3.70813954907152*^9}, {3.7081396162001247`*^9, 3.7081396416888866`*^9}, {
   3.708139832009302*^9, 3.7081398565733023`*^9}, {3.708139897351996*^9, 
   3.708139935457136*^9}, {3.708141495429515*^9, 3.708141555574543*^9}, {
   3.708141657428698*^9, 3.708141673185811*^9}, {3.708142661530469*^9, 
   3.708142689917918*^9}, 3.708142764582221*^9, {3.7081429638696404`*^9, 
   3.7081430230373363`*^9}, {3.708144454798194*^9, 3.708144492853883*^9}, {
   3.708150898083644*^9, 3.708150900077396*^9}, {3.708151135611844*^9, 
   3.7081511858635597`*^9}, {3.708151235764491*^9, 3.708151237576289*^9}, {
   3.7081513106212997`*^9, 3.708151318190387*^9}, {3.7082516736442327`*^9, 
   3.708251678642517*^9}, 3.708268793133101*^9},
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[107]:=",ExpressionUUID->"39be2f2f-126e-480e-a829-3f3e3e0a283b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   StyleBox[
    RowBox[{"ALLROUND2", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}],
    FontColor->GrayLevel[0]], 
   StyleBox[":=",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox["Module",
     FontColor->GrayLevel[0]], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox[
      RowBox[{"{", 
       RowBox[{"outfactor", ",", "nn", ",", 
        RowBox[{"outputlist1", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"outputlist2", "=", 
         RowBox[{"{", "}"}]}], ",", "legg", ",", "shurr", ",", 
        RowBox[{"legdata", "=", "x"}], ",", 
        RowBox[{"shurdata", "=", "y"}]}], "}"}],
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     StyleBox["\[IndentingNewLine]",
      FontColor->GrayLevel[0]], 
     StyleBox["\[IndentingNewLine]",
      FontColor->GrayLevel[0]], 
     RowBox[{
      RowBox[{
       StyleBox["For",
        FontColor->GrayLevel[0]], 
       StyleBox["[",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox[
         RowBox[{"nn", "=", "1"}],
         FontColor->GrayLevel[0]], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        RowBox[{
         RowBox[{
          StyleBox["(",
           FontColor->GrayLevel[0]], 
          RowBox[{
           StyleBox["nn",
            FontColor->GrayLevel[0]], 
           StyleBox["<=",
            FontColor->GrayLevel[0]], "10"}], ")"}], "&&", 
         RowBox[{"(", 
          StyleBox[
           RowBox[{
            RowBox[{"breakornot", "[", "shurdata", "]"}], "\[Equal]", 
            "\"\<continue\>\""}],
           FontColor->GrayLevel[0]], ")"}]}], ",", 
        RowBox[{"nn", "++"}], ",", "\[IndentingNewLine]", 
        StyleBox["\[IndentingNewLine]",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{
          RowBox[{
           RowBox[{"outfactor", "=", 
            RowBox[{"outputroundfactor", "[", 
             RowBox[{"legdata", ",", "shurdata"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"outputlist1", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"outputlist1", ",", 
              RowBox[{"outputroundlist1", "[", 
               RowBox[{"legdata", ",", "shurdata"}], "]"}]}], "]"}]}], ";", 
           RowBox[{"outputlist2", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"outputlist2", ",", 
              RowBox[{"outputroundlist2", "[", 
               RowBox[{"legdata", ",", "shurdata"}], "]"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"legg", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"nextrounddata", "[", 
               RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "//", "Sort"}]}], ";", 
           RowBox[{"shurr", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"nextrounddata", "[", 
               RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "//", "Sort"}]}], ";"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"legdata", "=", "legg"}], ";"}], "\[IndentingNewLine]", 
          RowBox[{"shurdata", "=", "shurr"}]}],
         FontColor->GrayLevel[0]]}], 
       StyleBox["\[IndentingNewLine]",
        FontColor->GrayLevel[0]], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}], 
      StyleBox[";",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nn", "-", "1"}], ",", "outfactor", ",", 
         "\[IndentingNewLine]", "outputlist1", ",", "\[IndentingNewLine]", 
         "outputlist2"}], "}"}],
       FontColor->GrayLevel[0]]}]}], 
    StyleBox["\[IndentingNewLine]",
     FontColor->GrayLevel[0]], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.708268774733835*^9, 3.70826877866476*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"a43939af-889f-4445-9472-07b750962d32"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7082670853588123`*^9, 3.708267085592548*^9}, {
   3.708267176966123*^9, 3.7082671773094873`*^9}, {3.708267732200663*^9, 
   3.7082677513683443`*^9}, {3.708268578255327*^9, 3.70826859330999*^9}, {
   3.7082686485044107`*^9, 3.7082686576193237`*^9}, 3.7082686916332006`*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"72fb5ac5-bc74-47a8-be3e-81acb44ffb61"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7013991876896887`*^9, 3.701399212312723*^9}, 
   3.701399276243066*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"3989400f-96fa-4050-b7c9-a33e271523b2"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Represent the result in terms of: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"                             ", 
    RowBox[{
     RowBox[{
      SubscriptBox["N", "uv"], "[", 
      RowBox[{"Q", ",", "t", ",", "q"}], "]"}], "  ", 
     RowBox[{
      SuperscriptBox["N", "half"], "[", 
      RowBox[{"Q", ",", "t", ",", "q"}], "]"}]}]}], TraditionalForm]],
  ExpressionUUID->"bc3b7e55-6e40-4100-8587-a8db3170cb29"]
}], "Subsubsection",
 CellChangeTimes->{{3.70737419971224*^9, 3.70737421253611*^9}, {
  3.707476622256505*^9, 3.70747663894003*^9}, {3.7082522966698*^9, 
  3.708252318310626*^9}, {3.708252865717393*^9, 3.708252865913624*^9}, {
  3.709015971994987*^9, 3.7090159824311857`*^9}, {3.740113565245884*^9, 
  3.740113603927841*^9}, {3.740118676710635*^9, 3.740118694638188*^9}, {
  3.740127559476437*^9, 3.7401276040870113`*^9}, {3.7401278579735107`*^9, 
  3.740127896431199*^9}, {3.740128020182588*^9, 
  3.740128035739349*^9}},ExpressionUUID->"8be33388-d641-4bd0-99cd-\
d07b7d4bfb40"],

Cell["\<\
In order to write the final result of partition function in terms of Young \
diagram, firstly, we teach Mathematica to recognize letters and then do \
simplification.\
\>", "Text",
 CellChangeTimes->{{3.717229226748001*^9, 3.7172293294292*^9}, {
  3.717229373850848*^9, 3.7172294066912947`*^9}, {3.740113623942645*^9, 
  3.7401136300685053`*^9}},ExpressionUUID->"5d8a9e3d-ddd1-42ec-b3d3-\
c275a388b95a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vvleft", "[", "vertexdata_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ii", ",", "i", ",", "j", ",", "v", ",", 
       RowBox[{"(*", 
        RowBox[{"vlist", ","}], "*)"}], "vv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vv", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"variable", "[", "vertexdata", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "v", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "vlist", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"valueequal", "[", 
              RowBox[{
               RowBox[{"v", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"vlist", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[Equal]", "1"}], 
            ",", 
            RowBox[{"vv", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"vv", ",", 
               RowBox[{"v", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv", "//", "Sort"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KKK", "[", "A_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"A", "//", "logexpressionQ"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0", "^", "T"}], "\[Rule]", "0"}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"isp", "[", 
     RowBox[{"A_", ",", "qt_"}], "]"}],
    Background->RGBColor[0.87, 0.94, 1]], 
   StyleBox[":=",
    Background->RGBColor[0.87, 0.94, 1]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"isp", ",", "L", ",", "p", ",", "KK"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KK", "=", 
       RowBox[{"KKK", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"isp", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{"Length", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"100", "+", 
           RowBox[{"Coefficient", "[", 
            RowBox[{"KK", ",", 
             RowBox[{"Log", "[", "qt", "]"}]}], "]"}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"p", "\[Rule]", "0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"L", "==", "1"}], ",", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"L", "==", "2"}], ",", 
          RowBox[{"isp", "=", "1"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "isp"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"signp", "[", 
     RowBox[{"express_", ",", "qt_"}], "]"}],
    Background->RGBColor[0.87, 0.94, 1]], 
   StyleBox[":=",
    Background->RGBColor[0.87, 0.94, 1]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ss", ",", "KK"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KK", "=", 
       RowBox[{"KKK", "[", "express", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"isp", "[", 
          RowBox[{"express", ",", "qt"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"100", "+", 
              RowBox[{"Coefficient", "[", 
               RowBox[{"KK", ",", 
                RowBox[{"Log", "[", "qt", "]"}]}], "]"}], "+", "p"}], "]"}], 
            "\[Equal]", "2"}], ")"}], ",", 
          RowBox[{"ss", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "qt"}], "}"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"100", "+", 
                RowBox[{"Coefficient", "[", 
                 RowBox[{"KK", ",", 
                  RowBox[{"Log", "[", "qt", "]"}]}], "]"}], "+", "p"}], "]"}],
               "\[Equal]", "0"}], ")"}], ",", 
            RowBox[{"ss", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}], ",", "qt"}], "}"}]}]}], "]"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"isp", "[", 
          RowBox[{"express", ",", "qt"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"100", "+", 
              RowBox[{"Coefficient", "[", 
               RowBox[{"KK", ",", 
                RowBox[{"Log", "[", "qt", "]"}]}], "]"}], "+", "p"}], "]"}], 
            "\[Equal]", "3"}], ")"}], ",", 
          RowBox[{"ss", "=", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "qt"}], "}"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"100", "+", 
                RowBox[{"Coefficient", "[", 
                 RowBox[{"KK", ",", 
                  RowBox[{"Log", "[", "qt", "]"}]}], "]"}], "+", "p"}], "]"}],
               "\[Equal]", "2"}], ")"}], ",", 
            RowBox[{"ss", "=", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "qt"}], "}"}]}]}], "]"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "ss"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ishalf", "[", 
   RowBox[{"A_", ",", "vertexdata_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"isp", "[", 
    RowBox[{"A", ",", "q"}], "]"}], "+", 
   RowBox[{"isp", "[", 
    RowBox[{"A", ",", "t"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{
  3.707306213298244*^9, {3.707306249500458*^9, 3.707306437341868*^9}, {
   3.707306523554337*^9, 3.707306535091905*^9}, {3.707306578561407*^9, 
   3.707306644512046*^9}, 3.707306745872303*^9, {3.707306777471723*^9, 
   3.707306802639751*^9}, {3.7073068632114897`*^9, 3.707306931207025*^9}, {
   3.7073070952770042`*^9, 3.7073071694602947`*^9}, {3.707307287267*^9, 
   3.707307289122504*^9}, {3.7073076414792137`*^9, 3.707307644733629*^9}, {
   3.7073078298036013`*^9, 3.7073078903004093`*^9}, {3.707308089597596*^9, 
   3.707308240212542*^9}, {3.707308296625297*^9, 3.70730830270149*^9}, {
   3.70730839954249*^9, 3.707308453451602*^9}, {3.707308504205215*^9, 
   3.7073085544247313`*^9}, {3.707310295013136*^9, 3.707310367706832*^9}, {
   3.707310441771953*^9, 3.707310443612998*^9}, {3.707310483571691*^9, 
   3.707310637046504*^9}, {3.707310683269332*^9, 3.7073107251543407`*^9}, {
   3.7073107573913107`*^9, 3.7073107629926243`*^9}, {3.7073108521000357`*^9, 
   3.707311081217444*^9}, {3.707311141350129*^9, 3.707311173307228*^9}, {
   3.707312156138666*^9, 3.7073121564684973`*^9}, {3.7073122184019747`*^9, 
   3.707312238883506*^9}, {3.7073127056046257`*^9, 3.707312710500265*^9}, {
   3.707312744552607*^9, 3.707312770690226*^9}, {3.707313779351108*^9, 
   3.707313790166456*^9}, {3.70731398703542*^9, 3.707313987375558*^9}, {
   3.707314110861005*^9, 3.7073141455048113`*^9}, {3.707314314954144*^9, 
   3.707314322956485*^9}, {3.7073143956044283`*^9, 3.707314447563839*^9}, {
   3.707314585750559*^9, 3.707314589937648*^9}, {3.7073146263181677`*^9, 
   3.70731468408729*^9}, {3.707314746297935*^9, 3.707314766968751*^9}, {
   3.707314808785981*^9, 3.7073148302061462`*^9}, {3.70731488471144*^9, 
   3.7073148852958937`*^9}, {3.707314925894346*^9, 3.7073149324307537`*^9}, {
   3.7073151656294413`*^9, 3.707315172712089*^9}, {3.707315234643508*^9, 
   3.707315359908255*^9}, {3.7073155039801407`*^9, 3.707315524436604*^9}, {
   3.707315714163952*^9, 3.7073157157406483`*^9}, {3.7073159285702887`*^9, 
   3.707315982858629*^9}, {3.707316058744215*^9, 3.7073161275522003`*^9}, {
   3.707316199376912*^9, 3.707316225325522*^9}, {3.7073163055534067`*^9, 
   3.707316345433324*^9}, {3.707316699832089*^9, 3.707316704114626*^9}, {
   3.707317626780654*^9, 3.707317782956884*^9}, {3.707362683113736*^9, 
   3.707362683548629*^9}, {3.707362733295567*^9, 3.707362735287827*^9}, {
   3.707362874538888*^9, 3.707362902014106*^9}, 3.707363010764176*^9, {
   3.707363086834382*^9, 3.7073630916285057`*^9}, {3.707363155058628*^9, 
   3.707363373034506*^9}, {3.707363450533883*^9, 3.707363489148518*^9}, {
   3.7073635910107937`*^9, 3.707363592452305*^9}, {3.7073636350781384`*^9, 
   3.707363635294836*^9}, {3.707363692771989*^9, 3.7073636991302853`*^9}, {
   3.7073637419009237`*^9, 3.707363742102449*^9}, {3.707363829347081*^9, 
   3.70736386121706*^9}, {3.707363932349744*^9, 3.707363965575302*^9}, 
   3.707364179485496*^9, {3.707364344069092*^9, 3.70736438983221*^9}, {
   3.707364528587763*^9, 3.707364529003874*^9}, {3.707364770871554*^9, 
   3.7073647811945457`*^9}, {3.70736482376586*^9, 3.7073650377092247`*^9}, {
   3.707365133788755*^9, 3.7073651371765213`*^9}, {3.707365326722726*^9, 
   3.707365340088283*^9}, {3.707365372961685*^9, 3.707365373399374*^9}, {
   3.70736544883253*^9, 3.707365449253428*^9}, {3.707365546919788*^9, 
   3.707365562800413*^9}, {3.7073657589932632`*^9, 3.7073657749323387`*^9}, {
   3.707365813481676*^9, 3.7073658188062963`*^9}, {3.707365989527437*^9, 
   3.7073659900096483`*^9}, {3.707366043738542*^9, 3.7073660907394657`*^9}, {
   3.707366222166429*^9, 3.707366236028821*^9}, {3.707366351588626*^9, 
   3.707366353121681*^9}, {3.7073663956898317`*^9, 3.707366439400322*^9}, {
   3.707366561047357*^9, 3.707366562220821*^9}, {3.707366682021483*^9, 
   3.7073667840594263`*^9}, {3.707367665475253*^9, 3.70736766599862*^9}, {
   3.7073677846468573`*^9, 3.707367826024519*^9}, {3.707367901186606*^9, 
   3.7073679068839827`*^9}, 3.707368184870154*^9, {3.707368369091382*^9, 
   3.707368421982689*^9}, {3.7073688044532557`*^9, 3.707368816695682*^9}, {
   3.707368872853642*^9, 3.707368907056479*^9}, {3.707369024179419*^9, 
   3.7073691131676893`*^9}, {3.7073691447921963`*^9, 
   3.7073691450581627`*^9}, {3.707369194291473*^9, 3.707369210592719*^9}, {
   3.7073692880792522`*^9, 3.7073692922443047`*^9}, {3.707369343431637*^9, 
   3.707369348029853*^9}, {3.707369457045464*^9, 3.70736945728262*^9}, {
   3.707369496860923*^9, 3.707369499348496*^9}, {3.7073695458825274`*^9, 
   3.70736956002813*^9}, {3.707369600378703*^9, 3.707369600685749*^9}, {
   3.7073702099222927`*^9, 3.7073702101933403`*^9}, {3.707370733851005*^9, 
   3.707370735573574*^9}, {3.7073708419556627`*^9, 3.707370904021884*^9}, {
   3.707370996771209*^9, 3.707371002095072*^9}, {3.707371038494904*^9, 
   3.707371038849451*^9}, {3.707371156274548*^9, 3.7073711567519617`*^9}, {
   3.7073712699624043`*^9, 3.707371273184165*^9}, 3.7073716212762938`*^9, {
   3.707371902342201*^9, 3.707372075699175*^9}, {3.707372452689171*^9, 
   3.707372458418481*^9}, {3.707372719681072*^9, 3.7073727379723587`*^9}, {
   3.70737277916201*^9, 3.7073728049587193`*^9}, {3.707372843173457*^9, 
   3.707372843361195*^9}, {3.707372883224523*^9, 3.707372975139371*^9}, {
   3.707373048844816*^9, 3.707373079454689*^9}, {3.707373199251851*^9, 
   3.707373200167273*^9}, {3.707373261709044*^9, 3.70737327682625*^9}, {
   3.7073733289862013`*^9, 3.707373343158436*^9}, {3.707373453588479*^9, 
   3.70737346210135*^9}, 3.707373513246023*^9, {3.707373627341392*^9, 
   3.707373692093294*^9}, {3.707373732295154*^9, 3.707373732822289*^9}, {
   3.707373838553357*^9, 3.707373878175599*^9}, {3.707373908375198*^9, 
   3.707373922097109*^9}, {3.707375328754952*^9, 3.707375331097527*^9}, {
   3.70737539126595*^9, 3.7073754147838593`*^9}, {3.707378359904346*^9, 
   3.707378360131712*^9}, {3.70737840418683*^9, 3.70737840797521*^9}, {
   3.7073784414843903`*^9, 3.707378462307729*^9}, 3.7073785740044727`*^9, {
   3.707378942576384*^9, 3.707378945110466*^9}, {3.707380032834609*^9, 
   3.7073800704612093`*^9}, {3.7073801103212137`*^9, 3.70738011080503*^9}, 
   3.707380990345397*^9, {3.707381272358943*^9, 3.7073813186507673`*^9}, {
   3.7073813545071087`*^9, 3.707381378070218*^9}, {3.707381639207164*^9, 
   3.70738166126158*^9}, {3.7073817050172453`*^9, 3.707381705226668*^9}, {
   3.7073818613415937`*^9, 3.7073818673934307`*^9}, {3.7073822377272873`*^9, 
   3.707382274622163*^9}, {3.707382672253998*^9, 3.707382681592798*^9}, {
   3.7073860151739817`*^9, 3.707386032033125*^9}, {3.707386096199431*^9, 
   3.7073861910666428`*^9}, {3.707386230055489*^9, 3.707386344080147*^9}, {
   3.7073866946949253`*^9, 3.7073867170254803`*^9}, {3.707387071210778*^9, 
   3.707387163966578*^9}, {3.7073884818677387`*^9, 3.707388498810738*^9}, {
   3.707388863854018*^9, 3.707388866173765*^9}, {3.707457861515802*^9, 
   3.70745787826193*^9}, {3.708168820091323*^9, 3.7081688226037903`*^9}, {
   3.7086936865461407`*^9, 3.708693695306087*^9}, {3.7087520791870623`*^9, 
   3.708752090794669*^9}, {3.709012796099255*^9, 3.7090128004337177`*^9}, {
   3.709012871481192*^9, 3.709012876627625*^9}, {3.709015872071269*^9, 
   3.709015876891693*^9}, {3.7090159505982943`*^9, 3.709015955069027*^9}, {
   3.710062977864276*^9, 3.71006298430832*^9}, {3.7100630882192698`*^9, 
   3.710063100807908*^9}, {3.710063163184111*^9, 3.710063178164021*^9}, {
   3.716390014710593*^9, 3.7163900230601482`*^9}, {3.716440588098572*^9, 
   3.716440640346365*^9}, {3.7164407862388277`*^9, 3.716440802324092*^9}, {
   3.717229418184236*^9, 3.717229420047146*^9}, {3.717833835706986*^9, 
   3.717833874206818*^9}, 3.717833929358869*^9, {3.722866117301558*^9, 
   3.722866136676241*^9}, {3.7230062851939163`*^9, 3.723006355776808*^9}, {
   3.725439567850051*^9, 3.7254396037488527`*^9}, {3.727788036913178*^9, 
   3.7277880534419203`*^9}, {3.7281340750972967`*^9, 3.728134075743265*^9}, {
   3.729480771080369*^9, 3.7294808769191933`*^9}, {3.738916266522232*^9, 
   3.738916276155794*^9}, {3.740111811307311*^9, 3.74011181653642*^9}, {
   3.740112653823497*^9, 3.740112719829184*^9}, {3.7401132233443813`*^9, 
   3.7401132357307377`*^9}, {3.7401156138488483`*^9, 3.740115632548748*^9}, {
   3.740116168362708*^9, 3.74011617523248*^9}, {3.740116917670319*^9, 
   3.740116919229576*^9}, {3.7401171021818666`*^9, 3.740117112785149*^9}, 
   3.740117353259419*^9, 3.740117558369542*^9, 3.740117667891856*^9, {
   3.740118077537024*^9, 3.74011808725989*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[111]:=",ExpressionUUID->"3831c647-3d57-4c49-83cd-b77412073478"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"signT", "[", 
    RowBox[{"express_", ",", "qt_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sign", ",", "ss", ",", "KK"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KK", "=", 
       RowBox[{"KKK", "[", "express", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ss", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sign", "=", 
       RowBox[{"valueequal", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"KK", ",", 
            RowBox[{"Log", "[", "qt", "]"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"T", "\[Rule]", "1"}], "}"}]}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"KK", ",", 
           RowBox[{"Log", "[", "qt", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"sign", "\[Equal]", "0"}], ",", 
        RowBox[{"ss", "=", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sign", "\[Equal]", "1"}], ",", 
          RowBox[{"ss", "=", "1"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ss", " ", 
       RowBox[{
        RowBox[{"signp", "[", 
         RowBox[{"KK", ",", "qt"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
  Background->RGBColor[0.87, 0.94, 1]]], "Input",
 CellChangeTimes->{{3.707386721624777*^9, 3.707386730713702*^9}, {
   3.70738717504033*^9, 3.707387198291133*^9}, 3.717229425470667*^9},
 CellLabel->
  "In[116]:=",ExpressionUUID->"5cc55a41-a17b-41d2-8828-25dd8c56f329"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"signtotal", "[", 
    RowBox[{"express_", ",", "qt_"}], "]"}],
   Background->RGBColor[0.87, 0.94, 1]], 
  StyleBox[":=",
   Background->RGBColor[0.87, 0.94, 1]], 
  RowBox[{
   StyleBox["Module",
    Background->RGBColor[0.87, 0.94, 1]], 
   StyleBox["[",
    Background->RGBColor[0.87, 0.94, 1]], 
   RowBox[{
    StyleBox[
     RowBox[{"{", 
      RowBox[{"sstotal", ",", "KK"}], "}"}],
     Background->RGBColor[0.87, 0.94, 1]], 
    StyleBox[",",
     Background->RGBColor[0.87, 0.94, 1]], 
    StyleBox["\[IndentingNewLine]",
     Background->RGBColor[0.87, 0.94, 1]], 
    RowBox[{
     StyleBox[
      RowBox[{"KK", "=", 
       RowBox[{"KKK", "[", "express", "]"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"sstotal", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"sstotal", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"signp", "[", 
           RowBox[{"express", ",", "qt"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"signT", "[", 
          RowBox[{"express", ",", "qt"}], "]"}], ",", 
         RowBox[{
          RowBox[{"signp", "[", 
           RowBox[{"express", ",", "qt"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"signp", "[", 
           RowBox[{"express", ",", "qt"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     RowBox[{
      StyleBox["If",
       Background->RGBColor[0.87, 0.94, 1]], 
      StyleBox["[",
       Background->RGBColor[0.87, 0.94, 1]], 
      RowBox[{
       RowBox[{
        StyleBox[
         RowBox[{"sstotal", "[", 
          RowBox[{"[", "1", "]"}], "]"}],
         Background->RGBColor[0.87, 0.94, 1]], 
        StyleBox["\[Equal]",
         Background->RGBColor[0.87, 0.94, 1]], "0"}], ",", 
       RowBox[{
        RowBox[{"sstotal", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", "0"}]}], 
      StyleBox["]",
       Background->RGBColor[0.87, 0.94, 1]]}], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["sstotal",
      Background->RGBColor[0.87, 0.94, 1]]}]}], 
   StyleBox["\[IndentingNewLine]",
    Background->RGBColor[0.87, 0.94, 1]], 
   StyleBox["]",
    Background->RGBColor[0.87, 0.94, 1]]}]}]], "Input",
 CellChangeTimes->{{3.707386734692244*^9, 3.707386744213107*^9}, {
  3.707387206098906*^9, 3.707387217505576*^9}, {3.707388601734227*^9, 
  3.707388616891171*^9}, {3.707465479196381*^9, 3.707465534248704*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"67ed5eb9-7b9a-4f45-9720-7a28b60d6566"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"varget", "[", 
    RowBox[{"express_", ",", "vertexdata_", ",", "qt_"}], "]"}],
   Background->RGBColor[0.87, 0.94, 1]], 
  StyleBox[":=",
   Background->RGBColor[0.87, 0.94, 1]], 
  RowBox[{
   StyleBox["Module",
    Background->RGBColor[0.87, 0.94, 1]], 
   StyleBox["[",
    Background->RGBColor[0.87, 0.94, 1]], 
   RowBox[{
    StyleBox[
     RowBox[{"{", 
      RowBox[{
      "a", ",", "coe", ",", "s", ",", "vv", ",", "var", ",", "i", ",", "out", 
       ",", "KK"}], "}"}],
     Background->RGBColor[0.87, 0.94, 1]], 
    StyleBox[",",
     Background->RGBColor[0.87, 0.94, 1]], 
    StyleBox["\[IndentingNewLine]",
     Background->RGBColor[0.87, 0.94, 1]], 
    RowBox[{
     StyleBox[
      RowBox[{"KK", "=", 
       RowBox[{"KKK", "[", "express", "]"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"a", "=", 
       RowBox[{"signtotal", "[", 
        RowBox[{"express", ",", "qt"}], "]"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"vv", "=", 
       RowBox[{"vvleft", "[", "vertexdata", "]"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"var", "=", 
       RowBox[{"{", "}"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"s", "=", "T"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{"s", "=", "1"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"s", "=", "0"}]}], "]"}]}], "]"}]}], "]"}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"coe", "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"KK", ",", 
         RowBox[{"Log", "[", "qt", "]"}]}], "]"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}],
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     RowBox[{
      StyleBox["If",
       Background->RGBColor[0.87, 0.94, 1]], 
      StyleBox["[",
       Background->RGBColor[0.87, 0.94, 1]], 
      RowBox[{
       RowBox[{
        RowBox[{"valueequal", "[", 
         RowBox[{"s", ",", "0"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"out", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"qt", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "p"}], ")"}]}]}], "}"}]}]}], 
      "]"}], ";", 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     RowBox[{
      StyleBox["For",
       Background->RGBColor[0.87, 0.94, 1]], 
      StyleBox["[",
       Background->RGBColor[0.87, 0.94, 1]], 
      RowBox[{
       StyleBox[
        RowBox[{"i", "=", "1"}],
        Background->RGBColor[0.87, 0.94, 1]], 
       StyleBox[",",
        Background->RGBColor[0.87, 0.94, 1]], 
       StyleBox[
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "vv", "]"}]}],
        Background->RGBColor[0.87, 0.94, 1]], 
       StyleBox[",",
        Background->RGBColor[0.87, 0.94, 1]], 
       StyleBox[
        RowBox[{"i", "++"}],
        Background->RGBColor[0.87, 0.94, 1]], 
       StyleBox[",",
        Background->RGBColor[0.87, 0.94, 1]], "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"valueequal", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"vv", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "s"], 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "+", "p"}], ")"}]}], 
               "-", "coe"}], "]"}], ",", "0"}], "]"}], "\[Equal]", "1"}], ",",
           "  ", 
          RowBox[{"var", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"var", ",", 
             RowBox[{"vv", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}],
        Background->RGBColor[0.87, 0.94, 1]]}], 
      StyleBox[" ",
       Background->RGBColor[0.87, 0.94, 1]], 
      StyleBox["]",
       Background->RGBColor[0.87, 0.94, 1]]}], 
     StyleBox[";",
      Background->RGBColor[0.87, 0.94, 1]], 
     StyleBox["\[IndentingNewLine]",
      Background->RGBColor[0.87, 0.94, 1]], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"valueequal", "[", 
         RowBox[{"s", ",", "0"}], "]"}], "\[Equal]", "1"}], ",", "out", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          StyleBox[
           RowBox[{"var", ",", 
            RowBox[{"qt", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "3", "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"var", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "s"], 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "+", "p"}], ")"}]}], 
              ")"}]}]}],
           Background->RGBColor[0.87, 0.94, 1]], 
          StyleBox["}",
           Background->RGBColor[0.87, 0.94, 1]]}], 
         StyleBox["//",
          Background->RGBColor[0.87, 0.94, 1]], 
         StyleBox["Flatten",
          Background->RGBColor[0.87, 0.94, 1]]}], 
        StyleBox[")",
         Background->RGBColor[0.87, 0.94, 1]]}]}], 
      StyleBox["]",
       Background->RGBColor[0.87, 0.94, 1]]}]}]}], 
   StyleBox["\[IndentingNewLine]",
    Background->RGBColor[0.87, 0.94, 1]], 
   StyleBox["]",
    Background->RGBColor[0.87, 0.94, 1]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"varget", "[", 
     RowBox[{"A", ",", "vertexdata", ",", "q"}], "]"}], 
    RowBox[{"varget", "[", 
     RowBox[{"A", ",", "vertexdata", ",", "q"}], "]"}]}], "*)"}]}]}], "Input",\

 CellChangeTimes->{{3.707386747414795*^9, 3.707386778777042*^9}, {
  3.707387222159883*^9, 3.707387237788802*^9}, {3.707387614761477*^9, 
  3.707387617705011*^9}, {3.7073887418585787`*^9, 3.707388743524434*^9}, {
  3.7074611626989307`*^9, 3.707461170593058*^9}, {3.7074615722279*^9, 
  3.7074615745403843`*^9}, {3.707461887076557*^9, 3.707461902964463*^9}, {
  3.707464647640492*^9, 3.707464654846621*^9}, {3.707464692338134*^9, 
  3.707464764116262*^9}, {3.707464828151848*^9, 3.7074648769125032`*^9}, {
  3.707464966407653*^9, 3.707465003468741*^9}, {3.707465121651245*^9, 
  3.707465122382764*^9}, {3.707465250448308*^9, 3.707465282202394*^9}, {
  3.707465317285363*^9, 3.707465351261354*^9}, {3.707465385632056*^9, 
  3.707465386120623*^9}, {3.707466053233184*^9, 3.70746605493402*^9}, {
  3.707466292273157*^9, 3.7074662924976597`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"903a3316-62da-4e99-8876-7d3346c3349b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Qleft", "[", 
   RowBox[{"express_", ",", "vertexdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "KK", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"express", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"varget", "[", 
             RowBox[{"express", ",", "vertexdata", ",", "q"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], 
           RowBox[{
            RowBox[{"varget", "[", 
             RowBox[{"express", ",", "vertexdata", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0", "^", "T"}], "\[Rule]", "0"}], "}"}]}], ")"}], "//", 
     "Simplify"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.707375434721347*^9, 3.707375513883397*^9}, {
   3.707387271557108*^9, 3.707387341277768*^9}, {3.707388809328747*^9, 
   3.707388809541728*^9}, 3.707458565169923*^9, {3.7074585977473803`*^9, 
   3.707458602319911*^9}, {3.7074611852571373`*^9, 3.707461194634652*^9}, {
   3.707465964983747*^9, 3.707465979284341*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"bc793853-d155-4a8c-a55a-96cf5c6429e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rry", "[", "a_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"arry", ",", "brry", ",", "N", ",", "NN", ",", "i", ",", "j"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arry", "=", "a"}], ";", "\[IndentingNewLine]", 
     RowBox[{"brry", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"N", "=", 
      RowBox[{"Length", "[", "arry", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "N"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"brry", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"brry", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"arry", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{
              RowBox[{"arry", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"arry", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"NN", "=", 
      RowBox[{"Length", "[", "brry", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "NN"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"brry", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"brry", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"brry", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "brry"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.7074598730761127`*^9, {3.708769424168408*^9, 3.708769580424518*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"dad58319-bfb4-4c62-93a7-c72d0b5fe1e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"infprod", "[", 
   RowBox[{"a_", ",", "vertexdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "ry", ",", "N", ",", "inf", ",", "ss", ",", "Qis", ",", "pvis",
       ",", "Tis", ",", "ssis", ",", "qt"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"ry", "=", 
      RowBox[{"rry", "[", "a", "]"}]}], ";", "\n", 
     RowBox[{"N", "=", 
      RowBox[{"Length", "[", "ry", "]"}]}], ";", "\n", 
     RowBox[{"inf", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "N"}], ",", 
       RowBox[{"i", "++"}], ",", "\n", 
       RowBox[{"inf", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"inf", ",", " ", "\n", 
          RowBox[{"{", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"ry", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\n", 
            RowBox[{"Qleft", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ry", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", "vertexdata"}], " ", 
             "]"}], ",", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"signtotal", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ry", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "q"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{
              RowBox[{"varget", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ry", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "vertexdata", ",", 
                "q"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", 
            RowBox[{
             RowBox[{"signtotal", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ry", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "q"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\n", 
            RowBox[{
             RowBox[{"signtotal", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ry", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "q"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\n", 
            RowBox[{
             RowBox[{"signtotal", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ry", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "q"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"signtotal", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ry", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{
              RowBox[{"varget", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ry", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "vertexdata", ",", 
                "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", 
            RowBox[{
             RowBox[{"signtotal", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ry", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\n", 
            RowBox[{
             RowBox[{"signtotal", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ry", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", "\n", 
            RowBox[{
             RowBox[{"signtotal", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ry", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], " ", "\n", " ", "}"}]}], "   ",
          "]"}]}]}], "\n", "]"}], ";", "\n", "inf"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.707466032945973*^9, 3.707466032947702*^9}, 
   3.70746634262396*^9, {3.7172293527274237`*^9, 3.717229356965127*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"2e61f99f-240a-4e84-9c2a-fcce1237a301"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sT", "[", 
   RowBox[{"a_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"a", "\[Equal]", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"TTT", "[", "v", "]"}], ",", "v"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.707468573557687*^9, 3.707468581408*^9}, {
   3.707469580878628*^9, 3.707469630878923*^9}, 3.708249646000136*^9},
 CellLabel->
  "In[122]:=",ExpressionUUID->"95975546-00fd-41ca-a4c3-a942bafa4d33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZZdata", "[", 
   RowBox[{"array_", ",", "vertexdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "inf", ",", "v1v2", ",", "reinf", ",", "ishalf", ",", "i", ",", "NNN"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"inf", "=", 
      RowBox[{"infprod", "[", 
       RowBox[{"array", ",", "vertexdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NNN", "=", 
      RowBox[{"Length", "[", "inf", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1v2", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "inf", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Transpose", "[", "inf", "]"}], "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reinf", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", "NNN"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "NNN"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"valueequal", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v1v2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{
              RowBox[{"v1v2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}], "\[Equal]",
           "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"valueequal", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v1v2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}], "\[Equal]", 
            "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", "half"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", "1"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", 
              RowBox[{"sT", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"inf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"inf", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "10", "]"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ")"}]}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"inf", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "6", "]"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ")"}]}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "7", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"inf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"valueequal", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"v1v2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], 
              "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"reinf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", "half"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"reinf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"-", "1"}]}], ")"}], "&&", 
              StyleBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"reinf", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "=", 
                 RowBox[{"sT", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"inf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "8", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"inf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], "]"}]}], ")"}],
               Background->RGBColor[0.88, 1, 0.88]], 
              StyleBox["&&",
               Background->RGBColor[0.88, 1, 0.88]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"reinf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"reinf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"inf", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "10", "]"}], "]"}], "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"inf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "9", "]"}], "]"}], ")"}]}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"reinf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "6", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"inf", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "6", "]"}], "]"}], "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"inf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "5", "]"}], "]"}], ")"}]}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"reinf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "7", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"valueequal", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"v1v2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], 
               RowBox[{
                RowBox[{"v1v2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}], 
            "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", "nab"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"sT", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"inf", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "8", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "]"}]}], ")"}], "&&", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", 
              RowBox[{"sT", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"inf", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"inf", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "6", "]"}], "]"}], "^", 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{
                    RowBox[{"inf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], ")"}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"inf", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "10", "]"}], "]"}], "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    FractionBox["1", "2"]}], 
                   RowBox[{
                    RowBox[{"inf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "9", "]"}], "]"}]}], ")"}]}], ")"}]}]}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"inf", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "10", "]"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ")"}]}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"inf", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "6", "]"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"inf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ")"}]}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"reinf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "7", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"inf", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "reinf"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.707471547467708*^9, 3.707471787621627*^9, {3.70747191472366*^9, 
   3.707471953324424*^9}, 3.70747214540613*^9, {3.707472220613689*^9, 
   3.707472233424992*^9}, {3.707472284308666*^9, 3.707472291163789*^9}, {
   3.7074728964245253`*^9, 3.707472901265772*^9}, {3.707472953418466*^9, 
   3.707472983850643*^9}, {3.707473029376796*^9, 3.7074730333196287`*^9}, 
   3.7074730657814817`*^9, 3.707474579475277*^9, {3.707474888310459*^9, 
   3.707474900116214*^9}, {3.707475104911882*^9, 3.707475107949149*^9}, 
   3.707475514683707*^9, 3.7087737795339193`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"5f381b8e-d3a9-49f5-8e30-f0e98f66bc92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"whichii", "[", 
    RowBox[{"a_", ",", "vertexdata_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"vvle", ",", "i", ",", 
       RowBox[{"ii", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vvle", "=", 
       RowBox[{"vvleft", "[", "vertexdata", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "vvle", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"valueequal", "[", 
            RowBox[{"a", ",", 
             RowBox[{"vvle", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{"ii", "=", "i"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "ii"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"whichRR", "[", 
   RowBox[{"arry_", ",", "vertexdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"inf", ",", "n", ",", "A", ",", "i"}], " ", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"inf", "=", 
      RowBox[{"infprod", "[", 
       RowBox[{"arry", ",", "vertexdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "inf", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "n"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"inf", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"inf", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"whichii", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"inf", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "vertexdata"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", 
         RowBox[{"whichii", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"inf", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "7", "]"}], "]"}], ",", "vertexdata"}], "]"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "A"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"34cc11a2-1053-4907-9157-d4825acf622e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NabNhalf", "[", 
   RowBox[{"array_", ",", "vertexdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "n", ",", "RR", ",", "i", ",", "def", ",", "Mef"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"ZZdata", "[", 
       RowBox[{"array", ",", "vertexdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RR", "=", 
      RowBox[{"whichRR", "[", 
       RowBox[{"array", ",", "vertexdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"def", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Mef", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"valueequal", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "nab"}], "]"}], "\[Equal]", 
          "1"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"def", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"def", ",", 
              SuperscriptBox[
               RowBox[{"NNN\[Alpha]\[Beta]", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], 
                  RowBox[{"(*", 
                   RowBox[{",", 
                    RowBox[{
                    RowBox[{"RR", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"RR", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "  ", "*)"}], "}"}], 
                 ",", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "6", "]"}], "]"}]}], "  ", "}"}]}], "    ", 
                "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "7", "]"}], "]"}], ")"}]]}], " ", "]"}]}], 
           ")"}], "&&", "\[IndentingNewLine]", 
          RowBox[{"(", " ", 
           RowBox[{"Mef", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Mef", ",", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"MM", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}], ",", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], 
                   RowBox[{"-", "1"}]], ",", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "6", "]"}], "]"}], 
                   RowBox[{"-", "1"}]]}], " ", "]"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "7", "]"}], "]"}], ")"}]]}], " ", "]"}]}], 
           "   ", ")"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"valueequal", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "half"}], "]"}], 
            "\[Equal]", "1"}], ",", "   ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"def", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"def", ",", 
                SuperscriptBox[
                 RowBox[{"NNNhalf", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"(*", "{", "*)"}], 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RR", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"RR", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "*)"}], 
                   RowBox[{"(*", 
                    RowBox[{"}", ","}], "*)"}], 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "6", "]"}], "]"}]}], "     ", "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "7", "]"}], "]"}], ")"}]]}], "  ", "]"}]}], 
             ")"}], "&&", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"Mef", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"Mef", ",", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"MM", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], 
                    SuperscriptBox["q", 
                    RowBox[{"-", 
                    FractionBox["1", "2"]}]], 
                    SuperscriptBox["t", 
                    FractionBox["1", "2"]]}], ",", 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], 
                    RowBox[{"-", "1"}]], ",", 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "6", "]"}], "]"}], 
                    RowBox[{"-", "1"}]]}], " ", "]"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "7", "]"}], "]"}], ")"}]]}], " ", "]"}]}], 
             " ", ")"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{"def", ",", "Mef"}], " ", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.70747350050778*^9, 3.7074740415931053`*^9}, {
   3.7074740813485413`*^9, 3.707474086691659*^9}, {3.70747579465444*^9, 
   3.707475796777072*^9}, {3.7074758570407047`*^9, 3.707475867003915*^9}, {
   3.708171042760948*^9, 3.708171059713732*^9}, {3.708171127266631*^9, 
   3.708171210946083*^9}, 3.708171286341608*^9, {3.7081713438518744`*^9, 
   3.708171348765216*^9}, {3.708171543111267*^9, 3.708171571396241*^9}, {
   3.708171649131114*^9, 3.708171652160069*^9}, {3.708171802763441*^9, 
   3.7081718260099897`*^9}, {3.708176017727165*^9, 3.7081760684307528`*^9}, {
   3.708176130316266*^9, 3.70817613361199*^9}, {3.708603475248906*^9, 
   3.708603506668249*^9}, 3.708603619595915*^9, {3.7086037664455957`*^9, 
   3.7086037782725*^9}, 3.7086040705356617`*^9, {3.708660406305706*^9, 
   3.7086605442745667`*^9}, {3.7086635742264957`*^9, 3.708663671564138*^9}, {
   3.708663717109247*^9, 3.708663729314683*^9}, {3.708663762868846*^9, 
   3.708663798290258*^9}, {3.708663830814293*^9, 3.70866384980547*^9}, {
   3.7086639261478*^9, 3.7086639298980217`*^9}, {3.708665409568611*^9, 
   3.708665423647265*^9}, {3.7086654731751547`*^9, 3.7086655005370207`*^9}, {
   3.7086658622743063`*^9, 3.708665865418161*^9}, 3.708667266485568*^9},
 CellLabel->
  "In[126]:=",ExpressionUUID->"bf176596-b39c-42d9-a151-ec21e9bf747e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"NabNhalf", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Qm1"}], " ", 
        SuperscriptBox["t", 
         RowBox[{"-", "p"}]]}], ",", 
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{"-", "p"}]], " ", 
        SuperscriptBox["t", 
         RowBox[{"-", "\[Nu]1"}]]}], ",", "1"}], "}"}], "}"}], ",", 
    "vertexdata"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.708606980185973*^9, 3.708607002369114*^9}, 
   3.708607059022393*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"62b26c92-7bdf-4aff-891e-3a138f58b24b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHalf", "[", 
   RowBox[{"ss_", ",", "v_", ",", "Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rs", "=", "ss"}], ",", 
      RowBox[{"rv", "=", "v"}], ",", "R"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v", "\[Equal]", "0"}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{"v", "\[Equal]", 
           RowBox[{"TTT", "[", "0", "]"}]}], ")"}]}], ",", 
        RowBox[{"rs", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v", "\[Equal]", 
         RowBox[{"TTT", "[", "0", "]"}]}], ",", 
        RowBox[{"rv", "=", "0"}]}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"RNHalf", "[", 
       RowBox[{"rs", ",", "rv", ",", "Q", ",", "t", ",", "q"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"valueequal", "[", 
           RowBox[{"v", ",", "0"}], "]"}], "\[Equal]", "1"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"valueequal", "[", 
           RowBox[{"v", ",", 
            RowBox[{"TTT", "[", "0", "]"}]}], "]"}], "==", "1"}], ")"}]}], 
       ",", "1", ",", "R"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7086076192877607`*^9, 3.708607800813251*^9}, {
   3.708607837856401*^9, 3.708607898217916*^9}, {3.7086079539311037`*^9, 
   3.708607966075058*^9}, {3.7086089903454723`*^9, 3.708608990890473*^9}, {
   3.708609031515579*^9, 3.70860903191326*^9}, 3.708653602677519*^9, {
   3.708653917962141*^9, 3.7086540128218813`*^9}, {3.708654185215226*^9, 
   3.7086542165788517`*^9}, {3.708654280197379*^9, 3.708654325990324*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"79297947-f24f-402e-b926-3b69b94abbd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Simphalf", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "/.", 
     RowBox[{"{", 
      RowBox[{"NNNhalf", "\[Rule]", "RHalf"}], "}"}]}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{"RNHalf", "\[Rule]", "NNNhalf"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simpnab", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "/.", 
     RowBox[{"{", 
      RowBox[{"NNN\[Alpha]\[Beta]", "\[Rule]", "RNab"}], "}"}]}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{"RNNab", "\[Rule]", "NNN\[Alpha]\[Beta]"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.708607575718154*^9, 3.708607582143652*^9}, {
  3.7086083080270767`*^9, 3.708608419700309*^9}, {3.7401189690901737`*^9, 
  3.740118969720684*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"956683b4-8790-452e-b45e-ab9dc754a153"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RNab", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "Q_", ",", 
     RowBox[{"{", 
      RowBox[{"t_", ",", "q_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"v11", ",", "v22", ",", " ", "R", ",", "RR"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"v11", "=", 
        RowBox[{"(", 
         RowBox[{"v1", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TTT", "[", "0", "]"}], "\[Rule]", "0"}], "}"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v22", "=", 
        RowBox[{"(", 
         RowBox[{"v2", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TTT", "[", "0", "]"}], "\[Rule]", "0"}], "}"}]}], 
         ")"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v11", "=", "v1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v22", "=", "v2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"R", "=", 
       RowBox[{"RNNab", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v11", ",", "v22"}], "}"}], ",", "Q", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "q"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RR", "=", "R"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"valueequal", "[", 
            RowBox[{"v11", ",", "0"}], "]"}], "\[Equal]", "1"}], ")"}], "&&", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"valueequal", "[", 
            RowBox[{"v22", ",", "0"}], "]"}], "==", "1"}], ")"}]}], ",", 
        RowBox[{"RR", "=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"valueequal", "[", 
              RowBox[{"v11", ",", "0"}], "]"}], "\[Equal]", "1"}], ")"}], " ",
            "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"valueequal", "[", 
              RowBox[{"v22", ",", "0"}], "]"}], "\[NotEqual]", "1"}], ")"}]}],
           ",", " ", 
          RowBox[{"RR", "=", 
           RowBox[{"NNNhalf", "[", 
            RowBox[{"1", ",", "v22", ",", 
             RowBox[{"Q", " ", 
              SuperscriptBox["q", 
               RowBox[{"-", 
                FractionBox["1", "2"]}]], " ", 
              SuperscriptBox["t", 
               FractionBox["1", "2"]]}], ",", " ", "t", ",", "q"}], "]"}]}], 
          " ", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"valueequal", "[", 
                RowBox[{"v22", ",", "0"}], "]"}], "\[Equal]", "1"}], ")"}], 
             " ", "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"valueequal", "[", 
                RowBox[{"v11", ",", "0"}], "]"}], "\[NotEqual]", "1"}], 
              ")"}]}], ",", " ", 
            RowBox[{"RR", "=", 
             RowBox[{"NNNhalf", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"(*", 
                RowBox[{"TTT", "[", "v11", "]"}], "*)"}], "v11", ",", 
               RowBox[{"Q", " ", 
                SuperscriptBox["q", 
                 RowBox[{"-", 
                  FractionBox["1", "2"]}]], " ", 
                SuperscriptBox["t", 
                 FractionBox["1", "2"]]}], ",", "t", ",", "q"}], "]"}]}]}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RR", "//", "PowerExpand"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.708654668678072*^9, 3.708654683422316*^9}, {
   3.708654744743928*^9, 3.7086547948372107`*^9}, {3.708655599005941*^9, 
   3.708655606108405*^9}, {3.708655657612735*^9, 3.7086559032856503`*^9}, {
   3.708655953066844*^9, 3.70865596142448*^9}, {3.708656484250064*^9, 
   3.708656583349992*^9}, {3.7086568213371468`*^9, 3.708656822188491*^9}, {
   3.708656920366558*^9, 3.708656926052052*^9}, {3.708657446975775*^9, 
   3.708657480618763*^9}, {3.7086576098113823`*^9, 3.7086576294331408`*^9}, {
   3.7086578373894*^9, 3.7086578447169857`*^9}, {3.708657874890009*^9, 
   3.7086579212963047`*^9}, {3.708658691951899*^9, 3.7086586989681063`*^9}, {
   3.708658764582169*^9, 3.708658768438184*^9}, {3.7086645716641817`*^9, 
   3.7086646013217278`*^9}, {3.708664734352345*^9, 3.708664737092288*^9}, {
   3.708664934119693*^9, 3.708664937313735*^9}, 3.708666236777877*^9, {
   3.708666624267798*^9, 3.7086666448160667`*^9}, {3.708666730863112*^9, 
   3.708666752700059*^9}, {3.708666792160039*^9, 3.708666808866242*^9}, {
   3.7086668623087254`*^9, 3.708666904894684*^9}, {3.708666994025182*^9, 
   3.7086670081720324`*^9}, {3.7086670533831778`*^9, 
   3.7086670613847237`*^9}, {3.708667451836075*^9, 3.708667455211479*^9}, {
   3.782911641964418*^9, 
   3.782911645599207*^9}},ExpressionUUID->"d06c6859-99bd-44dd-b2a4-\
a8bd2d374201"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deRT", "[", "a_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "a"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.717124942726789*^9, 3.7171250161959887`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"4ecfa6ff-8969-4792-906e-c7dc7d655850"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TTT", "[", "a_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"aa", "=", "a"}], ",", "R"}], " ", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"RT", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"valueequal", "[", 
         RowBox[{"a", ",", "0"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"R", "=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"valueequal", "[", 
           RowBox[{"a", ",", 
            RowBox[{"RT", "[", " ", 
             RowBox[{"a", "/.", 
              RowBox[{"{", 
               RowBox[{"RT", "\[Rule]", "deRT"}], "}"}]}], "  ", "]"}]}], 
           "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"R", "=", "a"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "R"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.717124570317053*^9, 3.717124643913753*^9}, {
  3.717124678609706*^9, 3.717124702978607*^9}, {3.7171249841897707`*^9, 
  3.7171250193043137`*^9}, {3.717125067627522*^9, 3.717125081457635*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"fd434012-b253-4bc4-a663-9859bb82aecd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimpRT", "[", "a_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"a", "/.", 
    RowBox[{"{", 
     RowBox[{"RT", "\[Rule]", "TTT"}], "}"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.708668192100479*^9, 3.708668228993725*^9}, {
  3.708668302237208*^9, 3.708668303096528*^9}, {3.70870017607168*^9, 
  3.708700183111228*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"261b02a6-7bba-4952-b7b5-46d042af4731"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bM", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Q", " ", 
         SuperscriptBox["q", "i"], " ", 
         SuperscriptBox["t", 
          RowBox[{"j", "-", "1"}]]}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", "\[Rule]", " ", 
         RowBox[{
          FractionBox["1", "2"], "-", "p"}]}], ",", 
        RowBox[{"j", "\[Rule]", 
         RowBox[{
          FractionBox["1", "2"], "-", "p"}]}]}], "}"}]}], ")"}], ",", " ", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708665659186859*^9, 3.708665723612351*^9}, {
   3.708665807194998*^9, 3.708665807680902*^9}, {3.708692301960143*^9, 
   3.708692339020875*^9}, {3.7086924964020433`*^9, 3.708692538064433*^9}, {
   3.70869257183188*^9, 3.708692579797826*^9}, {3.708700230030706*^9, 
   3.7087002464188147`*^9}, {3.7087003024156313`*^9, 3.7087003844874907`*^9}, 
   3.708700495838497*^9, 3.70870059226038*^9, 3.708700766475565*^9, 
   3.717229502354566*^9, 3.740110848375231*^9},
 CellLabel->
  "In[135]:=",ExpressionUUID->"816a5e5b-1ddd-49a1-9cd3-92ce555c3019"],

Cell[BoxData[
 RowBox[{
  RowBox[{"backM", "[", "a_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"a", "/.", 
    RowBox[{"{", 
     RowBox[{"MM", "\[Rule]", "bM"}], "}"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.70869232064717*^9, 3.708692376651515*^9}, 
   3.717229506042698*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"9c810013-5640-4f15-9499-96a9db31e0e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Deleteone", "[", "a_", "]"}], ":=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{"a", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708669307399014*^9, 3.708669337094432*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"41e09532-2726-4fe3-a6e5-7f87cb4a5e97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"brT", "[", "a_", "]"}], ":=", "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bRT", "[", "a_", "]"}], ":=", 
  RowBox[{"a", "/.", 
   RowBox[{"{", 
    RowBox[{"RT", "\[Rule]", "brT"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.708769839297102*^9, 3.7087698772626333`*^9}, {
  3.708769911507032*^9, 3.708769913296104*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"6bdadd22-70f5-443a-a6f7-a7382f29d4d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FF", "[", 
   RowBox[{
   "Q_", ",", "q_", ",", "qv_", ",", "qTv_", ",", "t_", ",", "tv_", ",", 
    "tTv_"}], "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Q", " ", 
          SuperscriptBox["q", 
           RowBox[{
            SuperscriptBox["qv", "qTv"], "+", "p"}]], 
          SuperscriptBox["t", 
           RowBox[{
            SuperscriptBox["tv", "tTv"], "+", "p"}]]}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ")"}], "//", 
     "PowerExpand"}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708770271544718*^9, 3.7087703340259733`*^9}, {
  3.708770407389539*^9, 3.708770432728889*^9}, {3.708770482489962*^9, 
  3.7087706333704863`*^9}, {3.7087707007211514`*^9, 3.708770713302712*^9}, {
  3.7087717303952627`*^9, 3.708771767502082*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"19ea6730-31e6-4a27-a153-9d793f2b1853"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bhalf", "[", 
   RowBox[{"ss_", ",", "v_", ",", "Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"aa", ",", 
      RowBox[{"ssv", "=", "1"}], ",", "bv", ",", "v1", ",", "v1T", ",", "v2", 
      ",", "v2T"}], " ", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bv", "=", 
      RowBox[{"v", "//", "bRT"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"valueequal", "[", 
         RowBox[{"bv", ",", "v"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"ssv", "=", "1"}], ",", 
       RowBox[{"ssv", "=", "T"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ss", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v1", "=", "bv"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"v1T", "=", "ssv"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"v2", "=", "0"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"v2T", "=", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ss", "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"v2", "=", "bv"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"v2T", "=", "ssv"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"v1", "=", "0"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"v1T", "=", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Q", ",", "q", ",", "v1", ",", "v1T", ",", "t", ",", "v2", ",", "v2T"}],
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.708769648467712*^9, 3.708769706527968*^9}, {
  3.708769957453875*^9, 3.708770256159471*^9}, {3.708770760284585*^9, 
  3.708770937482553*^9}, {3.7087709799851913`*^9, 3.708771051378047*^9}, {
  3.7087710866840687`*^9, 3.7087710900165577`*^9}, {3.708771133560362*^9, 
  3.708771179057321*^9}, {3.70877137376728*^9, 3.708771406682835*^9}, {
  3.708771446301488*^9, 3.708771461837511*^9}, {3.708771584253664*^9, 
  3.708771595950584*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"e860c54f-8caa-413a-a24f-48b6488589ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"backHalf", "[", "a_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "aa", "  ", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aa", "=", 
       RowBox[{"a", "/.", 
        RowBox[{"{", 
         RowBox[{"NNNhalf", "\[Rule]", "Bhalf"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FF", "[", " ", 
       RowBox[{
        RowBox[{"aa", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"aa", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"aa", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"aa", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"aa", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", 
        RowBox[{"aa", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", 
        RowBox[{"aa", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], "  ", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.70877146577719*^9, 3.7087715643107023`*^9}, {
  3.7087716051897287`*^9, 3.7087716807186813`*^9}, {3.708771910697604*^9, 
  3.708771939625643*^9}, {3.708772117806758*^9, 3.70877214943441*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"89002346-3eba-43e0-9f5d-91ccaacbe04d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"arrayToNN", "[", 
    RowBox[{"array_", ",", "list_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "arr", ",", "num", ",", "ii", ",", "sub", ",", "subb", ",", 
       "vertexdata"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"arr", "=", "array"}], ";", "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertexdata", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "\[Nu]2", ",", "\[Beta]2", ",", 
           "\[Alpha]", ",", "t", ",", "q", ",", "h2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Alpha]1", ",", "\[Nu]1", ",", "0", ",", "q", ",", "t", 
           ",", "h1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]3", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]4", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]5", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]6", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]7", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]8", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]10", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]11", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]12", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "\[Beta]", ",", "\[Nu]9", ",", "0", ",", "q", ",", "t", 
           ",", "h3"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["sub",
        Background->RGBColor[1, 0.85, 0.85]], 
       StyleBox["=",
        Background->RGBColor[1, 0.85, 0.85]], 
       RowBox[{"Join", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", " ", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<\[Nu]\>\"", "<>", 
             RowBox[{"ToString", "@", "ii"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "num"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"subb", 
       StyleBox["=",
        Background->RGBColor[1, 0.85, 0.85]], 
       RowBox[{"Join", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<\[Nu]\>\"", "<>", 
             RowBox[{"ToString", "@", "ii"}]}], "]"}], "\[Rule]", 
           RowBox[{"list", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "num"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"NabNhalf", "[", 
            RowBox[{
             RowBox[{"arr", "/.", "sub"}], ",", "vertexdata"}], "]"}], "//", 
           "Simphalf"}], "//", "Deleteone"}], "//", "PRODUCT"}], ")"}], "/.", 
       "subb"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7160128463365593`*^9, 3.7160129125715303`*^9}, {
   3.716012962127026*^9, 3.716012975680498*^9}, {3.716013014084791*^9, 
   3.716013014505446*^9}, 3.716013173809286*^9, 3.716013267160254*^9, {
   3.716013313766344*^9, 3.716013363451477*^9}, {3.7160134168801928`*^9, 
   3.71601360691003*^9}, {3.716013656276931*^9, 3.71601380589012*^9}, {
   3.716013924048271*^9, 3.716013930085308*^9}, {3.7160140376876087`*^9, 
   3.716014068821349*^9}, 3.717229484929656*^9, 3.7305919269762583`*^9, {
   3.7401152308577013`*^9, 3.740115325605706*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"f828e5c3-fab7-46eb-a56e-4c24c44ebd4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delMM0", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"valueequal", "[", 
      RowBox[{"0", ",", "Q"}], "]"}], "\[Equal]", "1"}], ",", "1", ",", 
    RowBox[{"MM", "[", 
     RowBox[{"Q", ",", "t", ",", "q"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimpMM", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"{", 
    RowBox[{"MM", "\[Rule]", "delMM0"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7282153581201077`*^9, 3.7282154912854*^9}, 
   3.730591911756168*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"99c6ae48-de3c-4634-af3d-121a56568263"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeroNNNhalf", "[", 
   RowBox[{"nn_", ",", "v_", ",", "Q_", ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"If", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"valueequal", "[", 
      RowBox[{"Q", ",", "0"}], "]"}], "\[Equal]", "1"}], ",", "1", ",", " ", 
    RowBox[{"NNNhalf", "[", 
     RowBox[{"nn", ",", "v", ",", "Q", ",", "a", ",", "b"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroNNN\[Alpha]\[Beta]", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_"}], "}"}], ",", "Q_", ",", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"If", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"valueequal", "[", 
      RowBox[{"Q", ",", "0"}], "]"}], "\[Equal]", "1"}], ",", "1", ",", 
    RowBox[{"NNN\[Alpha]\[Beta]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}], ",", "Q", ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.739782430202367*^9, 3.7397825697386227`*^9}, {
  3.7397826630191603`*^9, 3.739782760376602*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"5433df2e-5b7a-4bd4-9bd4-c82be092b780"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["zeroshur", 
    RowBox[{"u_", ",", "v_"}]], "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"valueequal", "[", 
        RowBox[{"u", ",", "0"}], "]"}], "\[Equal]", "1"}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"valueequal", "[", 
         RowBox[{"v", ",", "0"}], "]"}], "\[Equal]", "1"}], ")"}], ")"}]}], 
    ",", "1", ",", 
    RowBox[{
     SubscriptBox["s", 
      RowBox[{"u", ",", "v"}]], "[", "x", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simpshur", "[", "a_", "]"}], ":=", 
  RowBox[{"a", "/.", 
   RowBox[{"{", 
    RowBox[{"s", "\[Rule]", "zeroshur"}], " ", "}"}]}]}]}], "Input",
 CellLabel->
  "In[148]:=",ExpressionUUID->"fdaf58c2-097d-4bc0-abf3-d57584f08171"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"SimpAll", "[", "a_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"a", "//", "SimpRT"}], "//", "Simpnab"}], "//", 
             "Simphalf"}], "//", "SimpMM"}], "//", "PowerExpand"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["Z", "0"], "[", 
           RowBox[{"q", ",", "t"}], "]"}], "\[Rule]", "1"}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["Z", "0"], "[", 
           RowBox[{"t", ",", "q"}], "]"}], "\[Rule]", "1"}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["Z", 
            SuperscriptBox["0", "T"]], "[", 
           RowBox[{"t", ",", "q"}], "]"}], "\[Rule]", "1"}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["Z", 
            SuperscriptBox["0", "T"]], "[", 
           RowBox[{"q", ",", "t"}], "]"}], "\[Rule]", "1"}]}], "}"}]}], "/.", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NNNhalf", "\[Rule]", "zeroNNNhalf"}], ",", 
        RowBox[{"NNN\[Alpha]\[Beta]", "\[Rule]", "zeroNNN\[Alpha]\[Beta]"}]}],
        "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Z", "0"], "[", 
         RowBox[{"t", ",", "t"}], "]"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["Z", "0"], "[", 
         RowBox[{"t", ",", "t"}], "]"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["Z", 
          SuperscriptBox["0", "T"]], "[", 
         RowBox[{"t", ",", "t"}], "]"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["Z", 
          SuperscriptBox["0", "T"]], "[", 
         RowBox[{"t", ",", "t"}], "]"}], "\[Rule]", "1"}]}], "}"}]}]}], 
   "\[IndentingNewLine]"}],
  FontColor->GrayLevel[0],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimpAll", "::", "usage"}], "=", 
   "\"\<It is a very useful function, which can simplify: \n \
\!\(\*SuperscriptBox[\(0\), \(T\)]\)\[Rule]0, \!\(\*SubscriptBox[\(Z\), \
\(0\)]\)[t,q]\[Rule]1, \!\(\*SubscriptBox[\(N\), \
\(uv\)]\)[0,\!\(\*SuperscriptBox[\(t\), \(-1\)]\),\!\(\*SuperscriptBox[\(q\), \
\(-1\)]\)]\[Rule] 1, \!\(\*SuperscriptBox[\(N\), \
\(half\)]\)[0,\!\(\*SuperscriptBox[\(t\), \
\(-1\)]\),\!\(\*SuperscriptBox[\(q\), \(-1\)]\)]\[Rule] 1 \>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.716115018251438*^9, 3.716115087868931*^9}, {
  3.716115128268189*^9, 3.71611513063815*^9}, {3.716116728158793*^9, 
  3.716116832145009*^9}, {3.7161169647960987`*^9, 3.716116989149582*^9}, {
  3.730591848491377*^9, 3.730591871500882*^9}, {3.730591933235476*^9, 
  3.730591969597616*^9}, {3.7306026672640963`*^9, 3.730602681235115*^9}, {
  3.739782828052658*^9, 3.7397828466090813`*^9}, {3.739851502819816*^9, 
  3.739851511876836*^9}, {3.740115021990532*^9, 3.740115194022439*^9}, {
  3.7401188108407707`*^9, 3.7401188129406433`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"dcbeef48-431c-4d37-9062-62a777368139"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Automatically get definition:                         { ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["q", 
     RowBox[{"aabs", "[", "u", "]"}]], " ", 
    SuperscriptBox["t", ".."], 
    RowBox[{"ZZ", "[", 
     RowBox[{"v", ",", "t", ",", "q"}], "]"}], 
    SubscriptBox["N", 
     RowBox[{"uv", " "}]], 
    SuperscriptBox["N", "half"]}], TraditionalForm]],ExpressionUUID->
  "86224fe2-258a-4c0d-9e06-0b322e7acf20"],
 " , ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{
      SuperscriptBox["Q", "..."], ",", "t", ",", "q"}], "]"}], "/", 
    RowBox[{"M", "[", 
     RowBox[{
      SuperscriptBox["Q", "..."], ",", "t", ",", "q"}]}]}], TraditionalForm]],
  ExpressionUUID->"8ce835f6-cbd2-4c92-b55c-d2d8062f57ac"],
 "]}"
}], "Subsubsection",
 CellChangeTimes->{{3.717207128296297*^9, 3.717207143757522*^9}, {
  3.740111089506915*^9, 3.740111110824048*^9}, {3.740113730202977*^9, 
  3.740113732662765*^9}, {3.740118668004757*^9, 3.740118688150392*^9}, {
  3.740127488589473*^9, 3.7401274902020617`*^9}, {3.740127625872449*^9, 
  3.740127757254328*^9}, {3.740127849242796*^9, 3.740127884374531*^9}, {
  3.7401280165274*^9, 
  3.740128034676116*^9}},ExpressionUUID->"29eb897d-60e6-4066-967b-\
44d2e08a6fd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cleanvar", "[", "vertexdata_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vari", ",", "ii", ",", "rephitoone"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vari", "=", 
      RowBox[{"vertexdata", "//", "variable"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"rephitoone", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<h\>\"", "<>", 
            RowBox[{"ToString", "@", "ii"}], "<>", "\"\<->1\>\""}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "[", "vari", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", "\[Rule]", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", "\[Rule]", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vari", "/.", "rephitoone"}], "//", "Sort"}], "//", 
      "Deleteone"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[152]:=",ExpressionUUID->"26ee2ef5-b8e9-48ca-b98f-b1f4a1390761"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"repv", "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"aabs", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rep2v", "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["x", "2"], "\[Rule]", 
    RowBox[{"aabs2", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rep2Tv", "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", " ", 
     SuperscriptBox["x", "2"]}], "\[Rule]", 
    RowBox[{"aabs2t", "[", "x", "]"}]}], "}"}]}]}], "Input",
 CellLabel->
  "In[153]:=",ExpressionUUID->"80ad42d2-ae74-43b2-a70d-44110a79af26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"REP", "[", "vertexdata_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reP", ",", "vari"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vari", "=", 
      RowBox[{"vertexdata", "//", "cleanvar"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"reP", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"repv", "/@", "vari"}], ",", 
         RowBox[{"(", 
          RowBox[{"rep2v", "/@", "vari"}], ")"}], ",", 
         RowBox[{"rep2Tv", "/@", "vari"}]}], "]"}], "//", "Flatten"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "above", " ", "vertexdate", " ", "in", " ", "REP", " ", "can", 
    " ", "be", " ", "other", " ", "thing", " ", "like", " ", 
    RowBox[{"{", 
     RowBox[{"\[Nu]1", ",", "\[Nu]2", ",", "\[Alpha]", ",", "..."}], "}"}], 
    " ", "as", " ", "you", " ", "like", " ", "to", " ", "define", " ", 
    "partition", " ", "function"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.717210498118566*^9, 3.717210552968677*^9}, {
  3.7172105937652483`*^9, 3.717210615171767*^9}, {3.717213659862323*^9, 
  3.7172137343954277`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"3358e642-c7e4-4871-b461-d222cb36f77c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YoungtoQqt", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"REP", "[", "vlist", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.717227713600909*^9, 3.7172277440883837`*^9}, {
  3.717228717014638*^9, 3.717228723101053*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"a6092b6e-90b3-44ca-abdb-fade87c898ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SubscriptBox["ZZ", "\[Nu]1_"], "[", 
     RowBox[{"t", ",", "q"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "\[Nu]1", ",", "t", ",", "q"}], "}"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["ZZ", 
        SuperscriptBox["\[Nu]1_", "T"]], "[", 
       RowBox[{"q", ",", "t"}], "]"}]}], ":=", 
     RowBox[{"{", 
      RowBox[{"T", ",", "\[Nu]1", ",", "q", ",", "t"}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"removeM", "[", 
     RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", "1"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"onlyMleft", "[", "x_", "]"}], ":=", 
    RowBox[{"x", "/", 
     RowBox[{"(", 
      RowBox[{"x", "/.", 
       RowBox[{"{", 
        RowBox[{"MM", "\[Rule]", "removeM"}], "}"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"onlyNNNleft", "[", "x_", "]"}], ":=", 
    RowBox[{"x", "/.", 
     RowBox[{"{", 
      RowBox[{"MM", "\[Rule]", "removeM"}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7172121291900597`*^9, 3.717212147296048*^9}, 
   3.717212495935432*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"ffbcfbe3-c062-41df-b9a8-20a1ef1c38a3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["daZ", "a_"], "[", 
     RowBox[{"t_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"a", ",", "t", ",", "q"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataZZ", "[", "x_", "]"}], ":=", 
    RowBox[{"x", "/.", 
     RowBox[{"{", 
      RowBox[{"Z", "\[Rule]", "daZ"}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"varleft", "[", "topvex_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            StyleBox[
             RowBox[{"ZZZ", "[", "topvex", "]"}],
             FontColor->GrayLevel[0]], "//", "APART"}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Z", "\[Rule]", "daZ"}], "}"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"T", "\[Rule]", "0"}], "}"}]}], ")"}], "//", "cleanvar"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"varleft", "[", "topvex_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FactorTermsList", "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"aZZZ", 
                    StyleBox["[",
                    FontColor->GrayLevel[0]], 
                    StyleBox["topvex",
                    FontColor->GrayLevel[0]], 
                    StyleBox["]",
                    FontColor->GrayLevel[0]]}], "//", "APART"}], ")"}], "//", 
                    "Log"}], "//", "PowerExpand"}], ")"}]}], "//", "Exp"}], 
                 ")"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exp", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Exp", "[", "2", "]"}], "\[Rule]", "2"}], ",", 
                  RowBox[{
                   RowBox[{"Exp", "[", "3", "]"}], "\[Rule]", "3"}], ",", 
                  RowBox[{
                   RowBox[{"Exp", "[", "4", "]"}], "\[Rule]", "4"}], ",", 
                  RowBox[{
                   RowBox[{"Exp", "[", "5", "]"}], "\[Rule]", "5"}], ",", 
                  RowBox[{
                   RowBox[{"Exp", "[", "6", "]"}], "\[Rule]", "6"}]}], 
                 "}"}]}], ")"}], "//", "Flatten"}], ",", "_Integer"}], "]"}], 
           ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Z", "\[Rule]", "daZ"}], "}"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"T", "\[Rule]", "0"}], "}"}]}], ")"}], "//", "cleanvar"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    StyleBox[
     RowBox[{"varlist", "[", "topvex_", "]"}],
     Background->RGBColor[1, 0.85, 0.85]], 
    StyleBox[":=",
     Background->RGBColor[1, 0.85, 0.85]], 
    RowBox[{
     StyleBox["DeleteCases",
      Background->RGBColor[1, 0.85, 0.85]], 
     StyleBox["[",
      Background->RGBColor[1, 0.85, 0.85]], 
     RowBox[{
      RowBox[{
       StyleBox["DeleteCases",
        Background->RGBColor[1, 0.85, 0.85]], 
       StyleBox["[",
        Background->RGBColor[1, 0.85, 0.85]], 
       RowBox[{
        RowBox[{
         StyleBox["DeleteCases",
          Background->RGBColor[1, 0.85, 0.85]], 
         StyleBox["[",
          Background->RGBColor[1, 0.85, 0.85]], 
         RowBox[{
          RowBox[{
           RowBox[{
            StyleBox["(",
             Background->RGBColor[1, 0.85, 0.85]], 
            RowBox[{
             RowBox[{
              StyleBox[
               RowBox[{"(", 
                RowBox[{"dataZZ", "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"aExtractZZZ", "[", "topvex", "]"}],
                    FontColor->GrayLevel[0]], "//", "APART"}], ")"}]}], ")"}],
               
               Background->RGBColor[1, 0.85, 0.85]], 
              StyleBox["/.",
               Background->RGBColor[1, 0.85, 0.85]], 
              RowBox[{
               StyleBox["{",
                Background->RGBColor[1, 0.85, 0.85]], 
               RowBox[{
                StyleBox["_Integer",
                 Background->RGBColor[1, 0.85, 0.85]], 
                StyleBox["\[Rule]",
                 Background->RGBColor[1, 0.85, 0.85]], "1"}], 
               StyleBox["}",
                Background->RGBColor[1, 0.85, 0.85]]}]}], 
             StyleBox["/.",
              Background->RGBColor[1, 0.85, 0.85]], 
             StyleBox[
              RowBox[{"{", 
               RowBox[{"T", "\[Rule]", "0"}], "}"}],
              Background->RGBColor[1, 0.85, 0.85]]}], 
            StyleBox[")",
             Background->RGBColor[1, 0.85, 0.85]]}], 
           StyleBox["//",
            Background->RGBColor[1, 0.85, 0.85]], 
           StyleBox["Flatten",
            Background->RGBColor[1, 0.85, 0.85]]}], 
          StyleBox[",",
           Background->RGBColor[1, 0.85, 0.85]], 
          StyleBox["1",
           Background->RGBColor[1, 0.85, 0.85]]}], 
         StyleBox["]",
          Background->RGBColor[1, 0.85, 0.85]]}], 
        StyleBox[",",
         Background->RGBColor[1, 0.85, 0.85]], 
        StyleBox["t",
         Background->RGBColor[1, 0.85, 0.85]]}], 
       StyleBox["]",
        Background->RGBColor[1, 0.85, 0.85]]}], 
      StyleBox[",",
       Background->RGBColor[1, 0.85, 0.85]], 
      StyleBox["q",
       Background->RGBColor[1, 0.85, 0.85]]}], 
     StyleBox["]",
      Background->RGBColor[1, 0.85, 0.85]]}]}]}]}]], "Input",
 CellChangeTimes->{{3.717214078041197*^9, 3.717214093637782*^9}, {
   3.717214129368878*^9, 3.717214160965577*^9}, {3.717214191846715*^9, 
   3.7172141976589537`*^9}, {3.717214266994802*^9, 3.717214306259199*^9}, {
   3.71721439626927*^9, 3.717214422636423*^9}, {3.7172144551443377`*^9, 
   3.717214460632648*^9}, {3.717214859288813*^9, 3.7172148986788387`*^9}, {
   3.717215011993862*^9, 3.717215023590122*^9}, {3.717216030638461*^9, 
   3.7172160667167177`*^9}, {3.717219943982347*^9, 3.717219944421885*^9}, 
   3.717222469097952*^9, {3.740125197748169*^9, 3.740125211307495*^9}, {
   3.7401254946763144`*^9, 3.740125498757366*^9}, {3.740125577474782*^9, 
   3.740125586445919*^9}, {3.740125677016411*^9, 3.740125708854395*^9}, {
   3.740125868290103*^9, 3.740126040066647*^9}, {3.740126129785136*^9, 
   3.740126171960051*^9}, {3.740126975468707*^9, 3.7401270471705637`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"2eda1c8c-717e-451f-bafe-e43a05d2cced"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cleandataZZ", "[", "arry_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FactorTermsList", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             StyleBox["arry",
              FontColor->GrayLevel[0]], "//", "APART"}], ")"}], "//", "Log"}],
           "//", "PowerExpand"}], ")"}]}], "//", "Exp"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", "2", "]"}], "\[Rule]", "2"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", "3", "]"}], "\[Rule]", "3"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", "4", "]"}], "\[Rule]", "4"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", "5", "]"}], "\[Rule]", "5"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", "6", "]"}], "\[Rule]", "6"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.717228294263027*^9, 3.7172282950754766`*^9}, {
  3.7172283339324913`*^9, 3.71722837841358*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"11b3da7e-cf4c-4324-a3ad-45a51d5eda8d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"convertZ", "[", 
     RowBox[{"{", 
      RowBox[{"n_", ",", "v_", ",", "t_", ",", "q_"}], "}"}], "]"}], ":=", 
    SuperscriptBox[
     RowBox[{"ZZZZ", "[", 
      RowBox[{"v", ",", "q", ",", "t"}], "]"}], "n"]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7172207849219313`*^9, 3.717220790429139*^9}, 
   3.7172272183600283`*^9, 3.717228475887998*^9, 3.717228844139223*^9, 
   3.740111200076881*^9},
 CellLabel->
  "In[165]:=",ExpressionUUID->"2f00da7e-737a-4cdb-944b-0b86c471b569"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YoungtoZZ", "[", "zarry_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"arr", ",", 
      RowBox[{"arr2", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"arr3", "=", 
       RowBox[{"{", "}"}]}], ",", "var", ",", "i", ",", "j", ",", "k"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arr", "=", 
      RowBox[{
       RowBox[{"zarry", "//", "cleandataZZ"}], "//", "dataZZ"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"var", "=", "vlist"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "arr", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arr2", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"arr2", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"arr", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"Length", "[", "arr", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", 
          RowBox[{"Length", "[", "var", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"valueequal", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"arr2", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"var", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "\[Equal]", "1"}], 
           ",", 
           RowBox[{"arr3", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"arr3", ",", 
              RowBox[{"arr2", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"convertZ", "/@", "arr3"}], ")"}], "//", "PRODUCT"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.717228065407246*^9, 3.717228082082424*^9}, {
  3.7172281494040213`*^9, 3.717228150346525*^9}, {3.7172285620804*^9, 
  3.7172285676335173`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"4599be47-511e-48dd-98c8-bff0f346b21d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["nullz", "\[Nu]_"], "[", 
   RowBox[{"q_", ",", "t_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nullhalf", "[", 
   RowBox[{"s_", ",", "v_", ",", "Q_", ",", "q_", ",", "t_"}], "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nullnab", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "Q_", ",", 
    RowBox[{"{", 
     RowBox[{"q_", ",", "t_"}], "}"}]}], "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isQqtpart", "[", "x_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{"valueequal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "//", "Log"}], "//", "PowerExpand"}], "//", "Exp"}], ",", 
     "x"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isZZ", "[", "x_", "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"valueequal", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NNNhalf", "\[Rule]", "nullhalf"}], ",", " ", 
          RowBox[{"NNN\[Alpha]\[Beta]", "->", "nullnab"}], ",", 
          RowBox[{"Z", "\[Rule]", "nullz"}], ",", 
          RowBox[{"MM", "\[Rule]", "removeM"}]}], "}"}]}], ")"}], ",", "1"}], 
     "]"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Youngto", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "Qqt", ",", "ZZ", ",", "youngz", ",", "nab", ",", 
      RowBox[{"y", "=", "0"}], ",", "end"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"val", "=", 
      RowBox[{"x", "//", "isQqtpart"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"val", "\[Equal]", "1"}], ",", 
       RowBox[{"Goto", "[", "Qqt", "]"}], ",", 
       RowBox[{"Goto", "[", "ZZ", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Label", "[", "Qqt", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"x", "//", "YoungtoQqt"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "end", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "ZZ", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "//", "isZZ"}], ")"}], "\[Equal]", "1"}], ",", 
       RowBox[{"Goto", "[", "youngz", "]"}], ",", 
       RowBox[{"Goto", "[", "nab", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "youngz", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"x", "//", "YoungtoZZ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "end", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "nab", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", "x"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "end", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "end", "]"}], ";", "\[IndentingNewLine]", "y"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.717897790348979*^9, 3.7178981598024397`*^9}, {
  3.7178984753792*^9, 3.717898770900174*^9}, {3.7178991399058247`*^9, 
  3.717899145880752*^9}, {3.717899310936203*^9, 3.717899311192452*^9}, {
  3.717899350949337*^9, 3.717899356975649*^9}, {3.717899395416422*^9, 
  3.7178994241303253`*^9}, {3.717899491192264*^9, 3.717899496569257*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"93dcace3-8d0f-4d82-80f3-c6b9dbc41140"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"YoungTo", "[", "x_", "]"}], ":=", 
  RowBox[{"Youngto", "/@", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YoungTo", " ", "::", "usage"}], "=", 
   "\"\<An important function  used to turn undefined partition function (\
\[Nu] is not defined), for example, \n(-1\!\(\*SuperscriptBox[\()\), \(\[Nu]1\
\)]\) \!\(\*SuperscriptBox[\(q\), FractionBox[\(T\\\ \
\*SuperscriptBox[\(\[Nu]1\), \(2\)]\), \(2\)]]\) \
\!\(\*SuperscriptBox[\(QB1\), \(\[Nu]1\)]\) \!\(\*SubscriptBox[\(Z\), \
\(\[Nu]1\)]\)[q,t] \!\(\*SubscriptBox[\(Z\), SuperscriptBox[\(\[Nu]1\), \
\(T\)]]\)[t,q] \ninto\n (-1\!\(\*SuperscriptBox[\()\), \(aabs[\[Nu]1]\)]\) \!\
\(\*SuperscriptBox[\(q\), FractionBox[\(aabs2t[\[Nu]1]\), \(2\)]]\) \
\!\(\*SuperscriptBox[\(QB1\), \(aabs[\[Nu]1]\)]\) ,ZZZZ[\[Nu]1,t,q]\n\nWhen \
using it, be sure to split it like \n{(-1\!\(\*SuperscriptBox[\()\), \(\[Nu]1\
\)]\) \!\(\*SuperscriptBox[\(q\), FractionBox[\(T\\\ \
\*SuperscriptBox[\(\[Nu]1\), \(2\)]\), \(2\)]]\) \
\!\(\*SuperscriptBox[\(QB1\), \(\[Nu]1\)]\) , \!\(\*SubscriptBox[\(Z\), \(\
\[Nu]1\)]\)[q,t] \!\(\*SubscriptBox[\(Z\), SuperscriptBox[\(\[Nu]1\), \(T\)]]\
\)[t,q], NNN\[Alpha]\[Beta][{\[Nu]1,RT[\[Nu]1]},\!\(\*FractionBox[\(Q\\\ \
\*SqrtBox[\(t\)]\), SqrtBox[\(q\)]]\),{\!\(\*FractionBox[\(1\), \(t\)]\),\!\(\
\*FractionBox[\(1\), \(q\)]\)}] }//YoungTo\n \>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.717931175430175*^9, 3.717931196051962*^9}, {
  3.7401113805739307`*^9, 3.740111682585005*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"f10b023e-8d3b-4452-817f-ec1a4abe6f8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rundef", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", "//", "PRODUCT"}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"aabs", "\[Rule]", "abs"}], ",", 
     RowBox[{"aabs2", "\[Rule]", "abs2"}], ",", 
     RowBox[{"aabs2t", "\[Rule]", "abs2t"}], ",", 
     RowBox[{"NNN\[Alpha]\[Beta]", "\[Rule]", "NN\[Alpha]\[Beta]"}], ",", 
     RowBox[{"NNNhalf", "\[Rule]", "NNhalf"}], ",", 
     RowBox[{"RT", "\[Rule]", "TT"}], ",", 
     RowBox[{"ZZZZ", "\[Rule]", "ZZZ"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rundef", "::", "usage"}], "=", 
   "\"\< Rundef is used to run definition of partition function, by replaing \
undefined function by defined function :\n    \
{aabs\[Rule]abs,aabs2\[Rule]abs2,aabs2t\[Rule]abs2t,NNN\[Alpha]\[Beta]\[Rule]\
NN\[Alpha]\[Beta],NNNhalf\[Rule]NNhalf,RT\[Rule]TT,ZZZZ\[Rule]ZZZ}\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.717218734733988*^9, 3.717218801663765*^9}, {
  3.717221483197106*^9, 3.717221505323102*^9}, {3.717931906086226*^9, 
  3.717931913394701*^9}, {3.7401112165032587`*^9, 3.740111360693596*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"2eda8466-65ed-43a5-86cc-44733b8b3767"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Explicitly expanding partition functions: ",
  Background->RGBColor[1, 1, 0]],
 Cell[BoxData[
  FormBox[
   RowBox[{"            ", 
    RowBox[{
     SuperscriptBox["Z", 
      RowBox[{"n", "-", "inst"}]], "=", 
     RowBox[{"\[Sum]", "  ", 
      RowBox[{
       FractionBox[
        RowBox[{"q", " ", "t"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "q"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "t"}], ")"}]}]], 
       SuperscriptBox[
        SubscriptBox["Q", "..."], "..."], " ", 
       SuperscriptBox["u", "n"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "f3d7e844-0509-4459-a76c-f85cf89632c1"]
}], "Subsubsection",
 CellChangeTimes->{{3.70390135229278*^9, 3.7039013660131598`*^9}, {
  3.740113436332896*^9, 3.7401134387714367`*^9}, {3.740127765966577*^9, 
  3.740127886184746*^9}, {3.7401280311379137`*^9, 
  3.740128048438066*^9}},ExpressionUUID->"89fde45b-1557-4ee8-8318-\
5f1b0db2ae2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"validPartitionQ", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "part", "}"}], ",", 
    RowBox[{
     RowBox[{"part", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"VectorQ", "[", 
       RowBox[{"part", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
           RowBox[{"NonNegative", "[", "#", "]"}]}], ")"}], "&"}]}], "]"}], "&&", 
      RowBox[{"Apply", "[", 
       RowBox[{"GreaterEqual", ",", "part"}], "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7037617383452377`*^9, 3.703761789253653*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"da9ee60f-6f1f-420c-876b-9ab326def970"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Boxss", "[", 
   RowBox[{"A_", "?", "validPartitionQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "part", "}"}], ",", 
    RowBox[{
     RowBox[{"part", "=", "A"}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j", ",", "i"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "part", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"part", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.703761807271785*^9, 3.703761826958178*^9}, {
   3.70383109519069*^9, 3.703831095388949*^9}, 3.703831821571151*^9},
 CellLabel->
  "In[178]:=",ExpressionUUID->"48f4fa0e-bc22-4119-ab5f-4f17203cec34"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7037607196639*^9, 3.703760776944839*^9}, {
   3.703760844034376*^9, 3.7037608669994097`*^9}, {3.703761027129703*^9, 
   3.703761173365082*^9}, {3.703761849495366*^9, 3.703761978283782*^9}, {
   3.703762060368391*^9, 3.703762169457178*^9}, {3.703762221841943*^9, 
   3.703762289395782*^9}, {3.7037623263824453`*^9, 3.7037623553219357`*^9}, {
   3.703762392988118*^9, 3.703762393399219*^9}, {3.7037624401673803`*^9, 
   3.703762448917473*^9}, {3.70383109868824*^9, 3.703831099364418*^9}, 
   3.703831144187594*^9, {3.703831768005204*^9, 3.703831824673937*^9}, {
   3.703831869900239*^9, 3.703831870097052*^9}, {3.7038319541642647`*^9, 
   3.7038319546883307`*^9}, {3.703832375834922*^9, 3.7038323789341297`*^9}, 
   3.703833226246139*^9},
 CellLabel->
  "In[179]:=",ExpressionUUID->"8553c100-4568-4b58-b4cd-0292f106f8ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BOX", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"part", ",", "index", ",", "N", ",", "padA", ",", "i"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"part", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"index", "=", 
      RowBox[{"Boxss", "[", "part", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"N", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Max", "[", "A", "]"}], ",", 
        RowBox[{"Length", "[", "part", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"padA", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "N", ",", "N"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "index", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"padA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"index", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"index", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "1"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "padA"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7038318303899384`*^9, 3.7038318961629057`*^9}, {
  3.703832381711239*^9, 3.703832384806037*^9}, {3.703832425401484*^9, 
  3.7038324472784767`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"6081e5d1-159c-4eb1-b810-020a7785b7d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mmax", "[", 
   RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"m", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"BOX", "[", "A", "]"}], "]"}], ",", 
       RowBox[{"Length", "[", 
        RowBox[{"BOX", "[", "B", "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[181]:=",ExpressionUUID->"0c392c0d-5cb9-4f22-8cb6-ac3542cc292e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"A_", ",", "a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part", ",", "index", ",", "padA", ",", "N", ",", "i"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"part", "=", "A"}], ";", "\[IndentingNewLine]", 
      RowBox[{"index", "=", 
       RowBox[{"Boxss", "[", "part", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"N", "=", 
       RowBox[{"mmax", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"padA", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", "N", ",", "N"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "index", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"padA", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"index", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"index", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "1"}]}], "]"}],
       ";", "\[IndentingNewLine]", "padA"}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7038332765593567`*^9, 3.703833387318447*^9}, {
  3.703836805071292*^9, 3.7038368065981197`*^9}, {3.703836979831324*^9, 
  3.703837004395431*^9}, {3.703837910897031*^9, 3.703837923530641*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"5e9710b1-5f27-4e14-8be9-b23ef038cd8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"abs", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plus", "@@", 
      RowBox[{"Flatten", "[", "A", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.703830686495965*^9, 3.7038307243196*^9}, {
  3.703831346251463*^9, 3.703831373426599*^9}, {3.703831478797784*^9, 
  3.703831495201478*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"c404399d-ab41-4cac-9d9f-7d6e7f9643b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", "A_", "]"}], ":=", 
  RowBox[{"Transpose", "[", "A", "]"}]}]], "Input",
 CellChangeTimes->{{3.703837284420888*^9, 3.703837296444778*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"5c742ec3-eb2b-4f89-b4f5-c3be5496737d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"abs2", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "ai", ",", "abs2a"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", 
      RowBox[{"BOX", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ai", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Transpose", "[", "newA", "]"}], "]"}]}], ";", " ", 
     RowBox[{"(*", "a_i", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"abs2a", "=", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{"ai", "^", "2"}], ")"}]}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.703831618788245*^9, 3.703831664255299*^9}, {
   3.7038319854274263`*^9, 3.703831988865077*^9}, 3.703832063979567*^9, {
   3.703832577481132*^9, 3.703832620060809*^9}, {3.7038414373128242`*^9, 
   3.7038414391755466`*^9}, {3.703841475659183*^9, 3.7038414785296593`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"94c70571-f792-4c86-b64f-1a9d62e3c42b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"abs2t", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newA", ",", "tai", ",", "abs2ta"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newA", "=", 
      RowBox[{"BOX", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tai", "=", 
      RowBox[{"Total", "[", "newA", "]"}]}], ";", "  ", 
     RowBox[{"(*", 
      RowBox[{"a", "^", "t_i"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"abs2ta", "=", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{"tai", "^", "2"}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.703832526821885*^9, 3.7038325517084084`*^9}, {
  3.7038326335454187`*^9, 3.703832651147993*^9}, {3.703841442248838*^9, 
  3.70384148841453*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"e5e884f3-4238-4cac-a94f-3625b528e8c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Arm", "[", 
   RowBox[{"A_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Total", "[", "A", "]"}], "[", 
     RowBox[{"[", "j", "]"}], "]"}], "-", "i"}], ")"}], 
  RowBox[{"(*", 
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "j"}], "]"}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7038363619473467`*^9, 3.70383636298418*^9}, {
   3.703836483307827*^9, 3.703836543454253*^9}, {3.703836605372645*^9, 
   3.703836618783909*^9}, {3.703837767255444*^9, 3.703837775840228*^9}, {
   3.703839888202013*^9, 3.7038398903267097`*^9}, {3.7038458154958887`*^9, 
   3.7038458247373457`*^9}, {3.7104268623810863`*^9, 3.710426867474565*^9}, {
   3.710426905932822*^9, 3.710426907332838*^9}, {3.710427514117872*^9, 
   3.710427515406946*^9}, {3.7104291571602077`*^9, 3.710429158180805*^9}, {
   3.7104311698101254`*^9, 3.7104311720384073`*^9}, {3.710431217979498*^9, 
   3.710431218442168*^9}, 3.710431836054418*^9},
 CellLabel->
  "In[187]:=",ExpressionUUID->"c2119da8-9851-44df-a557-6366e2c9bec4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Leg", "[", 
   RowBox[{"A_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Transpose", "[", "A", "]"}], "]"}], "[", 
     RowBox[{"[", "i", "]"}], "]"}], "-", "j"}], ")"}], 
  RowBox[{"(*", 
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "j"}], "]"}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7038366285153103`*^9, 3.7038366789584618`*^9}, {
   3.703836737127174*^9, 3.7038367499656363`*^9}, {3.703837760080916*^9, 
   3.7038377628405037`*^9}, {3.703839906696342*^9, 3.703839909550415*^9}, {
   3.7038458176453037`*^9, 3.703845820983651*^9}, {3.710426925715539*^9, 
   3.710426946741683*^9}, {3.710427508880499*^9, 3.71042751064116*^9}, {
   3.710429161328372*^9, 3.71042916174413*^9}, 3.710429298265304*^9, {
   3.710431175299862*^9, 3.7104311759006443`*^9}, {3.7104312213181763`*^9, 
   3.71043122389119*^9}, {3.710431838959784*^9, 3.710431845328556*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"7b166256-7332-4c17-a092-090b9e1dee5a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"ss_", ",", "A_", ",", "B_", ",", "Q_", ",", "t_", ",", "q_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ss", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Q", " ", 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Leg", "[", 
             RowBox[{"A", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "-", "1"}]], 
         SuperscriptBox["t", 
          RowBox[{"-", 
           RowBox[{"Arm", "[", 
            RowBox[{"B", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}]]}]}], ")"}], 
      RowBox[{"A", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Q", " ", 
         SuperscriptBox["q", 
          RowBox[{"Leg", "[", 
           RowBox[{"B", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}]], 
         SuperscriptBox["t", 
          RowBox[{
           RowBox[{"Arm", "[", 
            RowBox[{"A", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "+", "1"}]]}]}], ")"}], 
      RowBox[{"B", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.703837446023346*^9, 3.703837516570785*^9}, {
   3.703837592528887*^9, 3.70383759723775*^9}, {3.703837795036388*^9, 
   3.7038378852661963`*^9}, {3.703837930127489*^9, 3.7038379726063843`*^9}, {
   3.703838189669813*^9, 3.703838202523459*^9}, {3.703838450579615*^9, 
   3.703838455785233*^9}, {3.7038386780012503`*^9, 3.703838682422634*^9}, {
   3.703838717938923*^9, 3.7038387323284893`*^9}, {3.703838798086734*^9, 
   3.703838833669094*^9}, {3.7038396347573643`*^9, 3.70383963977841*^9}, {
   3.703839917255368*^9, 3.7038399475414743`*^9}, {3.703841151137967*^9, 
   3.7038411763239307`*^9}, {3.703841849894018*^9, 3.703841878453225*^9}, {
   3.7087748147255087`*^9, 3.708774842316297*^9}, 3.7104261320283833`*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"9abaf999-6504-4e36-a9c4-44d8b5d72dff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "[", 
   RowBox[{
   "ss_", ",", "A_", ",", "B_", ",", "Q_", ",", "t_", ",", "q_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tt", "=", "t"}], ",", 
      RowBox[{"qq", "=", "q"}], ",", 
      RowBox[{"QQ", "=", "Q"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ss", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"QQ", " ", 
          SuperscriptBox["qq", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Leg", "[", 
              RowBox[{"A", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "-", "1"}]], 
          SuperscriptBox["tt", 
           RowBox[{"-", 
            RowBox[{"Arm", "[", 
             RowBox[{"B", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}]]}]}], ")"}], 
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"QQ", " ", 
          SuperscriptBox["qq", 
           RowBox[{"Leg", "[", 
            RowBox[{"B", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}]], 
          SuperscriptBox["tt", 
           RowBox[{
            RowBox[{"Arm", "[", 
             RowBox[{"A", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "+", "1"}]]}]}], 
        ")"}], 
       RowBox[{"B", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.710425984389777*^9, 3.710426054937415*^9}, {
  3.7104261174890013`*^9, 3.71042612363706*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"72b4bd32-380b-474e-a0d6-07979309bdc6"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"nred", "[", 
    RowBox[{"ss_", ",", "A_", ",", "Q_", ",", "t_", ",", "q_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ss", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Q", " ", 
         SuperscriptBox["q", 
          RowBox[{"j", "-", 
           FractionBox["1", "2"]}]], 
         SuperscriptBox["t", 
          RowBox[{
           RowBox[{"-", "i"}], "+", 
           FractionBox["1", "2"]}]]}]}], ")"}], 
      RowBox[{"A", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Q", " ", 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"-", "j"}], "+", 
           FractionBox["1", "2"]}]], 
         SuperscriptBox["t", 
          RowBox[{"i", "-", 
           FractionBox["1", "2"]}]]}]}], ")"}], 
      RowBox[{"A", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}]}],
  Background->RGBColor[0.88, 1, 0.88]]], "Input",
 CellChangeTimes->{{3.703841639414263*^9, 3.703841770993922*^9}, {
  3.703841806147812*^9, 3.703841810281464*^9}, {3.703841909354802*^9, 
  3.7038419350586443`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[191]:=",ExpressionUUID->"072e3cfb-082d-47e7-889b-082421c63b4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Zfactor", "[", 
   RowBox[{"A_", ",", "t_", ",", "q_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       SuperscriptBox["q", 
        RowBox[{"Leg", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}]], 
       SuperscriptBox["t", 
        RowBox[{
         RowBox[{"Arm", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "+", "1"}]]}]}], ")"}], 
    RowBox[{"-", "1"}]], 
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["Z", "\[Nu]"], "[", 
    RowBox[{"t", ",", "q"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.703843370841249*^9, 3.70384338118512*^9}, 
   3.703843664494618*^9, {3.718613277250864*^9, 3.718613317947489*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"40245f41-0339-4a9e-95c2-a80f7a6e0a51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Shur", "[", 
   RowBox[{"\[Nu]_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", 
      RowBox[{"A", "=", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"TT", "[", "\[Nu]", "]"}], ",", 
         RowBox[{"TT", "[", "\[Nu]", "]"}], ",", 
         RowBox[{"{", "20", "}"}]}], "]"}]}], ",", "ready"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ready", "=", "\[IndentingNewLine]", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Zfactor", "[", 
            RowBox[{"A", ",", "q", ",", "q", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}], "]"}], ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox["q", 
       RowBox[{"abs2t", "[", "\[Nu]", "]"}]], 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"ready", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "ready", "]"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.718610953611659*^9, 3.718610973591393*^9}, {
  3.718611249271023*^9, 3.718611279318741*^9}, {3.718611320414055*^9, 
  3.718611330081647*^9}, {3.718611500764943*^9, 3.718611522019804*^9}, {
  3.718611685693198*^9, 3.7186117615068407`*^9}, {3.718611928931239*^9, 
  3.718611935252513*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"9d6ebafe-98c0-4828-a473-7b7e867c5fec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tZ", "[", 
   RowBox[{"\[Nu]_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", 
      RowBox[{"A", "=", 
       RowBox[{"R", "[", 
        RowBox[{"\[Nu]", ",", "\[Nu]", ",", 
         RowBox[{"{", "20", "}"}]}], "]"}]}], ",", "ready"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ready", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Zfactor", "[", 
             RowBox[{"A", ",", "t", ",", "q", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"T", "[", "A", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"T", "[", "A", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
         "]"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"ready", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ready", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.718612887904727*^9, 3.7186128887494183`*^9}, {
  3.7186129276883574`*^9, 3.718612949534522*^9}, {3.718612993223418*^9, 
  3.718613012025427*^9}, {3.7186133495042343`*^9, 3.718613352915114*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"b015ebb2-02de-41a8-967e-c267a76d4f04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nn", "[", 
   RowBox[{"ss_", ",", "A_", ",", "B_", ",", "Q_", ",", "t_", ",", "q_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "k", ",", "TableCC", ",", "DeleteFlattenC"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TableCC", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{
         "ss", ",", "A", ",", "B", ",", "Q", ",", "t", ",", "q", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], ",", 
            RowBox[{"Length", "[", "B", "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], ",", 
            RowBox[{"Length", "[", "B", "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteFlattenC", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "TableCC", "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"DeleteFlattenC", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "DeleteFlattenC", "]"}]}], "}"}]}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.703838405564487*^9, 3.703838422087085*^9}, {
   3.7038384570503263`*^9, 3.703838476710988*^9}, {3.703838520714962*^9, 
   3.7038385324062757`*^9}, {3.703838567884985*^9, 3.703838604859569*^9}, {
   3.70383883894615*^9, 3.703838908030119*^9}, {3.7038389426852093`*^9, 
   3.703839060509295*^9}, {3.703839103058025*^9, 3.703839105485283*^9}, {
   3.7038391830865307`*^9, 3.7038391964908648`*^9}, {3.703839762210826*^9, 
   3.7038397792006197`*^9}, {3.7038398155630007`*^9, 
   3.7038398485467787`*^9}, {3.703840012090172*^9, 3.7038400139598494`*^9}, {
   3.703840064694561*^9, 3.703840074026786*^9}, {3.703840248922489*^9, 
   3.7038402701218452`*^9}, {3.703840451766711*^9, 3.703840467074006*^9}, {
   3.7038406734979467`*^9, 3.703840701399605*^9}, {3.703840825305645*^9, 
   3.703840888433444*^9}, {3.703840988637786*^9, 3.703841067692095*^9}, 
   3.703841202196933*^9, {3.703841499045601*^9, 3.7038415096005783`*^9}, {
   3.7038416082127743`*^9, 3.703841609751176*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"10d41831-8d35-4247-8764-c1d8be334c4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nnn", "[", 
   RowBox[{"ss_", ",", "A_", ",", "B_", ",", "Q_", ",", "t_", ",", "q_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "k", ",", "TableCC", ",", "DeleteFlattenC"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TableCC", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{
         "ss", ",", "A", ",", "B", ",", "Q", ",", "t", ",", "q", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], ",", 
            RowBox[{"Length", "[", "B", "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], ",", 
            RowBox[{"Length", "[", "B", "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"TableCC", "//", "MatrixForm"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DeleteFlattenC", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "TableCC", "]"}], ",", "0"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Product", "[", 
     RowBox[{
      RowBox[{"DeleteFlattenC", "[", 
       RowBox[{"[", "k", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "[", "DeleteFlattenC", "]"}]}], "}"}]}], "]"}], 
    "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.7231799361991863`*^9, {3.723179989945178*^9, 3.723180009853167*^9}, {
   3.723180149126944*^9, 3.7231801561477213`*^9}, {3.723180251476136*^9, 
   3.72318025560833*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"6633b3aa-7c03-481e-9223-989a81197b73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"N\[Alpha]\[Beta]", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A_", ",", "B_"}], "}"}], ",", "Q_", ",", 
    RowBox[{"{", 
     RowBox[{"t_", ",", "q_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Nn", "[", 
    RowBox[{"1", ",", "A", ",", "B", ",", "Q", ",", "t", ",", "q"}], "]"}], 
   RowBox[{"Nn", "[", 
    RowBox[{"2", ",", "A", ",", "B", ",", "Q", ",", "t", ",", "q"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7038327533537397`*^9, 3.703833099629363*^9}, {
   3.7038331803243217`*^9, 3.703833184067004*^9}, 3.703833218688076*^9, 
   3.70383705519322*^9, {3.703837339415861*^9, 3.703837410728236*^9}, {
   3.703838107712997*^9, 3.7038381337399197`*^9}, {3.703838228468461*^9, 
   3.703838233650931*^9}, {3.703838298293911*^9, 3.703838308613041*^9}, {
   3.7038412904859657`*^9, 3.703841315220091*^9}, 3.703841413858185*^9, {
   3.703841514992581*^9, 3.703841523351096*^9}, {3.703841612816481*^9, 
   3.703841623021812*^9}, {3.70384706181707*^9, 3.703847064843914*^9}, {
   3.7038471286081448`*^9, 3.703847131531859*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"e46c373b-6e3f-4757-971c-0663c57d0aa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nn\[Alpha]\[Beta]", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A_", ",", "B_"}], "}"}], ",", "Q_", ",", 
    RowBox[{"{", 
     RowBox[{"t_", ",", "q_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Nnn", "[", 
     RowBox[{"1", ",", "A", ",", "B", ",", "Q", ",", "t", ",", "q"}], "]"}], 
    ",", 
    RowBox[{"Nnn", "[", 
     RowBox[{"2", ",", "A", ",", "B", ",", "Q", ",", "t", ",", "q"}], "]"}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.723180018512994*^9, 3.7231800391044064`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"5bc2e177-ed22-47ce-9add-be90588716c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nhalf", "[", 
   RowBox[{"ss_", ",", "A_", ",", "Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "TableCC", ",", "DeleteFlattenC"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TableCC", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"nred", "[", 
         RowBox[{"ss", ",", "A", ",", "Q", ",", "t", ",", "q", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteFlattenC", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "TableCC", "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"DeleteFlattenC", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "DeleteFlattenC", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.703841945940117*^9, 3.703842052840753*^9}, {
  3.7039044117116413`*^9, 3.703904426309635*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"3b52e5d2-977f-44db-a248-f814ebd24fd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NNhalf", "[", 
    RowBox[{"ss_", ",", "a_", ",", "Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "A", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      StyleBox[
       RowBox[{"A", "=", 
        RowBox[{"R", "[", 
         RowBox[{"a", ",", "a", ",", 
          RowBox[{"{", "20", "}"}]}], "]"}]}],
       Background->RGBColor[1, 1, 0]], 
      StyleBox[";",
       Background->RGBColor[1, 1, 0]], "\[IndentingNewLine]", 
      RowBox[{"Nhalf", "[", 
       RowBox[{"ss", ",", "A", ",", "Q", ",", "t", ",", "q"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.708238329780736*^9, 3.708238411523225*^9}, {
  3.708238715265963*^9, 3.7082387363765287`*^9}, {3.718611405711142*^9, 
  3.718611406204431*^9}, {3.718773337782172*^9, 3.7187733380876513`*^9}, {
  3.718774374438745*^9, 3.718774374714182*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"bc4e21cc-0830-4fe6-bbfa-efb2b3743041"],

Cell[TextData[{
 "The following is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["Z", 
      SuperscriptBox["\[Alpha]", "T"]], "(", 
     RowBox[{"t", ",", "q"}], ")"}], 
    RowBox[{
     SubscriptBox["Z", "\[Alpha]"], "(", 
     RowBox[{"q", ",", "t"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "860813c7-3861-4eb5-b01c-7481e0fd1493"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", "Z", 
    SuperscriptBox["|", "2"]}], TraditionalForm]],ExpressionUUID->
  "72e57010-5d26-4292-8b5a-25025b9bbe7e"],
 "(t,q)"
}], "Text",
 CellChangeTimes->{{3.703843880715198*^9, 3.703843971886582*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"e84e20ad-76c2-4a94-b128-9ca2ffca807a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZZ", "[", 
   RowBox[{"A_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "ready"}], "}"}], ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ready", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Zfactor", "[", 
              RowBox[{"A", ",", "q", ",", "t", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Zfactor", "[", 
              RowBox[{
               RowBox[{"T", "[", "A", "]"}], ",", "t", ",", "q", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"T", "[", "A", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"T", "[", "A", "]"}], "]"}]}], "}"}]}], "]"}], 
           "]"}]}], "]"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"ready", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ready", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.703841630470269*^9, 3.7038416318943577`*^9}, {
   3.7038420998011007`*^9, 3.703842135544919*^9}, {3.70384238167056*^9, 
   3.7038423927134533`*^9}, {3.7038424385591593`*^9, 3.703842500314769*^9}, {
   3.7038426506151657`*^9, 3.703842709884153*^9}, {3.70384274804242*^9, 
   3.703842775671145*^9}, {3.703842805864396*^9, 3.703843046291391*^9}, {
   3.703843251174693*^9, 3.703843299712866*^9}, 3.7038433332295237`*^9, {
   3.703843554758132*^9, 3.703843559514619*^9}, {3.703843629887478*^9, 
   3.703843632871848*^9}, {3.703843859472096*^9, 3.70384386033784*^9}, {
   3.7082378629143963`*^9, 3.708237888568905*^9}, {3.708238099376687*^9, 
   3.7082381035804033`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"9d539127-1f95-4d83-bbb4-8328f2a0a30a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZZZ", "[", 
   RowBox[{"a_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "A", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     StyleBox[
      RowBox[{"A", "=", 
       RowBox[{"R", "[", 
        RowBox[{"a", ",", "a", ",", 
         RowBox[{"{", "20", "}"}]}], "]"}]}],
      Background->RGBColor[1, 1, 0]], 
     StyleBox[";",
      Background->RGBColor[1, 1, 0]], "\[IndentingNewLine]", 
     RowBox[{"ZZ", "[", 
      RowBox[{"A", ",", "t", ",", "q"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.708238110002713*^9, 3.708238167955285*^9}, {
  3.708238209433361*^9, 3.708238245484399*^9}, {3.708238718373055*^9, 
  3.7082387392197237`*^9}, {3.7186114105203457`*^9, 3.718611411066105*^9}, {
  3.7187733406311083`*^9, 3.718773340896666*^9}, {3.718774376769047*^9, 
  3.7187743770917187`*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"8260016e-95f7-4a41-b931-c7ac965102bf"],

Cell[BoxData[""], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->{3.703905834316368*^9, 3.7040165657938547`*^9},
 CellLabel->
  "In[203]:=",ExpressionUUID->"9b4d37df-6d50-49c4-b2ec-fcdd44230d54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TT", "[", "a_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"A", ",", "n"}], " ", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"R", "[", 
       RowBox[{"a", ",", "a", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "[", "A", "]"}], "//", "Total"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7082470337575808`*^9, 3.708247035842245*^9}, {
  3.708247080593409*^9, 3.708247124002119*^9}, {3.708247185837453*^9, 
  3.70824719218361*^9}, {3.7082473107602663`*^9, 3.708247337605857*^9}, {
  3.7082490950631027`*^9, 3.708249113683247*^9}, {3.708249181961945*^9, 
  3.708249186917892*^9}, {3.7082492294595747`*^9, 3.7082492308442707`*^9}, {
  3.708251242223935*^9, 3.7082512431035833`*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"749cc1ef-5ae3-4eab-9670-396e6f3a535f"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.7082472122759123`*^9},
 CellLabel->
  "In[205]:=",ExpressionUUID->"4afb0911-8851-465e-80e4-8fd50ebffb1f"],

Cell["Each partition (rather than Young diagram)\[CloseCurlyQuote]s \
contribution", "Text",
 CellChangeTimes->{{3.70393309721369*^9, 3.7039331051476727`*^9}, {
  3.703933161475809*^9, 3.703933163355658*^9}, {3.703933296849145*^9, 
  3.703933313292645*^9}},ExpressionUUID->"ef4ab8bc-4568-4a33-aa91-\
315ef300ae0b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    RowBox[{"NN\[Alpha]\[Beta]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A_", ",", "B_"}], 
       RowBox[{"(*", 
        RowBox[{",", "ii_", ",", "jj_"}], "*)"}], "}"}], ",", "Q_", ",", 
      RowBox[{"{", 
       RowBox[{"t_", ",", "q_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"N\[Alpha]\[Beta]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"A", ",", "A", ",", "B"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"B", ",", "B", ",", "A"}], "]"}]}], "}"}], ",", "Q", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "q"}], "}"}]}], "]"}]}],
   Background->RGBColor[1, 0.85, 0.85]]}]], "Input",
 CellChangeTimes->{{3.708247149011286*^9, 3.708247158561614*^9}, {
   3.708247649908011*^9, 3.708247652531171*^9}, {3.708247697918912*^9, 
   3.708247701618284*^9}, {3.708248011835904*^9, 3.708248015806488*^9}, 
   3.7086036914663343`*^9},
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[206]:=",ExpressionUUID->"56269d88-d28a-430f-aa61-334eedac4915"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"NNn\[Alpha]\[Beta]", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A_", ",", "B_"}], 
      RowBox[{"(*", 
       RowBox[{",", "ii_", ",", "jj_"}], "*)"}], "}"}], ",", "Q_", ",", 
     RowBox[{"{", 
      RowBox[{"t_", ",", "q_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Nn\[Alpha]\[Beta]", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"A", ",", "A", ",", "B"}], "]"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"B", ",", "B", ",", "A"}], "]"}]}], "}"}], ",", "Q", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "q"}], "}"}]}], "]"}]}],
  Background->RGBColor[1, 0.85, 0.85]]], "Input",
 CellChangeTimes->{{3.723180065667097*^9, 3.7231800682846813`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"6a122597-5c97-433c-bfb2-193715c7a44b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Zpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"partA", ",", "partB", ",", "Zpairs", ",", "i", ",", "j"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zpairs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "partB", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"Zpairs", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"Zpairs", ",", 
            RowBox[{"Z", "[", 
             RowBox[{
              RowBox[{"partA", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"partB", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"R", "[", 
               RowBox[{
                RowBox[{"partA", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"partA", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"partB", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"R", "[", 
               RowBox[{
                RowBox[{"partB", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"partA", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"partB", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "Zpairs"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.703905140410942*^9, 3.7039054448222837`*^9}, {
  3.703909106553597*^9, 3.703909233352565*^9}, {3.708167964202917*^9, 
  3.7081679680481567`*^9}, {3.708178619236758*^9, 3.70817861971631*^9}, {
  3.7081807901097937`*^9, 3.708180791641068*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[208]:=",ExpressionUUID->"11819c41-83a2-477f-aba2-fd7ccecdf07c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sigZpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"partA", ",", "Zpair", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zpair", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Zpair", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"Zpair", ",", 
          RowBox[{"Z", "[", 
           RowBox[{"partA", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "Zpair"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.708682143532634*^9, 3.7086822722301683`*^9}, {
  3.7086823206033792`*^9, 3.708682339376882*^9}, {3.708682382683342*^9, 
  3.708682416793378*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"8ff9edb6-e0ec-43ad-bfa9-56e1dc1fa8a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"douZpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "partA", ",", "partB", ",", "partC", ",", "Zpairs", ",", "i", ",", "j", 
      ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zpairs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "partB", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Zpairs", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"Zpairs", ",", 
            RowBox[{"Z", "[", 
             RowBox[{
              RowBox[{"partA", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"partB", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "   ", 
           "\[IndentingNewLine]", "                             ", "]"}]}]}], 
        "\[IndentingNewLine]", " ", "]"}]}], "  ", "]"}], ";", 
     "\[IndentingNewLine]", "Zpairs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.708252009293717*^9, 3.7082520256947947`*^9}, 
   3.708252068058316*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"fdbdb89c-d123-49f9-b708-7dec98fed90a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"triZpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "partA", ",", "partB", ",", "partC", ",", "Zpairs", ",", "i", ",", "j", 
      ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partC", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zpairs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "partB", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "partC", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Zpairs", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Zpairs", ",", 
              RowBox[{"Z", "[", 
               RowBox[{
                RowBox[{"partA", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"partB", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"partC", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], "   ", 
             "\[IndentingNewLine]", "                             ", 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "  ", "]"}]}], "  ", 
      "]"}], ";", "\[IndentingNewLine]", "Zpairs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.70885603421187*^9, 3.708856034458301*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"dd1bf1c8-a23d-4eec-b42e-01902324b75e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fouZpart", "[", "part_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "partA", ",", "partB", ",", "partC", ",", "partD", ",", "Zpairs", ",", 
       "i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partA", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partC", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partD", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "partA", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "partB", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", 
             RowBox[{"Length", "[", "partC", "]"}]}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"l", "=", "1"}], ",", 
              RowBox[{"l", "\[LessEqual]", 
               RowBox[{"Length", "[", "partD", "]"}]}], ",", 
              RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Zpairs", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"Zpairs", ",", 
                 RowBox[{"Z", "[", 
                  RowBox[{
                   RowBox[{"partA", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"partB", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                   RowBox[{"partC", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                   RowBox[{"partD", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}]}], "   ", 
                "\[IndentingNewLine]", "                             ", 
                "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "  ", 
         "]"}]}], "  ", "]"}], ";", "\[IndentingNewLine]", "Zpairs"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fivZpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
      "Zpairs", ",", "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partC", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partD", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partE", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Zpairs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "1"}], ",", 
       RowBox[{"i1", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "1"}], ",", 
         RowBox[{"i2", "\[LessEqual]", 
          RowBox[{"Length", "[", "partB", "]"}]}], ",", 
         RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "1"}], ",", 
           RowBox[{"i3", "\[LessEqual]", 
            RowBox[{"Length", "[", "partC", "]"}]}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i4", "=", "1"}], ",", 
             RowBox[{"i4", "\[LessEqual]", 
              RowBox[{"Length", "[", "partD", "]"}]}], ",", 
             RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i5", "=", "1"}], ",", 
               RowBox[{"i5", "\[LessEqual]", 
                RowBox[{"Length", "[", "partE", "]"}]}], ",", 
               RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Zpairs", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Zpairs", ",", 
                  RowBox[{"Z", "[", 
                   RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}]}], "]"}]}], "   ", 
                 "\[IndentingNewLine]", "                             ", 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "Zpairs"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.708179413537603*^9, 3.7081794893608227`*^9}, {
  3.708252050527668*^9, 3.7082520578612127`*^9}, {3.70885604612*^9, 
  3.7088560484408197`*^9}, {3.719329069385564*^9, 3.71932914663194*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"7fbe975f-a45a-42c1-bba8-e55f9dd980f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sixZpart", "[", "part_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
       "partF", ",", "Zpairs", ",", "i1", ",", "i2", ",", "i3", ",", "i4", 
       ",", "i5", ",", "i6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partA", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partC", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partD", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partE", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partF", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i1", "=", "1"}], ",", 
        RowBox[{"i1", "\[LessEqual]", 
         RowBox[{"Length", "[", "partA", "]"}]}], ",", 
        RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i2", "=", "1"}], ",", 
          RowBox[{"i2", "\[LessEqual]", 
           RowBox[{"Length", "[", "partB", "]"}]}], ",", 
          RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i3", "=", "1"}], ",", 
            RowBox[{"i3", "\[LessEqual]", 
             RowBox[{"Length", "[", "partC", "]"}]}], ",", 
            RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i4", "=", "1"}], ",", 
              RowBox[{"i4", "\[LessEqual]", 
               RowBox[{"Length", "[", "partD", "]"}]}], ",", 
              RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i5", "=", "1"}], ",", 
                RowBox[{"i5", "\[LessEqual]", 
                 RowBox[{"Length", "[", "partE", "]"}]}], ",", 
                RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i6", "=", "1"}], ",", 
                  RowBox[{"i6", "\[LessEqual]", 
                   RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                  RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Zpairs", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}]}], "]"}]}], "   ", 
                    "\[IndentingNewLine]", "                             ", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}]}], "]"}], "  ", ";", 
      "\[IndentingNewLine]", "Zpairs"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sevZpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
      "partF", ",", "partG", ",", "Zpairs", ",", "i1", ",", "i2", ",", "i3", 
      ",", "i4", ",", "i5", ",", "i6", ",", "i7"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partC", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partD", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partE", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partF", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partG", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Zpairs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "1"}], ",", 
       RowBox[{"i1", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "1"}], ",", 
         RowBox[{"i2", "\[LessEqual]", 
          RowBox[{"Length", "[", "partB", "]"}]}], ",", 
         RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "1"}], ",", 
           RowBox[{"i3", "\[LessEqual]", 
            RowBox[{"Length", "[", "partC", "]"}]}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i4", "=", "1"}], ",", 
             RowBox[{"i4", "\[LessEqual]", 
              RowBox[{"Length", "[", "partD", "]"}]}], ",", 
             RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i5", "=", "1"}], ",", 
               RowBox[{"i5", "\[LessEqual]", 
                RowBox[{"Length", "[", "partE", "]"}]}], ",", 
               RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"i6", "=", "1"}], ",", 
                 RowBox[{"i6", "\[LessEqual]", 
                  RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                 RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"i7", "=", "1"}], ",", 
                   RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                   RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}]}], "]"}]}], "   ", 
                    "\[IndentingNewLine]", "                             ", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "]"}]}], "  ", "]"}], ";", 
     "\[IndentingNewLine]", "Zpairs"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7193291556158733`*^9, 3.7193291964710093`*^9}, {
  3.71932926592747*^9, 3.719329290110972*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"562c0b89-fdc3-4ce4-b13f-ae0b6984af36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eightZpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
      "partF", ",", "partG", ",", "partH", ",", "Zpairs", ",", "i1", ",", 
      "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", ",", "i7", ",", 
      "i8"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partC", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partD", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partE", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partF", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partG", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partH", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "8", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zpairs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "1"}], ",", 
       RowBox[{"i1", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "1"}], ",", 
         RowBox[{"i2", "\[LessEqual]", 
          RowBox[{"Length", "[", "partB", "]"}]}], ",", 
         RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "1"}], ",", 
           RowBox[{"i3", "\[LessEqual]", 
            RowBox[{"Length", "[", "partC", "]"}]}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i4", "=", "1"}], ",", 
             RowBox[{"i4", "\[LessEqual]", 
              RowBox[{"Length", "[", "partD", "]"}]}], ",", 
             RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i5", "=", "1"}], ",", 
               RowBox[{"i5", "\[LessEqual]", 
                RowBox[{"Length", "[", "partE", "]"}]}], ",", 
               RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"i6", "=", "1"}], ",", 
                 RowBox[{"i6", "\[LessEqual]", 
                  RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                 RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"i7", "=", "1"}], ",", 
                   RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                   RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i8", "=", "1"}], ",", 
                    RowBox[{"i8", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partH", "]"}]}], ",", 
                    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}], ",", 
                    RowBox[{"partH", "[", 
                    RowBox[{"[", "i8", "]"}], "]"}]}], "]"}]}], "   ", 
                    "\[IndentingNewLine]", "                             ", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], "  ", "]"}]}], "  ", 
      "]"}], ";", "\[IndentingNewLine]", "Zpairs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.717986792970858*^9, 3.7179870958496513`*^9}, {
   3.71798716101019*^9, 3.7179872190318813`*^9}, 3.7179880254839478`*^9, 
   3.717995709103279*^9},
 CellLabel->
  "In[216]:=",ExpressionUUID->"077049df-bd28-481a-a156-fa6316a147d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nineZpart", "[", "part_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
      "partF", ",", "partG", ",", "partH", ",", "partI", ",", "Zpairs", ",", 
      "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", ",", "i7", 
      ",", "i8", ",", "i9"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partA", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partC", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partD", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partE", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partF", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partG", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partH", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "8", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partI", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"part", "[", 
          RowBox[{"[", "9", "]"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], ",", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"part", "[", 
          RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zpairs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "1"}], ",", 
       RowBox[{"i1", "\[LessEqual]", 
        RowBox[{"Length", "[", "partA", "]"}]}], ",", 
       RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "1"}], ",", 
         RowBox[{"i2", "\[LessEqual]", 
          RowBox[{"Length", "[", "partB", "]"}]}], ",", 
         RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "1"}], ",", 
           RowBox[{"i3", "\[LessEqual]", 
            RowBox[{"Length", "[", "partC", "]"}]}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i4", "=", "1"}], ",", 
             RowBox[{"i4", "\[LessEqual]", 
              RowBox[{"Length", "[", "partD", "]"}]}], ",", 
             RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i5", "=", "1"}], ",", 
               RowBox[{"i5", "\[LessEqual]", 
                RowBox[{"Length", "[", "partE", "]"}]}], ",", 
               RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"i6", "=", "1"}], ",", 
                 RowBox[{"i6", "\[LessEqual]", 
                  RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                 RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"i7", "=", "1"}], ",", 
                   RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                   RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i8", "=", "1"}], ",", 
                    RowBox[{"i8", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partH", "]"}]}], ",", 
                    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i9", "=", "1"}], ",", 
                    RowBox[{"i9", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partI", "]"}]}], ",", 
                    RowBox[{"i9", "++"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}], ",", 
                    RowBox[{"partH", "[", 
                    RowBox[{"[", "i8", "]"}], "]"}], ",", 
                    RowBox[{"partI", "[", 
                    RowBox[{"[", "i9", "]"}], "]"}]}], "]"}]}], "   ", 
                    "\[IndentingNewLine]", "                             ", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "  ", "]"}]}], 
      "  ", "]"}], ";", "\[IndentingNewLine]", "Zpairs"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.717986792970858*^9, 3.7179870958496513`*^9}, {
   3.71798716101019*^9, 3.7179872190318813`*^9}, 3.7179880254839478`*^9, 
   3.717995709103279*^9, {3.7225867185434837`*^9, 3.722586785715317*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"22e33c87-0cd8-4be7-94f1-2ec457e512ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tenZpart", "[", "part_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
       "partF", ",", "partG", ",", "partH", ",", "partI", ",", "partJ", ",", 
       "Zpairs", ",", "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
       "i6", ",", "i7", ",", "i8", ",", "i9", ",", "i10"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partA", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partC", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partD", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partE", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partF", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partG", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partH", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partI", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partJ", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i1", "=", "1"}], ",", 
        RowBox[{"i1", "\[LessEqual]", 
         RowBox[{"Length", "[", "partA", "]"}]}], ",", 
        RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i2", "=", "1"}], ",", 
          RowBox[{"i2", "\[LessEqual]", 
           RowBox[{"Length", "[", "partB", "]"}]}], ",", 
          RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i3", "=", "1"}], ",", 
            RowBox[{"i3", "\[LessEqual]", 
             RowBox[{"Length", "[", "partC", "]"}]}], ",", 
            RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i4", "=", "1"}], ",", 
              RowBox[{"i4", "\[LessEqual]", 
               RowBox[{"Length", "[", "partD", "]"}]}], ",", 
              RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i5", "=", "1"}], ",", 
                RowBox[{"i5", "\[LessEqual]", 
                 RowBox[{"Length", "[", "partE", "]"}]}], ",", 
                RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i6", "=", "1"}], ",", 
                  RowBox[{"i6", "\[LessEqual]", 
                   RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                  RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i7", "=", "1"}], ",", 
                    RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                    RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i8", "=", "1"}], ",", 
                    RowBox[{"i8", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partH", "]"}]}], ",", 
                    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i9", "=", "1"}], ",", 
                    RowBox[{"i9", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partI", "]"}]}], ",", 
                    RowBox[{"i9", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i10", "=", "1"}], ",", 
                    RowBox[{"i10", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partJ", "]"}]}], ",", 
                    RowBox[{"i10", "++"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}], ",", 
                    RowBox[{"partH", "[", 
                    RowBox[{"[", "i8", "]"}], "]"}], ",", 
                    RowBox[{"partI", "[", 
                    RowBox[{"[", "i9", "]"}], "]"}], ",", 
                    RowBox[{"partJ", "[", 
                    RowBox[{"[", "i10", "]"}], "]"}]}], "]"}]}], "   ", 
                    "\[IndentingNewLine]", "                             ", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
         "  ", "]"}]}], "  ", "]"}], ";", "\[IndentingNewLine]", "Zpairs"}]}],
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eleZpart", "[", "part_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
       "partF", ",", "partG", ",", "partH", ",", "partI", ",", "partJ", ",", 
       "Zpairs", ",", "part11", ",", "i1", ",", "i2", ",", "i3", ",", "i4", 
       ",", "i5", ",", "i6", ",", "i7", ",", "i8", ",", "i9", ",", "i10", ",",
        "i11"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partA", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partC", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partD", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partE", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partF", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partG", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partH", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partI", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partJ", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part11", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i1", "=", "1"}], ",", 
        RowBox[{"i1", "\[LessEqual]", 
         RowBox[{"Length", "[", "partA", "]"}]}], ",", 
        RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i2", "=", "1"}], ",", 
          RowBox[{"i2", "\[LessEqual]", 
           RowBox[{"Length", "[", "partB", "]"}]}], ",", 
          RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i3", "=", "1"}], ",", 
            RowBox[{"i3", "\[LessEqual]", 
             RowBox[{"Length", "[", "partC", "]"}]}], ",", 
            RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i4", "=", "1"}], ",", 
              RowBox[{"i4", "\[LessEqual]", 
               RowBox[{"Length", "[", "partD", "]"}]}], ",", 
              RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i5", "=", "1"}], ",", 
                RowBox[{"i5", "\[LessEqual]", 
                 RowBox[{"Length", "[", "partE", "]"}]}], ",", 
                RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i6", "=", "1"}], ",", 
                  RowBox[{"i6", "\[LessEqual]", 
                   RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                  RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i7", "=", "1"}], ",", 
                    RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                    RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i8", "=", "1"}], ",", 
                    RowBox[{"i8", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partH", "]"}]}], ",", 
                    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i9", "=", "1"}], ",", 
                    RowBox[{"i9", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partI", "]"}]}], ",", 
                    RowBox[{"i9", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i10", "=", "1"}], ",", 
                    RowBox[{"i10", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partJ", "]"}]}], ",", 
                    RowBox[{"i10", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i11", "=", "1"}], ",", 
                    RowBox[{"i11", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part11", "]"}]}], ",", 
                    RowBox[{"i11", "++"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}], ",", 
                    RowBox[{"partH", "[", 
                    RowBox[{"[", "i8", "]"}], "]"}], ",", 
                    RowBox[{"partI", "[", 
                    RowBox[{"[", "i9", "]"}], "]"}], ",", 
                    RowBox[{"partJ", "[", 
                    RowBox[{"[", "i10", "]"}], "]"}], ",", 
                    RowBox[{"part11", "[", 
                    RowBox[{"[", "i11", "]"}], "]"}]}], "]"}]}], "   ", 
                    "\[IndentingNewLine]", "                             ", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "  ", "]"}]}], "  ", "]"}], ";", "\[IndentingNewLine]", 
      "Zpairs"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"twlZpart", "[", "part_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
       "partF", ",", "partG", ",", "partH", ",", "partI", ",", "partJ", ",", 
       "Zpairs", ",", "part11", ",", "part12", ",", 
       RowBox[{"(*", 
        RowBox[{"part13", ",", "part14", ","}], "*)"}], "i1", ",", "i2", ",", 
       "i3", ",", "i4", ",", "i5", ",", "i6", ",", "i7", ",", "i8", ",", "i9",
        ",", "i10", ",", "i11", ",", "i12"}], 
      RowBox[{"(*", 
       RowBox[{
       ",", "i13", ",", "i14", ",", "part15", ",", "i15", ",", "part16", ",", 
        "i16", ",", "part17", ",", "i17", ",", "part18", ",", "i18"}], "*)"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partA", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partC", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partD", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partE", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partF", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partG", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partH", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partI", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partJ", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part11", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part12", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "12", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "12", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"part13", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "13", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "13", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part14", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "14", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "14", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part15", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "15", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "15", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part16", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "16", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "16", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part17", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "17", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "17", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part18", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "18", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "18", "]"}], "]"}], "]"}]}], "]"}]}], ";"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i1", "=", "1"}], ",", 
        RowBox[{"i1", "\[LessEqual]", 
         RowBox[{"Length", "[", "partA", "]"}]}], ",", 
        RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i2", "=", "1"}], ",", 
          RowBox[{"i2", "\[LessEqual]", 
           RowBox[{"Length", "[", "partB", "]"}]}], ",", 
          RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i3", "=", "1"}], ",", 
            RowBox[{"i3", "\[LessEqual]", 
             RowBox[{"Length", "[", "partC", "]"}]}], ",", 
            RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i4", "=", "1"}], ",", 
              RowBox[{"i4", "\[LessEqual]", 
               RowBox[{"Length", "[", "partD", "]"}]}], ",", 
              RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i5", "=", "1"}], ",", 
                RowBox[{"i5", "\[LessEqual]", 
                 RowBox[{"Length", "[", "partE", "]"}]}], ",", 
                RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i6", "=", "1"}], ",", 
                  RowBox[{"i6", "\[LessEqual]", 
                   RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                  RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i7", "=", "1"}], ",", 
                    RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                    RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i8", "=", "1"}], ",", 
                    RowBox[{"i8", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partH", "]"}]}], ",", 
                    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i9", "=", "1"}], ",", 
                    RowBox[{"i9", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partI", "]"}]}], ",", 
                    RowBox[{"i9", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i10", "=", "1"}], ",", 
                    RowBox[{"i10", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partJ", "]"}]}], ",", 
                    RowBox[{"i10", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i11", "=", "1"}], ",", 
                    RowBox[{"i11", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part11", "]"}]}], ",", 
                    RowBox[{"i11", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i12", "=", "1"}], ",", 
                    RowBox[{"i12", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part12", "]"}]}], ",", 
                    RowBox[{"i12", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i13", "=", "1"}], ",", 
                    RowBox[{"i13", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part13", "]"}]}], ",", 
                    RowBox[{"i13", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i14", "=", "1"}], ",", 
                    RowBox[{"i14", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part14", "]"}]}], ",", 
                    RowBox[{"i14", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i15", "=", "1"}], ",", 
                    RowBox[{"i15", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part15", "]"}]}], ",", 
                    RowBox[{"i15", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i16", "=", "1"}], ",", 
                    RowBox[{"i16", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part16", "]"}]}], ",", 
                    RowBox[{"i16", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i17", "=", "1"}], ",", 
                    RowBox[{"i17", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part17", "]"}]}], ",", 
                    RowBox[{"i17", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i18", "=", "1"}], ",", 
                    RowBox[{"i18", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part18", "]"}]}], ",", 
                    RowBox[{"i18", "++"}], ","}], 
                    "\[IndentingNewLine]"}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}], ",", 
                    RowBox[{"partH", "[", 
                    RowBox[{"[", "i8", "]"}], "]"}], ",", 
                    RowBox[{"partI", "[", 
                    RowBox[{"[", "i9", "]"}], "]"}], ",", 
                    RowBox[{"partJ", "[", 
                    RowBox[{"[", "i10", "]"}], "]"}], ",", 
                    RowBox[{"part11", "[", 
                    RowBox[{"[", "i11", "]"}], "]"}], ",", 
                    RowBox[{"part12", "[", 
                    RowBox[{"[", "i12", "]"}], "]"}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"part13", "[", 
                    RowBox[{"[", "i13", "]"}], "]"}], ",", 
                    RowBox[{"part14", "[", 
                    RowBox[{"[", "i14", "]"}], "]"}], ",", 
                    RowBox[{"part15", "[", 
                    RowBox[{"[", "i15", "]"}], "]"}], ",", 
                    RowBox[{"part16", "[", 
                    RowBox[{"[", "i16", "]"}], "]"}], ",", 
                    RowBox[{"part17", "[", 
                    RowBox[{"[", "i17", "]"}], "]"}], ",", 
                    RowBox[{"part18", "[", 
                    RowBox[{"[", "i18", "]"}], "]"}]}], "*)"}], "]"}]}], 
                    "   ", "\[IndentingNewLine]", 
                    "                             ", "]"}]}]}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"]", "]"}], "]"}], "]"}], "]"}], "*)"}], 
                    RowBox[{"(*", "]", "*)"}], "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "  ", "]"}]}], "  ", "]"}], ";", "\[IndentingNewLine]", 
      "Zpairs"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fourtenZpart", "[", "part_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
       "partF", ",", "partG", ",", "partH", ",", "partI", ",", "partJ", ",", 
       "Zpairs", ",", "part11", ",", "part12", ",", "part13", ",", "part14", 
       ",", "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", ",", 
       "i7", ",", "i8", ",", "i9", ",", "i10", ",", "i11", ",", "i12", ",", 
       "i13", ",", "i14"}], 
      RowBox[{"(*", 
       RowBox[{
       ",", "part15", ",", "i15", ",", "part16", ",", "i16", ",", "part17", 
        ",", "i17", ",", "part18", ",", "i18"}], "*)"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partA", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partC", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partD", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partE", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partF", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partG", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partH", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partI", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partJ", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part11", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part12", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "12", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "12", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part13", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "13", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "13", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part14", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "14", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "14", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"part15", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "15", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "15", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part16", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "16", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "16", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part17", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "17", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "17", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"part18", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"part", "[", 
             RowBox[{"[", "18", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"IntegerPartitions", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "18", "]"}], "]"}], "]"}]}], "]"}]}], ";"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i1", "=", "1"}], ",", 
        RowBox[{"i1", "\[LessEqual]", 
         RowBox[{"Length", "[", "partA", "]"}]}], ",", 
        RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i2", "=", "1"}], ",", 
          RowBox[{"i2", "\[LessEqual]", 
           RowBox[{"Length", "[", "partB", "]"}]}], ",", 
          RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i3", "=", "1"}], ",", 
            RowBox[{"i3", "\[LessEqual]", 
             RowBox[{"Length", "[", "partC", "]"}]}], ",", 
            RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i4", "=", "1"}], ",", 
              RowBox[{"i4", "\[LessEqual]", 
               RowBox[{"Length", "[", "partD", "]"}]}], ",", 
              RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i5", "=", "1"}], ",", 
                RowBox[{"i5", "\[LessEqual]", 
                 RowBox[{"Length", "[", "partE", "]"}]}], ",", 
                RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i6", "=", "1"}], ",", 
                  RowBox[{"i6", "\[LessEqual]", 
                   RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                  RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i7", "=", "1"}], ",", 
                    RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                    RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i8", "=", "1"}], ",", 
                    RowBox[{"i8", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partH", "]"}]}], ",", 
                    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i9", "=", "1"}], ",", 
                    RowBox[{"i9", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partI", "]"}]}], ",", 
                    RowBox[{"i9", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i10", "=", "1"}], ",", 
                    RowBox[{"i10", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partJ", "]"}]}], ",", 
                    RowBox[{"i10", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i11", "=", "1"}], ",", 
                    RowBox[{"i11", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part11", "]"}]}], ",", 
                    RowBox[{"i11", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i12", "=", "1"}], ",", 
                    RowBox[{"i12", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part12", "]"}]}], ",", 
                    RowBox[{"i12", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i13", "=", "1"}], ",", 
                    RowBox[{"i13", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part13", "]"}]}], ",", 
                    RowBox[{"i13", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i14", "=", "1"}], ",", 
                    RowBox[{"i14", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part14", "]"}]}], ",", 
                    RowBox[{"i14", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i15", "=", "1"}], ",", 
                    RowBox[{"i15", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part15", "]"}]}], ",", 
                    RowBox[{"i15", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i16", "=", "1"}], ",", 
                    RowBox[{"i16", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part16", "]"}]}], ",", 
                    RowBox[{"i16", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i17", "=", "1"}], ",", 
                    RowBox[{"i17", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part17", "]"}]}], ",", 
                    RowBox[{"i17", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i18", "=", "1"}], ",", 
                    RowBox[{"i18", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part18", "]"}]}], ",", 
                    RowBox[{"i18", "++"}], ","}], 
                    "\[IndentingNewLine]"}]}]}]}]}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}], ",", 
                    RowBox[{"partH", "[", 
                    RowBox[{"[", "i8", "]"}], "]"}], ",", 
                    RowBox[{"partI", "[", 
                    RowBox[{"[", "i9", "]"}], "]"}], ",", 
                    RowBox[{"partJ", "[", 
                    RowBox[{"[", "i10", "]"}], "]"}], ",", 
                    RowBox[{"part11", "[", 
                    RowBox[{"[", "i11", "]"}], "]"}], ",", 
                    RowBox[{"part12", "[", 
                    RowBox[{"[", "i12", "]"}], "]"}], ",", 
                    RowBox[{"part13", "[", 
                    RowBox[{"[", "i13", "]"}], "]"}], ",", 
                    RowBox[{"part14", "[", 
                    RowBox[{"[", "i14", "]"}], "]"}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"part15", "[", 
                    RowBox[{"[", "i15", "]"}], "]"}], ",", 
                    RowBox[{"part16", "[", 
                    RowBox[{"[", "i16", "]"}], "]"}], ",", 
                    RowBox[{"part17", "[", 
                    RowBox[{"[", "i17", "]"}], "]"}], ",", 
                    RowBox[{"part18", "[", 
                    RowBox[{"[", "i18", "]"}], "]"}]}], "*)"}], "]"}]}], 
                    "   ", "\[IndentingNewLine]", 
                    "                             ", "]"}]}]}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"]", "]"}], "]"}], "]"}], "]"}], "*)"}], 
                    RowBox[{"(*", "]", "*)"}], "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
               "]"}]}], "]"}]}], "  ", "]"}]}], " ", "]"}]}], " ", "]"}], ";",
       "\[IndentingNewLine]", "Zpairs"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eightenZpart", "[", "part_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "partA", ",", "partB", ",", "partC", ",", "partD", ",", "partE", ",", 
       "partF", ",", "partG", ",", "partH", ",", "partI", ",", "partJ", ",", 
       "Zpairs", ",", "part11", ",", "part12", ",", "part13", ",", "part14", 
       ",", "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", ",", 
       "i7", ",", "i8", ",", "i9", ",", "i10", ",", "i11", ",", "i12", ",", 
       "i13", ",", "i14", ",", "part15", ",", "i15", ",", "part16", ",", 
       "i16", ",", "part17", ",", "i17", ",", "part18", ",", "i18"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partA", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partC", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partD", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partE", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partF", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partG", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partH", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partI", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partJ", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part11", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part12", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "12", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "12", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part13", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "13", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "13", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part14", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "14", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "14", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part15", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "15", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "15", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part16", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "16", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "16", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part17", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "17", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "17", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part18", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"part", "[", 
           RowBox[{"[", "18", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"part", "[", 
           RowBox[{"[", "18", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i1", "=", "1"}], ",", 
        RowBox[{"i1", "\[LessEqual]", 
         RowBox[{"Length", "[", "partA", "]"}]}], ",", 
        RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i2", "=", "1"}], ",", 
          RowBox[{"i2", "\[LessEqual]", 
           RowBox[{"Length", "[", "partB", "]"}]}], ",", 
          RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i3", "=", "1"}], ",", 
            RowBox[{"i3", "\[LessEqual]", 
             RowBox[{"Length", "[", "partC", "]"}]}], ",", 
            RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i4", "=", "1"}], ",", 
              RowBox[{"i4", "\[LessEqual]", 
               RowBox[{"Length", "[", "partD", "]"}]}], ",", 
              RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i5", "=", "1"}], ",", 
                RowBox[{"i5", "\[LessEqual]", 
                 RowBox[{"Length", "[", "partE", "]"}]}], ",", 
                RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i6", "=", "1"}], ",", 
                  RowBox[{"i6", "\[LessEqual]", 
                   RowBox[{"Length", "[", "partF", "]"}]}], ",", 
                  RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i7", "=", "1"}], ",", 
                    RowBox[{"i7", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partG", "]"}]}], ",", 
                    RowBox[{"i7", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i8", "=", "1"}], ",", 
                    RowBox[{"i8", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partH", "]"}]}], ",", 
                    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i9", "=", "1"}], ",", 
                    RowBox[{"i9", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partI", "]"}]}], ",", 
                    RowBox[{"i9", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i10", "=", "1"}], ",", 
                    RowBox[{"i10", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partJ", "]"}]}], ",", 
                    RowBox[{"i10", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i11", "=", "1"}], ",", 
                    RowBox[{"i11", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part11", "]"}]}], ",", 
                    RowBox[{"i11", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i12", "=", "1"}], ",", 
                    RowBox[{"i12", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part12", "]"}]}], ",", 
                    RowBox[{"i12", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i13", "=", "1"}], ",", 
                    RowBox[{"i13", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part13", "]"}]}], ",", 
                    RowBox[{"i13", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i14", "=", "1"}], ",", 
                    RowBox[{"i14", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part14", "]"}]}], ",", 
                    RowBox[{"i14", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i15", "=", "1"}], ",", 
                    RowBox[{"i15", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part15", "]"}]}], ",", 
                    RowBox[{"i15", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i16", "=", "1"}], ",", 
                    RowBox[{"i16", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part16", "]"}]}], ",", 
                    RowBox[{"i16", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i17", "=", "1"}], ",", 
                    RowBox[{"i17", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part17", "]"}]}], ",", 
                    RowBox[{"i17", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i18", "=", "1"}], ",", 
                    RowBox[{"i18", "\[LessEqual]", 
                    RowBox[{"Length", "[", "part18", "]"}]}], ",", 
                    RowBox[{"i18", "++"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Zpairs", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"Zpairs", ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"partA", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", 
                    RowBox[{"partD", "[", 
                    RowBox[{"[", "i4", "]"}], "]"}], ",", 
                    RowBox[{"partE", "[", 
                    RowBox[{"[", "i5", "]"}], "]"}], ",", 
                    RowBox[{"partF", "[", 
                    RowBox[{"[", "i6", "]"}], "]"}], ",", 
                    RowBox[{"partG", "[", 
                    RowBox[{"[", "i7", "]"}], "]"}], ",", 
                    RowBox[{"partH", "[", 
                    RowBox[{"[", "i8", "]"}], "]"}], ",", 
                    RowBox[{"partI", "[", 
                    RowBox[{"[", "i9", "]"}], "]"}], ",", 
                    RowBox[{"partJ", "[", 
                    RowBox[{"[", "i10", "]"}], "]"}], ",", 
                    RowBox[{"part11", "[", 
                    RowBox[{"[", "i11", "]"}], "]"}], ",", 
                    RowBox[{"part12", "[", 
                    RowBox[{"[", "i12", "]"}], "]"}], ",", 
                    RowBox[{"part13", "[", 
                    RowBox[{"[", "i13", "]"}], "]"}], ",", 
                    RowBox[{"part14", "[", 
                    RowBox[{"[", "i14", "]"}], "]"}], ",", 
                    RowBox[{"part15", "[", 
                    RowBox[{"[", "i15", "]"}], "]"}], ",", 
                    RowBox[{"part16", "[", 
                    RowBox[{"[", "i16", "]"}], "]"}], ",", 
                    RowBox[{"part17", "[", 
                    RowBox[{"[", "i17", "]"}], "]"}], ",", 
                    RowBox[{"part18", "[", 
                    RowBox[{"[", "i18", "]"}], "]"}]}], "]"}]}], "   ", 
                    "\[IndentingNewLine]", "                             ", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
             "]"}]}], "]"}]}], "  ", "]"}]}], "  ", "]"}], ";", 
      "\[IndentingNewLine]", "Zpairs"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Add", " ", "your", " ", "definition", " ", "of", " ", "partition", " ", 
      "function", " ", "at", " ", "here"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "if", " ", "the", " ", "left", " ", "number", " ", "of", " ", "young", 
        " ", "diagram", " ", "is", " ", "not", " ", "1"}], "..."}], "10"}], 
     ",", " ", "11", ",", " ", "12", ",", " ", "14", ",", "18", ",", " ", 
     RowBox[{"following", " ", "the", " ", "above", " ", "code"}]}], "*)"}],
   FontSize->36,
   FontColor->RGBColor[1, 0, 0],
   Background->RGBColor[1, 1, 0]]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7225868141024933`*^9, 3.72258686223625*^9}, {
  3.7230068743836117`*^9, 3.723006906319482*^9}, {3.723006938068536*^9, 
  3.723007022360002*^9}, {3.723007061832233*^9, 3.723007281606749*^9}, {
  3.7230073176060343`*^9, 3.723007324130368*^9}, {3.723007653191049*^9, 
  3.723007930300653*^9}, {3.723008043381596*^9, 3.7230080659060287`*^9}, {
  3.7230300043072023`*^9, 3.723030031023978*^9}, {3.723030074396669*^9, 
  3.723030159502665*^9}, {3.7230304978407087`*^9, 3.723030551965584*^9}, {
  3.72303124863291*^9, 3.7230313036406*^9}, {3.723031516061039*^9, 
  3.723031536618325*^9}, {3.727791791331374*^9, 3.727791855638987*^9}, {
  3.7277919022901983`*^9, 3.727791958263608*^9}, {3.740108745699113*^9, 
  3.740108829176585*^9}, {3.740108952965122*^9, 3.740108962247797*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"a4b0b52b-e1b5-4827-9116-a2fbc0b3c281"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flop", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"A", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"b", ",", "a"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7039066924133453`*^9, 3.7039067341294928`*^9}, {
  3.7039067655924263`*^9, 3.703906772031652*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"c721b82f-c29c-44e7-9b58-d1698c796b6e"],

Cell["", "Text",
 CellChangeTimes->{{3.703933058948003*^9, 3.703933087672785*^9}, 
   3.703933317118762*^9},ExpressionUUID->"e691e7dd-912d-4ef4-94e9-\
3c81c7e583a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pairpartitions", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"part1", ",", "part", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"part1", "=", 
      RowBox[{"IntegerPartitions", "[", 
       RowBox[{"n", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"part", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "part1", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"part", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"part", ",", 
          RowBox[{"flop", "[", 
           RowBox[{"part1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"part1", ",", "part", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "n"}], "}"}]}], "}"}]}], "]"}], "//", 
       "DeleteDuplicates"}], "//", "Sort"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.703906828149035*^9, 3.703907100210677*^9}, {
  3.70390715028417*^9, 3.7039071858571167`*^9}, {3.703907317081585*^9, 
  3.703907319724296*^9}, {3.7039073630770884`*^9, 3.7039073723058043`*^9}, {
  3.703907461650573*^9, 3.703907474879663*^9}, {3.703907540049213*^9, 
  3.7039075414932823`*^9}, {3.703908135356551*^9, 3.703908236486546*^9}, {
  3.703908335277153*^9, 3.703908364678109*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[224]:=",ExpressionUUID->"8a1a9595-f675-44a9-945a-004362230ad1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Npletpartition", "[", 
   RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Permutations", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}], "&"}], "/@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"n", "-", 
              RowBox[{"Length", "[", "#", "]"}]}]}], "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"m", ",", "n"}], "]"}]}], ")"}]}], ")"}]}], "//", 
   "Sort"}]}]], "Input",
 CellChangeTimes->{{3.708178873235538*^9, 3.708178874770441*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[225]:=",ExpressionUUID->"aa210305-1556-4953-acec-89221d5525e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Npartitions", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"{", "n_", "}"}]}], "]"}], ":=", 
  RowBox[{"Npletpartition", "[", 
   RowBox[{"m", ",", "n"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710241886775885*^9, 3.710241893334104*^9}, {
  3.7102419332474937`*^9, 3.710241954061203*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"4344f663-f75c-4387-855b-e51a825e4dcd"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.708251597525646*^9},
 CellLabel->
  "In[227]:=",ExpressionUUID->"1648fc23-e9fc-48e0-9f89-c34e810f9937"],

Cell["All partition function", "Text",
 CellChangeTimes->{{3.703933321093999*^9, 
  3.703933334731889*^9}},ExpressionUUID->"2c81c04b-371c-44fe-a869-\
ea42a1cadd62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ztotal", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"part", ",", "Ztotalpart", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"part", "=", 
      RowBox[{
       StyleBox["Pairpartitions",
        Background->RGBColor[1, 0.9, 0.8]], "[", "n", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ztotalpart", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "part", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"Ztotalpart", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"Ztotalpart", ",", 
          RowBox[{"Total", "[", 
           RowBox[{"Zpart", "[", 
            RowBox[{"part", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Ztotalpart", "//", "PowerExpand"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.703906099512034*^9, 3.703906176072609*^9}, {
   3.703906212679989*^9, 3.703906214127522*^9}, {3.703906305168024*^9, 
   3.70390633916474*^9}, {3.703906478313952*^9, 3.703906488559061*^9}, {
   3.7039065983501673`*^9, 3.703906637396747*^9}, {3.703907569377265*^9, 
   3.703907629329961*^9}, {3.703907683432522*^9, 3.703907730879182*^9}, {
   3.7039077829207973`*^9, 3.703907801832272*^9}, {3.703907851359057*^9, 
   3.703907855218721*^9}, 3.703909450560074*^9, {3.7081786743191357`*^9, 
   3.708178720409051*^9}, {3.708246413113488*^9, 3.70824641952468*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"f36884c1-25ec-467c-a4ec-9085e95b83f4"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Zssum", "[", 
     RowBox[{"part_", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "1"}], ",", 
      RowBox[{"sigZpart", "[", "part", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "2"}], ",", 
        RowBox[{"douZpart", "[", "part", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[Equal]", "3"}], ",", 
          RowBox[{"triZpart", "[", "part", "]"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "\[Equal]", "4"}], ",", 
            RowBox[{"fouZpart", "[", "part", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "5"}], ",", 
              RowBox[{"fivZpart", "[", "part", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"n", "\[Equal]", "6"}], ",", 
                RowBox[{"sixZpart", "[", "part", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"n", "\[Equal]", "7"}], ",", 
                  RowBox[{"sevZpart", "[", "part", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"n", "\[Equal]", "8"}], ",", 
                    RowBox[{"eightZpart", "[", "part", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "9"}], ",", 
                    RowBox[{"nineZpart", "[", "part", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "10"}], ",", 
                    RowBox[{"tenZpart", "[", "part", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "11"}], ",", 
                    RowBox[{"eleZpart", "[", "part", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "12"}], ",", 
                    RowBox[{"twlZpart", "[", "part", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "14"}], ",", 
                    RowBox[{"fourtenZpart", "[", "part", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "18"}], ",", 
                    RowBox[{"eightenZpart", "[", "part", "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], "]"}]}],
                     "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"insert", " ", "YOUR", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "**"}], ",", 
        RowBox[{
         RowBox[{"**", 
          RowBox[{"Zpart", "[", "part", "]"}]}], " ", "in", " ", "the", " ", 
         "above", " ", "code"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "if", " ", "the", " ", "left", " ", "number", " ", "of", " ", 
           "young", " ", "diagram", " ", "is", " ", "not", " ", "1"}], 
          "..."}], "10"}], ",", " ", "11", ",", " ", "12", ",", " ", "14", 
        ",", "18"}], " "}]}], "*)"}],
    FontSize->36,
    FontColor->RGBColor[1, 0, 0],
    Background->RGBColor[1, 1, 0]], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "example"}], ",", " ", 
     RowBox[{"Zssum", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "0"}], "}"}], ",", "3"}], "]"}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.708250823305127*^9, 3.708250902329163*^9}, {
   3.708251993489214*^9, 3.708251995930401*^9}, {3.708682442020645*^9, 
   3.7086825096250067`*^9}, 3.7104288744727297`*^9, {3.7136036917966423`*^9, 
   3.713603723464587*^9}, {3.717986744215859*^9, 3.7179867542344017`*^9}, 
   3.717987269874683*^9, 3.717987602665022*^9, {3.7193290255958967`*^9, 
   3.7193290500143557`*^9}, {3.7193292110985107`*^9, 
   3.7193292131963253`*^9}, {3.722586656684331*^9, 3.722586695094079*^9}, {
   3.723006836788026*^9, 3.72300686206038*^9}, {3.7230299766806803`*^9, 
   3.7230299915063143`*^9}, {3.723030464901558*^9, 3.723030479636937*^9}, {
   3.727792004412713*^9, 3.727792026016411*^9}, {3.740108883787525*^9, 
   3.740108895502245*^9}, {3.740108967904709*^9, 3.7401090499701223`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"56b28101-713d-40eb-8c90-36e8dbdf2490"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NpletZtotal", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"{", "n_", "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part", ",", "Ztotalpart", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      StyleBox[
       RowBox[{"part", "=", 
        RowBox[{"Npletpartition", "[", 
         RowBox[{"m", ",", "n"}], "]"}]}],
       Background->RGBColor[0.94, 0.88, 0.94]], 
      StyleBox[";",
       Background->RGBColor[0.94, 0.88, 0.94]], 
      StyleBox["\[IndentingNewLine]",
       Background->RGBColor[0.94, 0.88, 0.94]], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"for", " ", "example"}], ",", 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.94, 0.88, 0.94]], 
        RowBox[{
         RowBox[{"Npletpartition", "[", 
          RowBox[{"4", ",", "3"}], "]"}], "=", "\n", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "4", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Ztotalpart", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "part", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"Ztotalpart", "=", "\[IndentingNewLine]", 
         RowBox[{"Append", "[", 
          RowBox[{"Ztotalpart", ",", 
           RowBox[{"Total", "[", 
            RowBox[{"Zssum", "[", 
             RowBox[{
              RowBox[{"part", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "n"}], "]"}], "]"}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ztotalpart", 
       StyleBox["//",
        Background->RGBColor[1, 0.85, 0.85]], 
       StyleBox["PowerExpand",
        Background->RGBColor[1, 0.85, 0.85]]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.708178723583383*^9, 3.708178759184286*^9}, {
   3.7081789427441187`*^9, 3.708179038884055*^9}, {3.7081790836185713`*^9, 
   3.708179388140594*^9}, {3.708179519885826*^9, 3.7081795657910624`*^9}, {
   3.708246424592126*^9, 3.708246428385406*^9}, {3.708249966993095*^9, 
   3.708249977692827*^9}, {3.708250015389337*^9, 3.70825008000815*^9}, {
   3.708250112120146*^9, 3.708250175392712*^9}, {3.708250343695633*^9, 
   3.708250402717667*^9}, {3.708250517810741*^9, 3.708250543761951*^9}, {
   3.708250696548286*^9, 3.7082507063824463`*^9}, {3.708250909373707*^9, 
   3.708250994046113*^9}, 3.708251033493293*^9, {3.708251523547612*^9, 
   3.708251528698194*^9}, 3.710428878444358*^9, {3.713603610921474*^9, 
   3.713603656907267*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[230]:=",ExpressionUUID->"2611fc29-1ea4-4ee1-adc9-60d82e66e5e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Zsum", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"{", "n_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"sum", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "\[LessEqual]", "m"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"sum", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"NpletZtotal", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", "n", "}"}]}], "]"}], "//", "Total"}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "sum"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.710058963077221*^9, 3.710059194737558*^9}, {
  3.71005965527635*^9, 3.7100596557819147`*^9}},
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[231]:=",ExpressionUUID->"0caa264d-8255-4552-a057-b70e135bc4df"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NpletsumZtotal", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"{", "n_", "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part", ",", "Ztotalpart", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      StyleBox[
       RowBox[{"part", "=", 
        RowBox[{"Npletpartition", "[", 
         RowBox[{"m", ",", "n"}], "]"}]}],
       Background->RGBColor[0.94, 0.88, 0.94]], 
      StyleBox[";",
       Background->RGBColor[0.94, 0.88, 0.94]], 
      StyleBox["\[IndentingNewLine]",
       Background->RGBColor[0.94, 0.88, 0.94]], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"for", " ", "example"}], ",", 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.94, 0.88, 0.94]], 
        RowBox[{
         RowBox[{"Npletpartition", "[", 
          RowBox[{"4", ",", "3"}], "]"}], "=", "\n", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "4", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Ztotalpart", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "part", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"Ztotalpart", "=", "\[IndentingNewLine]", 
         RowBox[{"Append", "[", 
          RowBox[{"Ztotalpart", ",", 
           RowBox[{"(*", 
            RowBox[{"Total", "["}], "*)"}], 
           RowBox[{
            RowBox[{"Zssum", "[", 
             RowBox[{
              RowBox[{"part", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "n"}], "]"}], "//", 
            "Flatten"}]}], 
          RowBox[{"(*", "]", "*)"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", "Ztotalpart", 
        StyleBox["]",
         Background->RGBColor[1, 0.85, 0.85]]}], 
       StyleBox["//",
        Background->RGBColor[1, 0.85, 0.85]], 
       StyleBox["PowerExpand",
        Background->RGBColor[1, 0.85, 0.85]]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.708178723583383*^9, 3.708178759184286*^9}, {
   3.7081789427441187`*^9, 3.708179038884055*^9}, {3.7081790836185713`*^9, 
   3.708179388140594*^9}, {3.708179519885826*^9, 3.7081795657910624`*^9}, {
   3.708246424592126*^9, 3.708246428385406*^9}, {3.708249966993095*^9, 
   3.708249977692827*^9}, {3.708250015389337*^9, 3.70825008000815*^9}, {
   3.708250112120146*^9, 3.708250175392712*^9}, {3.708250343695633*^9, 
   3.708250402717667*^9}, {3.708250517810741*^9, 3.708250543761951*^9}, {
   3.708250696548286*^9, 3.7082507063824463`*^9}, {3.708250909373707*^9, 
   3.708250994046113*^9}, 3.708251033493293*^9, {3.708251523547612*^9, 
   3.708251528698194*^9}, 3.710428878444358*^9, {3.713603610921474*^9, 
   3.713603656907267*^9}, {3.722871502723392*^9, 3.722871503247157*^9}, {
   3.722871549552332*^9, 3.722871622777216*^9}, 3.722871680602583*^9},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[232]:=",ExpressionUUID->"42f8ae92-d271-4857-b84b-0ff60885e154"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Zsumsum", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"{", "n_", "}"}]}], "]"}],
   Background->RGBColor[1, 0.85, 0.85]], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"sum", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "\[LessEqual]", "m"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"sum", ",", 
          RowBox[{"(", 
           RowBox[{"NpletsumZtotal", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", "n", "}"}]}], "]"}], 
           RowBox[{"(*", 
            RowBox[{"//", "Total"}], "*)"}], ")"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sum", "//", "Flatten"}], "//", "PowerExpand"}], ")"}]}]}], 
   RowBox[{"(*", 
    RowBox[{"//", "Total"}], "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.718772149513999*^9, 3.718772201424185*^9}, 
   3.718772246776506*^9, {3.718772289540475*^9, 3.718772292039262*^9}, 
   3.722871745940905*^9, {3.722871778388466*^9, 3.7228717789230623`*^9}, {
   3.728050432584594*^9, 3.728050435316086*^9}, {3.728050466813281*^9, 
   3.7280504692148333`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"9c77a754-2341-476b-962e-b8a15d1e00fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Others and M[Q, t, q]", "Subsubsection",
 CellChangeTimes->{{3.703989504441169*^9, 3.7039895054810553`*^9}, {
  3.708683584698598*^9, 
  3.708683591402791*^9}},ExpressionUUID->"c7bfacfd-08e4-42d8-aef6-\
74e6aa83a162"],

Cell[BoxData[
 RowBox[{
  RowBox[{"framingnum", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c_", ",", "d_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "B", ",", "sign"}], "}"}], ",", 
    RowBox[{
     RowBox[{"A", "=", 
      RowBox[{
       RowBox[{"a", " ", "d"}], "-", 
       RowBox[{"b", " ", "c"}]}]}], ";", 
     RowBox[{"B", "=", 
      RowBox[{
       RowBox[{"a", " ", "c"}], "+", 
       RowBox[{"b", " ", "d"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"B", "/", 
       RowBox[{"Abs", "[", "B", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"A", ",", "sign"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.703989510991996*^9, 3.703989634884222*^9}, {
  3.703989672212957*^9, 3.703989746822654*^9}, {3.7039897861151667`*^9, 
  3.7039899254378757`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"dd0213b3-60c6-4be1-9696-c313736fbe37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delqt", "[", 
   RowBox[{"V_", ",", "ss_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rr", ",", "Li", ",", "K", ",", "r"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rr", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"ss", " ", 
       RowBox[{"Log", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Li", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"V", ",", "K"}], "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"r", "=", "1"}], ",", 
       RowBox[{"r", "\[LessEqual]", 
        RowBox[{"Length", "[", "Li", "]"}]}], ",", 
       RowBox[{"r", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumericQ", "[", 
          RowBox[{"Li", "[", 
           RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
         RowBox[{"rr", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"rr", ",", 
            RowBox[{"Li", "[", 
             RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"VV", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"V", ",", 
        RowBox[{
         RowBox[{"Total", "[", "rr", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "ss"}], " ", 
            RowBox[{"Log", "[", "x", "]"}]}], "+", 
           RowBox[{"Log", "[", "x", "]"}]}], ")"}]}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deleij", "[", "V_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "VVV", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"VVV", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"delqt", "[", 
        RowBox[{
         RowBox[{"delqt", "[", 
          RowBox[{
           RowBox[{"delqt", "[", 
            RowBox[{
             RowBox[{"delqt", "[", 
              RowBox[{"V", ",", "i", ",", "q"}], "]"}], ",", "i", ",", "t"}], 
            "]"}], ",", "j", ",", "q"}], "]"}], ",", "j", ",", "t"}], "]"}], 
       ",", "0"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normalprod", "[", "PP_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"V", ",", "VV", ",", "X", ",", "Y"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"PP", "//", "APART"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"i", " ", "p"}], "\[Rule]", 
            SubscriptBox["p", "i"]}], ",", 
           RowBox[{
            RowBox[{"j", " ", "p"}], "\[Rule]", 
            SubscriptBox["p", "j"]}]}], "}"}]}], ")"}], "//", 
       "logexpressionQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"VV", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"deleij", "[", "V", "]"}], "//", "Total"}], "//", 
           "Expand"}], "//", "Exp"}], "//", "Cancel"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["p", "i"], "\[Rule]", 
          RowBox[{
           FractionBox["1", "2"], "-", "i"}]}], ",", 
         RowBox[{
          SubscriptBox["p", "j"], "\[Rule]", 
          RowBox[{
           FractionBox["1", "2"], "-", "j"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{"VV", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"q", "\[Rule]", "1"}], ",", 
         RowBox[{"t", "\[Rule]", "1"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Y", "=", 
      RowBox[{"X", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "i"}], "+", "1"}]}], ",", 
         RowBox[{"j", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "j"}], "+", "1"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"VV", " ", "Y"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7043592943045273`*^9, 3.704359294557428*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"533652da-bb79-49cf-89e3-4a571e2734c6"],

Cell[TextData[{
 "Note: the following M[Q, t, q] is the M[Q, t, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"q", "]"}], 
     RowBox[{"-", "1"}]], " ", "in", " ", "literature"}], TraditionalForm]],
  ExpressionUUID->"48be37c8-e5dc-40d4-ac4c-a84c7bb2229c"]
}], "Text",
 CellChangeTimes->{{3.708686996444778*^9, 
  3.708687051534112*^9}},ExpressionUUID->"6309337a-5e17-47d2-b33f-\
1b6a52861d3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_", ",", "N_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{"n", "/", "2"}]], " ", 
        SuperscriptBox["Q", "n"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["q", "t"], ")"}], 
         RowBox[{"n", "/", "2"}]], " ", 
        SuperscriptBox["t", 
         RowBox[{"n", "/", "2"}]]}], 
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "n"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["t", "n"]}], ")"}]}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "N"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"M", "[", 
    RowBox[{"Q", ",", "t", ",", "q", ",", "10"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SM", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SeriM", "[", 
    RowBox[{"Q", ",", "t", ",", "q", ",", "10", ",", "5"}], "]"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.704534848288994*^9, 3.704534879795676*^9}, {
   3.704534971912663*^9, 3.704534979640917*^9}, {3.704535015327594*^9, 
   3.704535223443595*^9}, {3.7045352617997704`*^9, 3.704535346653226*^9}, {
   3.704535408668137*^9, 3.70453543271059*^9}, {3.704535663555943*^9, 
   3.704535671616918*^9}, {3.704535769655384*^9, 3.704535785199718*^9}, {
   3.7045358319512863`*^9, 3.7045358347149963`*^9}, 3.70868697794592*^9, {
   3.710503749211694*^9, 3.710503779317219*^9}, {3.710503889752146*^9, 
   3.710503945106688*^9}, {3.710503975954793*^9, 3.710503976966421*^9}, 
   3.710504123831935*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[238]:=",ExpressionUUID->"523e5263-1b94-4491-b523-6a2485b55c47"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.710503885847816*^9, 3.71050388797439*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"d8d0e5ab-ef64-4f33-9623-72f5a282808b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeriM", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_", ",", "Nsum_", ",", "Nseri_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"M", "[", 
      RowBox[{"Q", ",", "t", ",", "q", ",", "Nsum"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q", ",", "0", ",", "Nseri"}], "}"}]}], "]"}], "//", 
   "PowerExpand", 
   RowBox[{"(*", 
    RowBox[{"//", "Simplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.704535837310204*^9, 3.704535894526268*^9}, {
   3.704550773683202*^9, 3.704550774302231*^9}, {3.708683985311274*^9, 
   3.7086839859520493`*^9}, {3.708684020313856*^9, 3.708684020822206*^9}, {
   3.7104989235317163`*^9, 3.710498924006469*^9}, 3.710504055409479*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[242]:=",ExpressionUUID->"9450b70a-e2ec-4981-9715-eae5ddb0d62d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Seri", "[", 
   RowBox[{"A_", ",", "u_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"A", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "0", ",", "n"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]], "Input",
 CellChangeTimes->{{3.7047236818359632`*^9, 3.704723711830372*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"f3a39ea1-fc1f-412e-b25d-581db29828c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rM10", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"M", "[", 
   RowBox[{"Q", ",", "t", ",", "q", ",", "10"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runM10", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"{", 
    RowBox[{"MM", "\[Rule]", "rM10"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rM5", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"M", "[", 
   RowBox[{"Q", ",", "t", ",", "q", ",", "5"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runM5", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"{", 
    RowBox[{"MM", "\[Rule]", "rM5"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rM15", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"M", "[", 
   RowBox[{"Q", ",", "t", ",", "q", ",", "15"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runM15", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"{", 
    RowBox[{"MM", "\[Rule]", "rM15"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.727754557156299*^9, 3.727754569303115*^9}},
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[244]:=",ExpressionUUID->"6f12e30b-40e0-4b89-bee9-47bc8c5bba4b"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Along with LieArt, character:      ",
 Cell[BoxData[
  FormBox[
   RowBox[{"                            ", 
    RowBox[{
     RowBox[{"\[Chi]", "[", "y", "]"}], "=", 
     RowBox[{"y", "+", "1", "+", 
      FractionBox["1", "y"]}]}]}], TraditionalForm]],ExpressionUUID->
  "e42aa700-e109-40c2-963d-1ce5e36232a9"]
}], "Subsubsection",
 CellChangeTimes->{{3.71539949283272*^9, 3.715399504249155*^9}, {
  3.717410684903591*^9, 3.717410685654395*^9}, {3.740127907273435*^9, 
  3.740127939613858*^9}, {3.740128054527845*^9, 
  3.740128057213229*^9}},ExpressionUUID->"0f137fdb-8857-4067-b77f-\
e843e5587af9"],

Cell["\<\
To write the expansion of partition function in terms of characters of \
groups, we need work with LieArt.\
\>", "Text",
 CellChangeTimes->{{3.717229678596717*^9, 
  3.717229736962544*^9}},ExpressionUUID->"7cf00b3f-1346-45ae-adad-\
0e82f9abaf34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListProduct", "[", "arry_", "]"}], ":=", 
  RowBox[{"Times", "@@", "arry"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableProduct", "[", "table_", "]"}], ":=", 
  RowBox[{"Times", "@@@", "table"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TotalProduct", "[", "A_", "]"}], ":=", 
   RowBox[{"ListProduct", "[", 
    RowBox[{"TableProduct", "[", "A", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringTo", "[", "eeq_", "]"}], ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<,\>\"", ",", "\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], 
        "]"}], "&"}], ",", "eeq"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"distribute", "[", "arry_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"N", ",", "NN", ",", 
       RowBox[{"Arry", "=", "arry"}], ",", 
       RowBox[{"ele", "=", "1"}], ",", "Y", ",", "i", ",", "j", ",", "ii"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N", "=", 
       RowBox[{
        RowBox[{"arry", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NN", "=", 
       RowBox[{"Length", "[", "arry", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Y", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<y\>\"", "<>", 
           RowBox[{"ToString", "@", "ii"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "N"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "NN"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "N"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Arry", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           SuperscriptBox[
            RowBox[{"Y", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{
             RowBox[{"arry", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Times", "@@@", "Arry"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"StringToyi", "[", "pp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"distribute", "[", 
     RowBox[{"pp", "//", "StringTo"}], "]"}], "//", "Total"}]}],
  FontColor->GrayLevel[0],
  Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringToyi", "::", "usage"}], "=", 
   "\"\<turn the output in LieArt into character\n\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.715399512506854*^9, 3.715399519457282*^9}, {
   3.715401994975958*^9, 3.71540209227146*^9}, {3.7154021596445723`*^9, 
   3.715402189610879*^9}, 3.715402222100861*^9, {3.715402428099141*^9, 
   3.715402454665007*^9}, {3.7401122901433477`*^9, 3.740112421879388*^9}, {
   3.740112487973014*^9, 3.7401124924369926`*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"fbefb1a1-a637-4b7e-b909-e48eff3e4008"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Splitplus", "[", "xx_", "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xx", "//", "ToString"}], ")"}], "//", "StringSplit"}], ",", 
      "\"\<+\>\""}], "]"}], "//", "ToExpression"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N", "=", 
       RowBox[{"Length", "[", "xx", "]"}]}], ",", " ", "i", ",", 
      RowBox[{"arry", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "N"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arry", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"arry", ",", 
          RowBox[{"xx", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "arry"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.728862896603669*^9, 3.728862912344117*^9}, {
   3.7288631066343412`*^9, 3.728863107478175*^9}, 3.728863597993849*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"c3e1c8f5-a70b-4cb3-839b-f8157e389d60"]
}, Closed]],

Cell[CellGroupData[{

Cell["Flop", "Subsubsection",
 CellChangeTimes->{{3.719728217775942*^9, 
  3.7197282184496737`*^9}},ExpressionUUID->"7cf6b7ff-2172-4644-9250-\
e8a50c366703"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"flopMM", "[", 
   RowBox[{"Q_", ",", "t_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"MM", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Q", 
      RowBox[{"-", "1"}]], 
     FractionBox["t", "q"]}], ",", "t", ",", "q"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flopM", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"{", 
    RowBox[{"MM", "\[Rule]", " ", "flopMM"}], 
    "}"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.719728223741393*^9, 3.719728239681796*^9}, {
   3.719728269952436*^9, 3.7197282844778748`*^9}, {3.719728323914445*^9, 
   3.7197284126816893`*^9}, {3.719728469699481*^9, 3.7197284701817837`*^9}, {
   3.719728644438218*^9, 3.719728644639144*^9}, 3.740112183010766*^9},
 CellLabel->
  "In[258]:=",ExpressionUUID->"71545a9d-741d-4483-8e89-1eb88b470688"]
}, Closed]],

Cell[CellGroupData[{

Cell["identity", "Subsubsection",
 CellChangeTimes->{{3.740113867416095*^9, 
  3.740113869089642*^9}},ExpressionUUID->"eef0be72-1ea2-4b12-8252-\
5e50fc98e936"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"identity", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"NNN\[Alpha]\[Beta]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Nu]2", ",", "\[Nu]2"}], "}"}], ",", 
         FractionBox["t", "q"], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "t"], ",", 
           FractionBox["1", "q"]}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "\[Nu]2"], 
        SuperscriptBox["q", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"T", " ", 
            SuperscriptBox["\[Nu]2", "2"]}], "2"]}]], " ", 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["\[Nu]2", "2"], "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["t", "q"], ")"}], 
         RowBox[{"\[Nu]2", "/", "2"}]], 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["Z", "\[Nu]2"], "[", 
          RowBox[{"t", ",", "q"}], "]"}], 
         RowBox[{"-", "1"}]], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["Z", 
           SuperscriptBox["\[Nu]2", "T"]], "[", 
          RowBox[{"q", ",", "t"}], "]"}], 
         RowBox[{"-", "1"}]]}]}], ",", 
      RowBox[{
       RowBox[{"NNN\[Alpha]\[Beta]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RT", "[", "\[Nu]1", "]"}], ",", 
           RowBox[{"RT", "[", "\[Nu]1", "]"}]}], "}"}], ",", 
         FractionBox["t", "q"], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "t"], ",", 
           FractionBox["1", "q"]}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "\[Nu]1"], 
        SuperscriptBox["q", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{" ", 
            SuperscriptBox["\[Nu]1", "2"]}], "2"]}]], " ", 
        SuperscriptBox["t", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"T", " ", 
            SuperscriptBox["\[Nu]1", "2"]}], "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["t", "q"], ")"}], 
         RowBox[{"\[Nu]1", "/", "2"}]], 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["Z", "\[Nu]1"], "[", 
          RowBox[{"q", ",", "t"}], "]"}], 
         RowBox[{"-", "1"}]], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["Z", 
           SuperscriptBox["\[Nu]1", "T"]], "[", 
          RowBox[{"t", ",", "q"}], "]"}], 
         RowBox[{"-", "1"}]]}]}], ",", 
      RowBox[{
       RowBox[{"NNN\[Alpha]\[Beta]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Nu]2", ",", "\[Nu]2"}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "t"], ",", 
           FractionBox["1", "q"]}], "}"}]}], "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "\[Nu]2"], " ", 
         SuperscriptBox["q", 
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox["\[Nu]2", "2"], "2"]}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["q", "t"], ")"}], 
          RowBox[{"\[Nu]2", "/", "2"}]], " ", 
         SuperscriptBox["t", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"T", " ", 
             SuperscriptBox["\[Nu]2", "2"]}], "2"]}]]}], 
        RowBox[{
         RowBox[{
          SubscriptBox["Z", "\[Nu]2"], "[", 
          RowBox[{"t", ",", "q"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["Z", 
           SuperscriptBox["\[Nu]2", "T"]], "[", 
          RowBox[{"q", ",", "t"}], "]"}]}]]}], ",", 
      RowBox[{
       RowBox[{"NNN\[Alpha]\[Beta]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RT", "[", "\[Nu]1", "]"}], ",", 
           RowBox[{"RT", "[", "\[Nu]1", "]"}]}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "t"], ",", 
           FractionBox["1", "q"]}], "}"}]}], "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "\[Nu]1"], " ", 
         SuperscriptBox["q", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"T", " ", 
             SuperscriptBox["\[Nu]1", "2"]}], "2"]}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["q", "t"], ")"}], 
          RowBox[{"\[Nu]1", "/", "2"}]], " ", 
         SuperscriptBox["t", 
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox["\[Nu]1", "2"], "2"]}]]}], 
        RowBox[{
         RowBox[{
          SubscriptBox["Z", "\[Nu]1"], "[", 
          RowBox[{"q", ",", "t"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["Z", 
           SuperscriptBox["\[Nu]1", "T"]], "[", 
          RowBox[{"t", ",", "q"}], "]"}]}]]}]}], "}"}]}], ";"}],
  Background->RGBColor[0.94, 0.91, 0.88]]], "Input",
 CellChangeTimes->{{3.739848354742878*^9, 3.7398483934402733`*^9}, {
   3.739849059183528*^9, 3.73984906144981*^9}, 3.739851469245206*^9},
 CellLabel->
  "In[260]:=",ExpressionUUID->"37b7670a-f878-4a3b-a876-a5601c563e9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"identity", "::", "usage"}], " ", "=", 
   "\"\< It is identities: \n    \!\(\*SubscriptBox[\(N\), \(\[Nu]2\\\ \[Nu]2\
\)]\)[1,\!\(\*SuperscriptBox[\(t\), \(-1\)]\),\!\(\*SuperscriptBox[\(q\), \
\(-1\)]\)]\[Rule]\!\(\*FractionBox[\(\*SuperscriptBox[\((\(-1\))\), \(\(|\)\(\
\[Nu]2\)\(|\)\)]\\\ \*SuperscriptBox[\(q\), \(-\*FractionBox[\(\(||\)\(\[Nu]2\
\)\*SuperscriptBox[\(||\), \(2\)]\), \(2\)]\)]\\\ \
\*SuperscriptBox[\((\*FractionBox[\(q\), \(t\)])\), \
\(\(|\)\(\[Nu]2\)\(|\)\(\(/\)\(2\)\)\)]\\\ \*SuperscriptBox[\(t\), \
\(-\*FractionBox[\(\(||\)\(\\\ \)\*SuperscriptBox[\(\[Nu]2\), \
\(T\)]\*SuperscriptBox[\(||\), \(2\)]\), \(2\)]\)]\), \
\(\(\*SubscriptBox[\(Z\), \(\[Nu]2\)]\)[t, q]\\\ \(\*SubscriptBox[\(Z\), \
SuperscriptBox[\(\[Nu]2\), \(T\)]]\)[q, t]\)]\), and   \!\(\*SubscriptBox[\(N\
\), \(\*SuperscriptBox[\(\[Nu]1\), \(T\)] \*SuperscriptBox[\(\[Nu]1\), \(T\)]\
\)]\)[1,\!\(\*SuperscriptBox[\(t\), \(-1\)]\),\!\(\*SuperscriptBox[\(q\), \
\(-1\)]\)]\[Rule]\!\(\*FractionBox[\(\*SuperscriptBox[\((\(-1\))\), \
\(\[Nu]1\)]\\\ \*SuperscriptBox[\(q\), \
\(-\*FractionBox[\(\(||\)\*SuperscriptBox[\(\[Nu]1\), \(T\)]\*SuperscriptBox[\
\(||\), \(2\)]\), \(2\)]\)]\\\ \*SuperscriptBox[\((\*FractionBox[\(q\), \
\(t\)])\), \(\(|\)\(\[Nu]1\)\(|\)\(\(/\)\(2\)\)\)]\\\ \*SuperscriptBox[\(t\), \
\(-\*FractionBox[\(\(||\)\(\[Nu]1\)\*SuperscriptBox[\(||\), \(2\)]\), \
\(2\)]\)]\), \(\(\*SubscriptBox[\(Z\), \(\[Nu]1\)]\)[q, t]\\\ \
\(\*SubscriptBox[\(Z\), SuperscriptBox[\(\[Nu]1\), \(T\)]]\)[t, q]\)]\) . \
\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.740105162887259*^9, 3.740105429293397*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"b94fff76-2e15-4624-a961-ba8eed755517"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Localization", "Subsection",
 CellChangeTimes->{{3.725944849263032*^9, 
  3.72594485156256*^9}},ExpressionUUID->"82d8fdaf-c6f6-4287-87ae-\
85d6374d74e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ShII", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"]], "-", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", "+", "b"}], "2"]}]]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{"a", "-", "b"}], "2"]], "-", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", "-", "b"}], "2"]}]]}], ")"}]}], "//", "PowerExpand"}],
     "//", "Expand"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShI", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"]], "-", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", "+", "b"}], "2"]}]]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "a"}], "+", "b"}], "2"]], "-", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "a"}], "+", "b"}], "2"]}]]}], ")"}]}], "//", 
     "PowerExpand"}], "//", "Expand"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChII", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"]], "+", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", "+", "b"}], "2"]}]]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{"a", "-", "b"}], "2"]], "+", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", "-", "b"}], "2"]}]]}], ")"}]}], "//", "PowerExpand"}],
     "//", "Expand"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChI", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"]], "+", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", "+", "b"}], "2"]}]]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "a"}], "+", "b"}], "2"]], "+", 
        SuperscriptBox["e", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "a"}], "+", "b"}], "2"]}]]}], ")"}]}], "//", 
     "PowerExpand"}], "//", "Expand"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "[", "m_", "]"}], ":=", 
   RowBox[{
    SuperscriptBox["e", 
     FractionBox["m", "2"]], "-", 
    SuperscriptBox["e", 
     RowBox[{"-", 
      FractionBox["m", "2"]}]]}]}], 
  RowBox[{"(*", 
   RowBox[{"//", "PowerExpand"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", "Expand"}], "//", "Simplify"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ch", "[", "m_", "]"}], ":=", 
   RowBox[{
    SuperscriptBox["e", 
     FractionBox["m", "2"]], "+", 
    SuperscriptBox["e", 
     RowBox[{"-", 
      FractionBox["m", "2"]}]]}]}], 
  RowBox[{"(*", 
   RowBox[{"//", "PowerExpand"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", "Expand"}], "//", "Simplify"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["e", 
       SubscriptBox["\[Epsilon]", "+"]], "\[Rule]", 
      SqrtBox[
       FractionBox["t", "q"]]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", 
        SubscriptBox["\[Epsilon]", "+"]}]], "\[Rule]", 
      SqrtBox[
       FractionBox["q", "t"]]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       SubscriptBox["\[Epsilon]", "-"]], "\[Rule]", 
      SqrtBox[
       RowBox[{"t", " ", "q"}]]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", 
        SubscriptBox["\[Epsilon]", "-"]}]], "\[Rule]", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{"t", " ", "q"}]]]}], ",", 
     RowBox[{
      SuperscriptBox["e", "\[Alpha]"], "\[Rule]", "A"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "\[Alpha]"}]], "\[Rule]", 
      FractionBox["1", "A"]}], ",", 
     RowBox[{
      SuperscriptBox["e", "\[Alpha]1"], "\[Rule]", "A1"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "\[Alpha]1"}]], "\[Rule]", 
      FractionBox["1", "A1"]}], ",", 
     RowBox[{
      SuperscriptBox["e", "\[Alpha]2"], "\[Rule]", "A2"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "\[Alpha]2"}]], "\[Rule]", 
      FractionBox["1", "A2"]}], ",", 
     RowBox[{
      SuperscriptBox["e", "\[Alpha]3"], "\[Rule]", "A3"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "\[Alpha]3"}]], "\[Rule]", 
      FractionBox["1", "A3"]}], ",", 
     RowBox[{
      SuperscriptBox["e", "m"], "\[Rule]", "y"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "m"}]], "\[Rule]", 
      FractionBox["1", "y"]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       FractionBox["m1", "2"]], "\[Rule]", 
      SqrtBox["y1"]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", 
        FractionBox["m1", "2"]}]], "\[Rule]", 
      FractionBox["1", 
       SqrtBox["y1"]]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       FractionBox["m2", "2"]], "\[Rule]", 
      SqrtBox["y2"]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", 
        FractionBox["m2", "2"]}]], "\[Rule]", 
      FractionBox["1", 
       SqrtBox["y2"]]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       FractionBox["m3", "2"]], "\[Rule]", 
      SqrtBox["y3"]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", 
        FractionBox["m3", "2"]}]], "\[Rule]", 
      FractionBox["1", 
       SqrtBox["y3"]]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       FractionBox["m4", "2"]], "\[Rule]", 
      SqrtBox["y4"]}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", 
        FractionBox["m4", "2"]}]], "\[Rule]", 
      FractionBox["1", 
       SqrtBox["y4"]]}], ",", 
     RowBox[{
      SuperscriptBox["e", "m1"], "\[Rule]", "y1"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "m1"}]], "\[Rule]", 
      FractionBox["1", "y1"]}], ",", 
     RowBox[{
      SuperscriptBox["e", "m2"], "\[Rule]", "y2"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "m2"}]], "\[Rule]", 
      FractionBox["1", "y2"]}], ",", 
     RowBox[{
      SuperscriptBox["e", "m3"], "\[Rule]", "y3"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "m3"}]], "\[Rule]", 
      FractionBox["1", "y3"]}], ",", 
     RowBox[{
      SuperscriptBox["e", "m4"], "\[Rule]", "y4"}], ",", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"-", "m4"}]], "\[Rule]", 
      FractionBox["1", "y4"]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.725941458716524*^9, 3.725941511118617*^9}, {
   3.725941562104653*^9, 3.72594161927993*^9}, {3.725941657962088*^9, 
   3.725941658128306*^9}, 3.725941781284289*^9, {3.725941928582518*^9, 
   3.725941952903126*^9}, {3.725942076611744*^9, 3.7259421108119917`*^9}, {
   3.725942212321659*^9, 3.725942221959887*^9}, {3.725942386188616*^9, 
   3.725942416259989*^9}, 3.7259429329455357`*^9, {3.725943040775607*^9, 
   3.725943091546172*^9}, {3.726303559871871*^9, 3.726303686740058*^9}, {
   3.726305597816002*^9, 3.7263056613498163`*^9}, {3.726305760971888*^9, 
   3.726305830982153*^9}, {3.726931538763142*^9, 3.726931566815309*^9}, {
   3.72822619671868*^9, 3.728226221157157*^9}, {3.729329607172464*^9, 
   3.729329620837068*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"66670448-d337-426c-8735-4862a86be3b4"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.7264141551853037`*^9},
 CellLabel->
  "In[269]:=",ExpressionUUID->"ae93b09c-5b10-437b-a937-5f6307e8756b"]
}, Closed]],

Cell[CellGroupData[{

Cell["arrow round shur, compact", "Subsection",
 CellChangeTimes->{{3.756966807337377*^9, 
  3.7569668157756653`*^9}},ExpressionUUID->"bb2d36fd-6360-4eea-ab9e-\
0e50c1439d99"],

Cell[CellGroupData[{

Cell["Expression, Initial shurdata and legdata;", "Subsubsection",
 CellChangeTimes->{{3.708160980088977*^9, 3.7081609935840483`*^9}, {
  3.709740680365183*^9, 3.709740709623602*^9}, {3.7097418077654047`*^9, 
  3.7097418097797203`*^9}},ExpressionUUID->"fd478802-201f-4a9c-8f60-\
48522f5fff44"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.75696269297609*^9, 3.756962744059044*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"234d1dda-4c64-43a8-bced-dd290f533820"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InitialData", "[", 
   RowBox[{"topvex_", ",", "legfac_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Vertexdata:\>\"", ";", "\[IndentingNewLine]", 
     RowBox[{"vertexdata", "=", 
      RowBox[{"aVertexdata", "[", "topvex", "]"}]}], ";", 
     "\[IndentingNewLine]", "\"\<Factor expression:\>\"", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ppp", "=", 
      RowBox[{"aPPP", "[", 
       RowBox[{"topvex", ",", "legfac"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     "\"\<Young diagrams along preferred direction:\>\"", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vlist", "=", 
      RowBox[{"varlist", "[", "topvex", "]"}]}], ";", "\[IndentingNewLine]", 
     "\"\<Shurdata comes directly from vertexdata:\>\"", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      StyleBox["shurdata",
       Background->RGBColor[1, 0.85, 0.85]], "=", 
      RowBox[{"vertexdata", "//", "aSHURDATA"}]}], ";", 
     "\[IndentingNewLine]", 
     "\"\<The legdata comes from leg factor and framing factor \>\"", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      StyleBox["legdata",
       Background->RGBColor[1, 0.85, 0.85]], "=", 
      RowBox[{"EXPRESSIONFORQ", "[", 
       RowBox[{"vertexdata", ",", "ppp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     "\"\<The double q,t-factor LEFT in the final result:\>\"", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qtleft", "=", 
      RowBox[{"EXPRESSIONFORQ2", "[", 
       RowBox[{"vertexdata", ",", "ppp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"qtZZ", "=", 
      RowBox[{"qtleft", "*", 
       RowBox[{"aZZZ", "[", "topvex", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     "\"\<Topological vertex in terms of shur functions:\>\"", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SHOWIT", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"topvex", "*", "legfac"}], "//", 
        StyleBox["RunaqCC",
         FontColor->RGBColor[1, 0.5, 0.5]]}], "//", "PowerExpand"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Young tableau left:  \>\"", ",", "   ", "vlist", ",", " ", "qtZZ",
         ",", "\"\< \>\"", ",", 
        "\"\<Topological vertex in terms of shur functions (\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0.5, \
0]]\)\!\(\*StyleBox[\"SHOWIT\",FontSize->14,FontColor->RGBColor[1, 0.5, 0]]\)\
\!\(\*StyleBox[\" \",FontSize->14,FontColor->RGBColor[1, 0.5, \
0]]\)\!\(\*StyleBox[\"=\",FontSize->14,FontColor->RGBColor[1, 0.5, 0]]\) ) :  \
\>\"", ",", "   ", "SHOWIT"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\>\"", ",", "\"\<initial legfac=\>\"", ",", " ", "legfac", ",", 
        " ", "\"\<\>\"", ",", "\"\<initial shurdata=\>\"", ",", " ", 
        "shurdata"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", " ", 
   "]"}]}]], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->{{3.700713580708763*^9, 3.700713581619011*^9}, {
   3.7007145996560297`*^9, 3.7007146664315434`*^9}, {3.700714699009728*^9, 
   3.700714762830071*^9}, 3.7007147931335917`*^9, {3.7007151050469427`*^9, 
   3.700715128776651*^9}, {3.700715832781807*^9, 3.700715843261725*^9}, {
   3.700716241242873*^9, 3.700716282843686*^9}, {3.700716389527223*^9, 
   3.700716406883206*^9}, {3.700719779136963*^9, 3.700719780299411*^9}, {
   3.700720072441866*^9, 3.7007201037630167`*^9}, {3.7007309183597393`*^9, 
   3.700730951652019*^9}, {3.700732303878694*^9, 3.7007323723809433`*^9}, 
   3.700732502403737*^9, {3.700736134051785*^9, 3.700736185261923*^9}, {
   3.7007363586639214`*^9, 3.700736360019678*^9}, {3.7007992461834373`*^9, 
   3.700799317386056*^9}, 3.700800477083775*^9, {3.700800538768085*^9, 
   3.700800539475721*^9}, 3.7008025676936207`*^9, {3.700806506851962*^9, 
   3.700806516766584*^9}, {3.7008074758766737`*^9, 3.700807478136231*^9}, 
   3.700824553059792*^9, {3.700874286813397*^9, 3.700874310574459*^9}, {
   3.7008856501540737`*^9, 3.700885676419709*^9}, {3.700885752142548*^9, 
   3.7008857848371696`*^9}, {3.700985215872547*^9, 3.700985231505126*^9}, {
   3.701322655027679*^9, 3.701322657104294*^9}, 3.701323312237974*^9, 
   3.703668316149743*^9, 3.7040172885370398`*^9, {3.7041026478665323`*^9, 
   3.704102678394713*^9}, 3.706355196331834*^9, 3.7063675667658253`*^9, 
   3.706691630383603*^9, {3.706850179011979*^9, 3.70685018003881*^9}, 
   3.7068516917229652`*^9, {3.706855194170236*^9, 3.70685519971214*^9}, 
   3.706936593964711*^9, {3.706937664093067*^9, 3.706937671151926*^9}, {
   3.706937748656823*^9, 3.706937752256613*^9}, {3.706938531428335*^9, 
   3.706938533788785*^9}, 3.70711374349794*^9, {3.707114684169121*^9, 
   3.70711468781732*^9}, 3.707115035988055*^9, {3.7073892439955482`*^9, 
   3.7073892447669783`*^9}, 3.707457937673338*^9, 3.7074579829754057`*^9, 
   3.707472352817144*^9, 3.707474146648857*^9, 3.707720415157316*^9, 
   3.707727747267294*^9, 3.707728504263846*^9, {3.707729806362952*^9, 
   3.707729824056457*^9}, 3.707731356272188*^9, 3.707731421413872*^9, 
   3.707731768628998*^9, 3.707731847900577*^9, {3.707732359453697*^9, 
   3.707732367283575*^9}, {3.707732432725011*^9, 3.707732441751935*^9}, {
   3.707733320776729*^9, 3.707733323871215*^9}, {3.707734643596657*^9, 
   3.707734645164805*^9}, 3.707735367747148*^9, 3.7077982476922626`*^9, {
   3.70780014199784*^9, 3.7078001491306*^9}, 3.70781126921371*^9, 
   3.707822147472673*^9, {3.7079072131080227`*^9, 3.707907214369439*^9}, 
   3.707907367791621*^9, 3.707909379430654*^9, {3.707909425722859*^9, 
   3.7079094269394712`*^9}, {3.707910823806037*^9, 3.7079108280032883`*^9}, {
   3.707976646412449*^9, 3.7079767020458097`*^9}, {3.707976747823402*^9, 
   3.707976752592958*^9}, 3.707977906659524*^9, {3.707978283972978*^9, 
   3.707978304149436*^9}, 3.7079922832597027`*^9, {3.707993294617972*^9, 
   3.707993302682095*^9}, {3.7079933378321447`*^9, 3.7079933694276447`*^9}, 
   3.707993473453085*^9, {3.707993544036776*^9, 3.707993548577615*^9}, {
   3.708078149106106*^9, 3.7080782108715553`*^9}, {3.708084099087344*^9, 
   3.708084102874714*^9}, {3.708592226673542*^9, 3.7085922346859703`*^9}, {
   3.708593102293679*^9, 3.708593120590331*^9}, {3.7085931526338177`*^9, 
   3.708593168038794*^9}, 3.708696994744646*^9, 3.708768556856551*^9, 
   3.708773071074511*^9, {3.7090160931855917`*^9, 3.7090161020283003`*^9}, {
   3.709016265329987*^9, 3.7090162757782383`*^9}, {3.709736823021435*^9, 
   3.709736841149454*^9}, {3.709740114624187*^9, 3.7097401168623543`*^9}, 
   3.709740177065742*^9, {3.709740258919413*^9, 3.709740289233138*^9}, {
   3.709740385808146*^9, 3.70974039487436*^9}, {3.709740446106966*^9, 
   3.7097404744575977`*^9}, {3.7097405682742233`*^9, 3.709740585370029*^9}, {
   3.709740626058236*^9, 3.70974063100209*^9}, 3.709740756568316*^9, {
   3.710058258520338*^9, 3.7100582618622713`*^9}, 3.715321895890459*^9, {
   3.717751345722148*^9, 3.717751384490539*^9}, 3.722753452639883*^9, {
   3.725519060271029*^9, 3.725519061088924*^9}, {3.7255193598616657`*^9, 
   3.725519387660852*^9}, 3.7255194526675997`*^9, 3.725519526755992*^9, {
   3.734254299534042*^9, 3.734254333823386*^9}, {3.7342544493135843`*^9, 
   3.734254463344623*^9}, {3.7401262621087008`*^9, 3.7401263021868668`*^9}, 
   3.7401322488357067`*^9, 3.740132329591917*^9, {3.7569627391370993`*^9, 
   3.756962825566741*^9}, {3.7569628901333923`*^9, 3.756963162130721*^9}, 
   3.756963274451063*^9, {3.756963341388769*^9, 3.756963437209177*^9}, {
   3.756963867737281*^9, 3.756963869186944*^9}, {3.7569640492977257`*^9, 
   3.7569640683242903`*^9}, {3.756964537215508*^9, 3.756964559824465*^9}, {
   3.7569657719912033`*^9, 3.7569658870959053`*^9}, {3.7569660806787*^9, 
   3.7569660862542763`*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[271]:=",ExpressionUUID->"08ada059-ec15-41c2-bfa2-bf4affe26090"]
}, Closed]],

Cell[CellGroupData[{

Cell["ONE CLICK to get the final result", "Subsubsection",
 CellChangeTimes->{{3.708268709570348*^9, 3.708268726589538*^9}, {
  3.70827030165149*^9, 3.708270321940383*^9}, {3.709741821144164*^9, 
  3.709741828107489*^9}},ExpressionUUID->"1ff26699-75c0-4a58-826f-\
871ba375c0ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FINALobtain", "[", 
   RowBox[{"topvex_", ",", "legfac_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", " ", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InitialData", "[", 
      RowBox[{"topvex", ",", "legfac"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<================================================\>\"",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"outputlist1", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"outputlist2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      StyleBox["For",
       FontColor->GrayLevel[0]], 
      StyleBox["[",
       FontColor->GrayLevel[0]], 
      RowBox[{
       StyleBox[
        RowBox[{"nn", "=", "1"}],
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       RowBox[{
        RowBox[{
         StyleBox["(",
          FontColor->GrayLevel[0]], 
         RowBox[{
          StyleBox["nn",
           FontColor->GrayLevel[0]], 
          StyleBox["\[LessEqual]",
           FontColor->GrayLevel[0]], 
          StyleBox["20",
           FontColor->RGBColor[1, 0, 0]]}], 
         StyleBox[")",
          FontColor->GrayLevel[0]]}], 
        StyleBox["&&",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"breakornot", "[", "shurdata", "]"}], "\[Equal]", 
           "\"\<continue\>\""}], ")"}],
         FontColor->GrayLevel[0]]}], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"nn", "++"}],
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{
         RowBox[{
          RowBox[{"outfactor", "=", 
           RowBox[{"outputroundfactor", "[", 
            RowBox[{"legdata", ",", "shurdata"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"outputlist1", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"outputlist1", ",", 
             RowBox[{"outputroundlist1", "[", 
              RowBox[{"legdata", ",", "shurdata"}], "]"}]}], "]"}]}], ";", 
          RowBox[{"outputlist2", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"outputlist2", ",", 
             RowBox[{"outputroundlist2", "[", 
              RowBox[{"legdata", ",", "shurdata"}], "]"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"legg", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"nextrounddata", "[", 
              RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "//", "Sort"}]}], ";", 
          RowBox[{"shurr", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"nextrounddata", "[", 
              RowBox[{"legdata", ",", "shurdata"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//", "Sort"}]}], ";"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"shurdata", "=", "shurr"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"legdata", "=", "legg"}], ")"}]}]}],
        FontColor->GrayLevel[0]]}], 
      StyleBox[" ",
       FontColor->GrayLevel[0]], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}], 
     StyleBox[";",
      FontColor->GrayLevel[0]], 
     StyleBox[" ",
      FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
     StyleBox["\"\<How many times it can run?\>\"",
      FontColor->GrayLevel[0]], 
     StyleBox[";",
      FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"nn", "-", "1"}],
      FontColor->GrayLevel[0]], 
     StyleBox[";",
      FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
     StyleBox["\"\<Show me these products:\>\"",
      FontColor->GrayLevel[0]], 
     StyleBox[";",
      FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
     StyleBox["outputlist2",
      FontColor->GrayLevel[0]], 
     StyleBox[";",
      FontColor->GrayLevel[0]], "\[IndentingNewLine]", "\"\<array =\>\"", ";",
      "\[IndentingNewLine]", 
     RowBox[{"array", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        StyleBox["outputlist1",
         FontColor->GrayLevel[0]], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Qqtpart", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          StyleBox[
           RowBox[{"outfactor", "*", "qtleft"}],
           FontColor->GrayLevel[0]], 
          StyleBox[")",
           FontColor->GrayLevel[0]]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ")"}], "//", 
       "SimpAll"}]}], ";", "\[IndentingNewLine]", 
     StyleBox["\"\<What is the prefactor in partition function?\>\"",
      FontColor->GrayLevel[0]], 
     StyleBox[";",
      FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
     RowBox[{"FAC", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          StyleBox[
           RowBox[{"outfactor", "*", "qtZZ"}],
           FontColor->GrayLevel[0]], 
          StyleBox[")",
           FontColor->GrayLevel[0]]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["0", "T"], "\[Rule]", "0"}], "}"}]}], ")"}], "//", 
       "SimpAll"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "/@", 
      RowBox[{"{", "      ", "\[IndentingNewLine]", 
       RowBox[{
        StyleBox["\"\<How many times it can run?\>\"",
         FontColor->GrayLevel[0]], " ", ",", "\[IndentingNewLine]", " ", 
        RowBox[{"nn", "-", "1"}]}], 
       RowBox[{"(*", 
        RowBox[{",", "\[IndentingNewLine]", 
         StyleBox["\"\<What is the prefactor in partition function?\>\"",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0]], "FAC"}], "*)"}], "\[IndentingNewLine]", 
       "    ", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"MNAB", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NabNhalf", "[", 
          RowBox[{"array", ",", "vertexdata"}], "]"}], "//", "Simphalf"}], "//",
         "Deleteone"}], "//", "PRODUCT"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<The following is the\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, \
0, 0.5],Background->RGBColor[1, 0.85, \
0.85]]\)\!\(\*StyleBox[\"final\",FontColor->RGBColor[0.5, 0, \
0.5],Background->RGBColor[1, 0.85, 0.85]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[0.5, 0, 0.5],Background->RGBColor[1, 0.85, \
0.85]]\)\!\(\*StyleBox[\"result\",FontColor->RGBColor[0.5, 0, \
0.5],Background->RGBColor[1, 0.85, 0.85]]\):\>\"", "  ", ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"FINAL", "=", 
      RowBox[{"{", 
       RowBox[{"FAC", ",", 
        RowBox[{"MNAB", "//", "onlyNNNleft"}], ",", 
        RowBox[{"MNAB", "//", "onlyMleft"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\>\"", ",", "\[IndentingNewLine]", 
        "\"\<The following is the\!\(\*StyleBox[\" \
\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"final\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"result\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"FINAL\",FontSize->16,FontColor->RGBColor[1, 0.5, \
0]]\)\!\(\*StyleBox[\" \",FontSize->16,FontColor->RGBColor[1, 0.5, \
0]]\)\!\(\*StyleBox[\"Z\",FontSize->18,FontColor->GrayLevel[0]]\)\!\(\*\
StyleBox[\"[\",FontSize->14,FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\"\\\\\",\
FontSize->14,FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\"v1\",FontSize->14,\
FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\",\",FontSize->14,FontColor->\
GrayLevel[0]]\)\!\(\*StyleBox[\"\\\\\",FontSize->14,FontColor->GrayLevel[0]]\)\
\!\(\*StyleBox[\"v2\",FontSize->14,FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\"\
,\",FontSize->14,FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\" \
\",FontSize->14,FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\"...\",FontSize->14,\
FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\" \
\",FontSize->14,FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\"]\",FontSize->14,\
FontColor->GrayLevel[0]]\)\!\(\*StyleBox[\"=\",FontSize->16,FontColor->\
GrayLevel[0]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\>\""}], "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "/@", 
      RowBox[{"{", 
       RowBox[{"FAC", ",", 
        RowBox[{"MNAB", "//", "onlyNNNleft"}], ",", 
        RowBox[{"MNAB", "//", "onlyMleft"}]}], "}"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->{{3.7082687235159607`*^9, 3.7082687235179043`*^9}, {
   3.708268847788253*^9, 3.7082689141794357`*^9}, {3.708268986081936*^9, 
   3.7082691847540903`*^9}, {3.708269221976523*^9, 3.70826925024411*^9}, {
   3.708269413635437*^9, 3.708269433095147*^9}, {3.708269818624984*^9, 
   3.7082698437949677`*^9}, {3.708269882546752*^9, 3.70826988824166*^9}, {
   3.7082700086223783`*^9, 3.7082700830052347`*^9}, 3.708270333380192*^9, 
   3.7082706354627666`*^9, 3.708271174762806*^9, {3.7090161517506847`*^9, 
   3.709016162093461*^9}, {3.709356532500173*^9, 3.709356536985358*^9}, {
   3.709356631258957*^9, 3.709356650625902*^9}, 3.709356741808743*^9, {
   3.709356915569871*^9, 3.70935691725071*^9}, 3.709357677039873*^9, {
   3.709357709653946*^9, 3.7093577139520493`*^9}, {3.709735564411322*^9, 
   3.709735574785836*^9}, 3.709737214184772*^9, 3.709737499172254*^9, {
   3.709737640468767*^9, 3.7097376432702847`*^9}, {3.709737707663272*^9, 
   3.7097377119236813`*^9}, {3.709737750532613*^9, 3.709737754923905*^9}, {
   3.709737793845978*^9, 3.709737800637768*^9}, {3.709738162833123*^9, 
   3.709738200043125*^9}, {3.709738716603529*^9, 3.709738810538409*^9}, {
   3.7097391516792173`*^9, 3.709739152181271*^9}, {3.7097411031084433`*^9, 
   3.709741137812827*^9}, {3.710058268534051*^9, 3.71005827417353*^9}, {
   3.710065251911456*^9, 3.710065256770194*^9}, {3.7100652871876717`*^9, 
   3.710065315122663*^9}, {3.716017910126461*^9, 3.7160179295251713`*^9}, {
   3.71611713887649*^9, 3.716117177977538*^9}, {3.716117215462867*^9, 
   3.71611724578517*^9}, {3.7164451675284863`*^9, 3.7164452071926928`*^9}, {
   3.7170691490794077`*^9, 3.717069151673975*^9}, {3.7171236941272*^9, 
   3.717123696330591*^9}, {3.717131838643271*^9, 3.7171318515672894`*^9}, {
   3.717222069527216*^9, 3.717222072427791*^9}, {3.717227918721403*^9, 
   3.7172279323259907`*^9}, {3.717849368635469*^9, 3.717849393155816*^9}, {
   3.718508798385346*^9, 3.718508834904031*^9}, {3.7204332217688103`*^9, 
   3.720433222267489*^9}, {3.723020853167577*^9, 3.7230208588054533`*^9}, 
   3.725440340789975*^9, 3.725440377923661*^9, 3.7255284358416243`*^9, {
   3.725528494982016*^9, 3.7255284959819202`*^9}, {3.7281268842946777`*^9, 
   3.7281269059155912`*^9}, 3.728126963068976*^9, {3.7281293935547247`*^9, 
   3.728129394046115*^9}, {3.740132192946445*^9, 3.740132194449378*^9}, {
   3.756963168470188*^9, 3.7569631862467003`*^9}, {3.756964630355081*^9, 
   3.7569648262306023`*^9}, {3.756964926555085*^9, 3.756964936449027*^9}, {
   3.756965154409102*^9, 3.756965427881723*^9}, {3.756965524634589*^9, 
   3.7569657086019278`*^9}, 3.7569659887885723`*^9, {3.7569661389836817`*^9, 
   3.756966178415546*^9}, {3.756966249126809*^9, 3.756966312960746*^9}, 
   3.756966448907569*^9, {3.756966525075878*^9, 3.756966707151622*^9}},
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[272]:=",ExpressionUUID->"838e8830-6ea6-4947-a841-6cc82434561b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.717904371028859*^9, 3.7179043733385763`*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"2bf27998-35c5-47e1-86dc-0c7ee9a63b5b"]
}, Closed]]
}, Open  ]]
},
WindowSize->{1096, 760},
WindowMargins->{{-1467, Automatic}, {Automatic, 34}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 174, 3, 56, "Subsubsection",ExpressionUUID->"3214bd52-3ac3-470e-9c33-0eb339b98617"],
Cell[CellGroupData[{
Cell[757, 27, 155, 3, 46, "Subsection",ExpressionUUID->"4e0797a1-2331-4584-b85a-d10ee4232820"],
Cell[915, 32, 252, 4, 44, "Text",ExpressionUUID->"05bfe0f4-8cc2-48b3-9057-d662e710c60b"],
Cell[1170, 38, 5072, 77, 1079, "Text",ExpressionUUID->"c975a68a-856f-4a45-8cde-b9a3ded771d2"]
}, Closed]],
Cell[CellGroupData[{
Cell[6279, 120, 873, 26, 48, "Subsection",ExpressionUUID->"bd703a7a-d36a-4a87-b558-025cf0e64b1d"],
Cell[7155, 148, 2929, 75, 220, "Input",ExpressionUUID->"f3cc5a72-9a3c-40a8-9053-eca80c5c9a71"],
Cell[10087, 225, 40046, 1036, 1883, "Input",ExpressionUUID->"ffe5f990-4c7a-4bcc-b430-1e65383dadf0"],
Cell[50136, 1263, 5669, 146, 714, "Input",ExpressionUUID->"2bb79a27-c23c-411c-ac61-c346824d7d59"],
Cell[55808, 1411, 6596, 161, 367, "Input",ExpressionUUID->"bf8ad9cc-dd40-4da0-9c83-bcca42880762"],
Cell[CellGroupData[{
Cell[62429, 1576, 278, 4, 56, "Subsubsection",ExpressionUUID->"b68e8413-6b3a-4dca-9e13-185747fb72f2"],
Cell[62710, 1582, 1584, 51, 84, "Input",ExpressionUUID->"e322785c-cc48-49b6-b078-1532421ff188"],
Cell[64297, 1635, 19467, 535, 1260, "Input",ExpressionUUID->"1c3ba418-116d-46e1-a657-edb64a2c18c8"],
Cell[83767, 2172, 978, 27, 67, "Input",ExpressionUUID->"0d989743-2413-455d-ab01-fa9c72b93c80"],
Cell[84748, 2201, 952, 26, 90, "Input",ExpressionUUID->"af776400-ea2e-4fc1-8362-aa130c86d32d"],
Cell[85703, 2229, 197, 3, 37, "Input",ExpressionUUID->"2b17ee49-2fd2-4950-bdba-481acdfed134"],
Cell[85903, 2234, 322, 6, 44, "Text",ExpressionUUID->"4a98b62a-5089-414a-bf02-9fb453051978"],
Cell[86228, 2242, 1268, 34, 98, "Input",ExpressionUUID->"2aaad92f-e05d-44df-b18d-55bff2e8c5eb"],
Cell[87499, 2278, 3135, 52, 44, "Input",ExpressionUUID->"a8cf7b71-c1d9-49be-b688-0af6afc25cdc"],
Cell[90637, 2332, 202, 3, 48, "Input",ExpressionUUID->"0ca4a6c9-0f6b-4989-89c2-e60414764d56"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90888, 2341, 428, 7, 67, "Subsection",ExpressionUUID->"3f61200c-ce8b-42b6-ab59-9fced51262a1"],
Cell[CellGroupData[{
Cell[91341, 2352, 1032, 28, 57, "Subsubsection",ExpressionUUID->"12cc1a4c-c7aa-4343-84f5-186f081abb49"],
Cell[92376, 2382, 1869, 54, 126, "Input",ExpressionUUID->"af49a1ad-0e28-479b-8598-21fcf1d38962"],
Cell[94248, 2438, 2608, 62, 224, "Input",ExpressionUUID->"43b37b0d-bfcb-4e67-a41f-2e7c20f8f617"],
Cell[96859, 2502, 1287, 33, 182, "Input",ExpressionUUID->"5b1b76b4-2c57-45b2-8fd4-c019835edc8b"],
Cell[98149, 2537, 1927, 47, 224, "Input",ExpressionUUID->"fa4656e4-b5ee-48c5-ba95-5846667ebe47"],
Cell[100079, 2586, 1447, 36, 98, "Input",ExpressionUUID->"34a9967c-f132-4eab-bad3-cdc771ba90e3"],
Cell[101529, 2624, 1457, 36, 119, "Input",ExpressionUUID->"546c6362-22f7-43d6-b087-6075b0a46c58"],
Cell[102989, 2662, 2104, 48, 182, "Input",ExpressionUUID->"0d8ff165-1cae-45f3-942e-e94d65a6b2ee"],
Cell[105096, 2712, 1526, 39, 203, "Input",ExpressionUUID->"23fbd455-f7ed-48f3-bae5-1c004cd51a62"],
Cell[106625, 2753, 2864, 74, 182, "Input",ExpressionUUID->"21383879-e2c1-468e-9c8a-08dd4d496b67"],
Cell[109492, 2829, 1422, 37, 182, "Input",ExpressionUUID->"560ccb39-22ab-4af7-8c36-88fa4254b1e6"],
Cell[110917, 2868, 842, 18, 119, "Input",ExpressionUUID->"b2fe07ef-9b80-4fb3-85ad-8ed431479874"],
Cell[111762, 2888, 2716, 69, 204, "Input",ExpressionUUID->"dccb4874-91ca-43a0-b456-65814d8ce538"],
Cell[114481, 2959, 3358, 79, 420, "Input",ExpressionUUID->"df18e937-3211-4eab-9d1b-ef5f290732b5"],
Cell[117842, 3040, 3253, 78, 323, "Input",ExpressionUUID->"12b348bf-115f-421e-9cee-4f03d3677046"],
Cell[121098, 3120, 2935, 76, 323, "Input",ExpressionUUID->"7295e98e-4fa6-49af-ab9a-ae61f1476b6a"],
Cell[124036, 3198, 1142, 28, 119, "Input",ExpressionUUID->"40f8cf9b-3651-4202-9a59-8149a8c5497c"],
Cell[125181, 3228, 4271, 91, 245, "Input",ExpressionUUID->"6d6d07be-0054-4751-b6ec-91c3fe65028b"],
Cell[129455, 3321, 3625, 87, 287, "Input",ExpressionUUID->"af2c487e-9699-44f3-9212-57a4f922b162"],
Cell[133083, 3410, 171, 2, 35, "Input",ExpressionUUID->"663df8da-e06b-443e-bf9e-c7ed006ff981"],
Cell[133257, 3414, 2796, 67, 267, "Input",ExpressionUUID->"f3d491fd-82f6-4fe0-9331-bd402d6336d5"],
Cell[136056, 3483, 5600, 130, 371, "Input",ExpressionUUID->"c87236df-0d7b-4f1b-b4d6-3ca508c77073"],
Cell[141659, 3615, 849, 20, 77, "Input",ExpressionUUID->"0f59e6bb-ae0c-4ba6-963d-3d7e232706ee"],
Cell[142511, 3637, 721, 16, 77, "Input",ExpressionUUID->"6f769c1a-41dc-46ee-9937-bfc11ec03b6d"],
Cell[143235, 3655, 494, 12, 57, "Input",ExpressionUUID->"f08a1627-e325-4915-b516-e6f098b71dd7"],
Cell[143732, 3669, 3741, 86, 308, "Input",ExpressionUUID->"a824adba-3892-41ce-b87b-9186ff656f7e"],
Cell[147476, 3757, 359, 8, 36, "Input",ExpressionUUID->"b9610b0f-162c-48a7-b7e1-c9314282b7e0"],
Cell[147838, 3767, 2083, 52, 225, "Input",ExpressionUUID->"66444588-4396-4767-9cfd-6da6bb921ad6"],
Cell[149924, 3821, 474, 12, 36, "Input",ExpressionUUID->"d9f0ae8f-6caa-49ab-9cdc-a97064286902"],
Cell[150401, 3835, 444, 10, 36, "Input",ExpressionUUID->"7d445c8c-2d12-465b-9d67-fe143e45f319"],
Cell[150848, 3847, 710, 17, 57, "Input",ExpressionUUID->"5989b6a8-7790-4ca9-a3e2-76b3be7ed260"],
Cell[151561, 3866, 2299, 59, 267, "Input",ExpressionUUID->"8ecc5067-58b2-4b1a-9625-6b05378cf142"],
Cell[153863, 3927, 1020, 26, 120, "Input",ExpressionUUID->"1e33b7ce-76d7-470c-8583-6b67d02194a1"],
Cell[154886, 3955, 1368, 35, 183, "Input",ExpressionUUID->"42b6f39d-333a-49d5-bff0-8f921f01747a"],
Cell[156257, 3992, 678, 16, 120, "Input",ExpressionUUID->"5e9a3312-328d-4749-9ed2-363fc92b09ce"],
Cell[156938, 4010, 923, 20, 140, "Input",ExpressionUUID->"2ee92cc0-3da5-482c-b611-8db66e75635d"],
Cell[157864, 4032, 572, 14, 98, "Input",ExpressionUUID->"b1d32c86-f133-4c58-b392-4bd710726434"],
Cell[158439, 4048, 373, 8, 57, "Input",ExpressionUUID->"c63b549a-26fa-479f-a2e1-14e4411cd016"],
Cell[158815, 4058, 721, 18, 78, "Input",ExpressionUUID->"082aa43d-7a32-476a-adb2-a47a4d4c411b"],
Cell[159539, 4078, 173, 3, 35, "Input",ExpressionUUID->"3d13284f-5a84-44fa-9530-afe7add680d0"],
Cell[159715, 4083, 8432, 204, 981, "Input",ExpressionUUID->"13290486-0f4b-48fd-9a7c-524fc4ada8cc"],
Cell[168150, 4289, 957, 24, 57, "Input",ExpressionUUID->"ec686a75-c0b5-4645-af2c-48636462579a"],
Cell[169110, 4315, 4951, 95, 413, "Input",ExpressionUUID->"39be2f2f-126e-480e-a829-3f3e3e0a283b"],
Cell[174064, 4412, 4292, 121, 435, "Input",ExpressionUUID->"a43939af-889f-4445-9472-07b750962d32"],
Cell[178359, 4535, 404, 6, 35, "Input",ExpressionUUID->"72fb5ac5-bc74-47a8-be3e-81acb44ffb61"],
Cell[178766, 4543, 203, 4, 35, "Input",ExpressionUUID->"3989400f-96fa-4050-b7c9-a33e271523b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[179006, 4552, 1008, 22, 46, "Subsubsection",ExpressionUUID->"8be33388-d641-4bd0-99cd-d07b7d4bfb40"],
Cell[180017, 4576, 413, 8, 73, "Text",ExpressionUUID->"5d8a9e3d-ddd1-42ec-b3d3-c275a388b95a"],
Cell[180433, 4586, 15324, 306, 786, "Input",ExpressionUUID->"3831c647-3d57-4c49-83cd-b77412073478"],
Cell[195760, 4894, 1728, 46, 194, "Input",ExpressionUUID->"5cc55a41-a17b-41d2-8828-25dd8c56f329"],
Cell[197491, 4942, 3313, 95, 220, "Input",ExpressionUUID->"67ed5eb9-7b9a-4f45-9720-7a28b60d6566"],
Cell[200807, 5039, 8564, 239, 420, "Input",ExpressionUUID->"903a3316-62da-4e99-8876-7d3346c3349b"],
Cell[209374, 5280, 1299, 32, 90, "Input",ExpressionUUID->"bc793853-d155-4a8c-a55a-96cf5c6429e4"],
Cell[210676, 5314, 2589, 68, 350, "Input",ExpressionUUID->"dad58319-bfb4-4c62-93a7-c72d0b5fe1e5"],
Cell[213268, 5384, 5050, 126, 532, "Input",ExpressionUUID->"2e61f99f-240a-4e84-9c2a-fcce1237a301"],
Cell[218321, 5512, 471, 12, 37, "Input",ExpressionUUID->"95975546-00fd-41ca-a4c3-a942bafa4d33"],
Cell[218795, 5526, 15688, 393, 785, "Input",ExpressionUUID->"5f381b8e-d3a9-49f5-8e30-f0e98f66bc92"],
Cell[234486, 5921, 3677, 101, 480, "Input",ExpressionUUID->"34cc11a2-1053-4907-9157-d4825acf622e"],
Cell[238166, 6024, 10213, 235, 706, "Input",ExpressionUUID->"bf176596-b39c-42d9-a151-ec21e9bf747e"],
Cell[248382, 6261, 639, 20, 40, "Input",ExpressionUUID->"62b26c92-7bdf-4aff-891e-3a138f58b24b"],
Cell[249024, 6283, 2066, 53, 168, "Input",ExpressionUUID->"79297947-f24f-402e-b926-3b69b94abbd9"],
Cell[251093, 6338, 868, 24, 64, "Input",ExpressionUUID->"956683b4-8790-452e-b45e-ab9dc754a153"],
Cell[251964, 6364, 5195, 125, 444, "Input",ExpressionUUID->"d06c6859-99bd-44dd-b2a4-a8bd2d374201"],
Cell[257162, 6491, 310, 8, 37, "Input",ExpressionUUID->"4ecfa6ff-8969-4792-906e-c7dc7d655850"],
Cell[257475, 6501, 1336, 35, 168, "Input",ExpressionUUID->"fd434012-b253-4bc4-a663-9859bb82aecd"],
Cell[258814, 6538, 438, 11, 37, "Input",ExpressionUUID->"261b02a6-7bba-4952-b7b5-46d042af4731"],
Cell[259255, 6551, 1236, 31, 56, "Input",ExpressionUUID->"816a5e5b-1ddd-49a1-9cd3-92ce555c3019"],
Cell[260494, 6584, 364, 10, 37, "Input",ExpressionUUID->"9c810013-5640-4f15-9499-96a9db31e0e2"],
Cell[260861, 6596, 298, 7, 37, "Input",ExpressionUUID->"41e09532-2726-4fe3-a6e5-7f87cb4a5e97"],
Cell[261162, 6605, 447, 11, 64, "Input",ExpressionUUID->"6bdadd22-70f5-443a-a6f7-a7382f29d4d8"],
Cell[261612, 6618, 1067, 29, 53, "Input",ExpressionUUID->"19ea6730-31e6-4a27-a153-9d793f2b1853"],
Cell[262682, 6649, 2410, 58, 272, "Input",ExpressionUUID->"e860c54f-8caa-413a-a24f-48b6488589ec"],
Cell[265095, 6709, 1328, 34, 120, "Input",ExpressionUUID->"89002346-3eba-43e0-9f5d-91ccaacbe04d"],
Cell[266426, 6745, 4712, 118, 267, "Input",ExpressionUUID->"f828e5c3-fab7-46eb-a56e-4c24c44ebd4e"],
Cell[271141, 6865, 700, 20, 57, "Input",ExpressionUUID->"99c6ae48-de3c-4634-af3d-121a56568263"],
Cell[271844, 6887, 1222, 33, 57, "Input",ExpressionUUID->"5433df2e-5b7a-4bd4-9bd4-c82be092b780"],
Cell[273069, 6922, 871, 28, 59, "Input",ExpressionUUID->"fdaf58c2-097d-4bc0-abf3-d57584f08171"],
Cell[273943, 6952, 3388, 89, 206, "Input",ExpressionUUID->"dcbeef48-431c-4d37-9062-62a777368139"]
}, Closed]],
Cell[CellGroupData[{
Cell[277368, 7046, 1269, 34, 46, "Subsubsection",ExpressionUUID->"29eb897d-60e6-4066-967b-44d2e08a6fd5"],
Cell[278640, 7082, 1217, 34, 141, "Input",ExpressionUUID->"26ee2ef5-b8e9-48ca-b98f-b1f4a1390761"],
Cell[279860, 7118, 675, 20, 91, "Input",ExpressionUUID->"80ad42d2-ae74-43b2-a70d-44110a79af26"],
Cell[280538, 7140, 1332, 33, 141, "Input",ExpressionUUID->"3358e642-c7e4-4871-b461-d222cb36f77c"],
Cell[281873, 7175, 347, 8, 36, "Input",ExpressionUUID->"a6092b6e-90b3-44ca-abdb-fade87c898ce"],
Cell[282223, 7185, 1292, 40, 130, "Input",ExpressionUUID->"ffbcfbe3-c062-41df-b9a8-20a1ef1c38a3"],
Cell[283518, 7227, 6917, 179, 290, "Input",ExpressionUUID->"2eda1c8c-717e-451f-bafe-e43a05d2cced"],
Cell[290438, 7408, 1286, 36, 78, "Input",ExpressionUUID->"11b3da7e-cf4c-4324-a3ad-45a51d5eda8d"],
Cell[291727, 7446, 610, 15, 100, "Input",ExpressionUUID->"2f00da7e-737a-4cdb-944b-0b86c471b569"],
Cell[292340, 7463, 2661, 70, 246, "Input",ExpressionUUID->"4599be47-511e-48dd-98c8-bff0f346b21d"],
Cell[295004, 7535, 3541, 85, 500, "Input",ExpressionUUID->"93dcace3-8d0f-4d82-80f3-c6b9dbc41140"],
Cell[298548, 7622, 1601, 27, 324, "Input",ExpressionUUID->"f10b023e-8d3b-4452-817f-ec1a4abe6f8f"],
Cell[300152, 7651, 1236, 27, 162, "Input",ExpressionUUID->"2eda8466-65ed-43a5-86cc-44733b8b3767"]
}, Closed]],
Cell[CellGroupData[{
Cell[301425, 7683, 975, 27, 53, "Subsubsection",ExpressionUUID->"89fde45b-1557-4ee8-8318-5f1b0db2ae2f"],
Cell[302403, 7712, 757, 20, 57, "Input",ExpressionUUID->"da9ee60f-6f1f-420c-876b-9ab326def970"],
Cell[303163, 7734, 986, 28, 57, "Input",ExpressionUUID->"48f4fa0e-bc22-4119-ab5f-4f17203cec34"],
Cell[304152, 7764, 868, 13, 35, "Input",ExpressionUUID->"8553c100-4568-4b58-b4cd-0292f106f8ad"],
Cell[305023, 7779, 1762, 46, 183, "Input",ExpressionUUID->"6081e5d1-159c-4eb1-b810-020a7785b7d5"],
Cell[306788, 7827, 555, 16, 78, "Input",ExpressionUUID->"0c392c0d-5cb9-4f22-8cb6-ac3542cc292e"],
Cell[307346, 7845, 1836, 46, 204, "Input",ExpressionUUID->"5e9710b1-5f27-4e14-8be9-b23ef038cd8f"],
Cell[309185, 7893, 600, 15, 99, "Input",ExpressionUUID->"c404399d-ab41-4cac-9d9f-7d6e7f9643b6"],
Cell[309788, 7910, 264, 6, 36, "Input",ExpressionUUID->"5c742ec3-eb2b-4f89-b4f5-c3be5496737d"],
Cell[310055, 7918, 1021, 24, 99, "Input",ExpressionUUID->"94c70571-f792-4c86-b64f-1a9d62e3c42b"],
Cell[311079, 7944, 916, 24, 120, "Input",ExpressionUUID->"e5e884f3-4238-4cac-a94f-3625b528e8c8"],
Cell[311998, 7970, 1130, 25, 36, "Input",ExpressionUUID->"c2119da8-9851-44df-a557-6366e2c9bec4"],
Cell[313131, 7997, 1116, 25, 36, "Input",ExpressionUUID->"7b166256-7332-4c17-a092-090b9e1dee5a"],
Cell[314250, 8024, 2362, 59, 62, "Input",ExpressionUUID->"9abaf999-6504-4e36-a9c4-44d8b5d72dff"],
Cell[316615, 8085, 2023, 60, 95, "Input",ExpressionUUID->"72b4bd32-380b-474e-a0d6-07979309bdc6"],
Cell[318641, 8147, 1466, 44, 98, "Input",ExpressionUUID->"072e3cfb-082d-47e7-889b-082421c63b4c"],
Cell[320110, 8193, 1118, 34, 65, "Input",ExpressionUUID->"40245f41-0339-4a9e-95c2-a80f7a6e0a51"],
Cell[321231, 8229, 1942, 50, 133, "Input",ExpressionUUID->"9d6ebafe-98c0-4828-a473-7b7e867c5fec"],
Cell[323176, 8281, 1798, 46, 141, "Input",ExpressionUUID->"b015ebb2-02de-41a8-967e-c267a76d4f04"],
Cell[324977, 8329, 2694, 60, 141, "Input",ExpressionUUID->"10d41831-8d35-4247-8764-c1d8be334c4b"],
Cell[327674, 8391, 2001, 53, 162, "Input",ExpressionUUID->"6633b3aa-7c03-481e-9223-989a81197b73"],
Cell[329678, 8446, 1162, 24, 36, "Input",ExpressionUUID->"e46c373b-6e3f-4757-971c-0663c57d0aa9"],
Cell[330843, 8472, 638, 18, 36, "Input",ExpressionUUID->"5bc2e177-ed22-47ce-9add-be90588716c5"],
Cell[331484, 8492, 1551, 40, 120, "Input",ExpressionUUID->"3b52e5d2-977f-44db-a248-f814ebd24fd6"],
Cell[333038, 8534, 1055, 26, 120, "Input",ExpressionUUID->"bc4e21cc-0830-4fe6-bbfa-efb2b3743041"],
Cell[334096, 8562, 715, 23, 65, "Text",ExpressionUUID->"e84e20ad-76c2-4a94-b128-9ca2ffca807a"],
Cell[334814, 8587, 2767, 65, 141, "Input",ExpressionUUID->"9d539127-1f95-4d83-bbb4-8328f2a0a30a"],
Cell[337584, 8654, 1001, 25, 99, "Input",ExpressionUUID->"8260016e-95f7-4a41-b931-c7ac965102bf"],
Cell[338588, 8681, 207, 4, 46, "Input",ExpressionUUID->"9b4d37df-6d50-49c4-b2ec-fcdd44230d54"],
Cell[338798, 8687, 1077, 24, 120, "Input",ExpressionUUID->"749cc1ef-5ae3-4eab-9670-396e6f3a535f"],
Cell[339878, 8713, 172, 3, 57, "Input",ExpressionUUID->"4afb0911-8851-465e-80e4-8fd50ebffb1f"],
Cell[340053, 8718, 314, 5, 37, "Text",ExpressionUUID->"ef4ab8bc-4568-4a33-aa91-315ef300ae0b"],
Cell[340370, 8725, 1110, 29, 77, "Input",ExpressionUUID->"56269d88-d28a-430f-aa61-334eedac4915"],
Cell[341483, 8756, 846, 24, 36, "Input",ExpressionUUID->"6a122597-5c97-433c-bfb2-193715c7a44b"],
Cell[342332, 8782, 3161, 80, 245, "Input",ExpressionUUID->"11819c41-83a2-477f-aba2-fd7ccecdf07c"],
Cell[345496, 8864, 1563, 41, 183, "Input",ExpressionUUID->"8ff9edb6-e0ec-43ad-bfa9-56e1dc1fa8a1"],
Cell[347062, 8907, 2444, 64, 246, "Input",ExpressionUUID->"fdbdb89c-d123-49f9-b708-7dec98fed90a"],
Cell[349509, 8973, 3255, 84, 309, "Input",ExpressionUUID->"dd1bf1c8-a23d-4eec-b42e-01902324b75e"],
Cell[352767, 9059, 9211, 229, 750, "Input",ExpressionUUID->"7fbe975f-a45a-42c1-bba8-e55f9dd980f5"],
Cell[361981, 9290, 12724, 312, 1023, "Input",ExpressionUUID->"562c0b89-fdc3-4ce4-b13f-ae0b6984af36"],
Cell[374708, 9604, 7731, 189, 582, "Input",ExpressionUUID->"077049df-bd28-481a-a156-fa6316a147d1"],
Cell[382442, 9795, 8650, 209, 624, "Input",ExpressionUUID->"22e33c87-0cd8-4be7-94f1-2ec457e512ad"],
Cell[391095, 10006, 72640, 1707, 5142, "Input",ExpressionUUID->"a4b0b52b-e1b5-4827-9116-a2fbc0b3c281"],
Cell[463738, 11715, 654, 19, 36, "Input",ExpressionUUID->"c721b82f-c29c-44e7-9b58-d1698c796b6e"],
Cell[464395, 11736, 165, 3, 37, "Text",ExpressionUUID->"e691e7dd-912d-4ef4-94e9-3c81c7e583a2"],
Cell[464563, 11741, 1914, 48, 182, "Input",ExpressionUUID->"8a1a9595-f675-44a9-945a-004362230ad1"],
Cell[466480, 11791, 1012, 30, 119, "Input",ExpressionUUID->"aa210305-1556-4953-acec-89221d5525e8"],
Cell[467495, 11823, 404, 10, 36, "Input",ExpressionUUID->"4344f663-f75c-4387-855b-e51a825e4dcd"],
Cell[467902, 11835, 170, 3, 57, "Input",ExpressionUUID->"1648fc23-e9fc-48e0-9f89-c34e810f9937"],
Cell[468075, 11840, 164, 3, 37, "Text",ExpressionUUID->"2c81c04b-371c-44fe-a869-ea42a1cadd62"],
Cell[468242, 11845, 1780, 41, 141, "Input",ExpressionUUID->"f36884c1-25ec-467c-a4ec-9085e95b83f4"],
Cell[470025, 11888, 5305, 118, 773, "Input",ExpressionUUID->"56b28101-713d-40eb-8c90-36e8dbdf2490"],
Cell[475333, 12008, 4081, 98, 266, "Input",ExpressionUUID->"2611fc29-1ea4-4ee1-adc9-60d82e66e5e3"],
Cell[479417, 12108, 1048, 29, 140, "Input",ExpressionUUID->"0caa264d-8255-4552-a057-b70e135bc4df"],
Cell[480468, 12139, 4422, 106, 266, "Input",ExpressionUUID->"42f8ae92-d271-4857-b84b-0ff60885e154"],
Cell[484893, 12247, 1546, 41, 141, "Input",ExpressionUUID->"9c77a754-2341-476b-962e-b8a15d1e00fc"]
}, Closed]],
Cell[CellGroupData[{
Cell[486476, 12293, 223, 4, 45, "Subsubsection",ExpressionUUID->"c7bfacfd-08e4-42d8-aef6-74e6aa83a162"],
Cell[486702, 12299, 1072, 31, 99, "Input",ExpressionUUID->"dd0213b3-60c6-4be1-9696-c313736fbe37"],
Cell[487777, 12332, 4512, 133, 429, "Input",ExpressionUUID->"533652da-bb79-49cf-89e3-4a571e2734c6"],
Cell[492292, 12467, 423, 12, 40, "Text",ExpressionUUID->"6309337a-5e17-47d2-b33f-1b6a52861d3e"],
Cell[492718, 12481, 2114, 56, 161, "Input",ExpressionUUID->"523e5263-1b94-4491-b523-6a2485b55c47"],
Cell[494835, 12539, 174, 3, 35, "Input",ExpressionUUID->"d8d0e5ab-ef64-4f33-9623-72f5a282808b"],
Cell[495012, 12544, 859, 20, 77, "Input",ExpressionUUID->"9450b70a-e2ec-4981-9715-eae5ddb0d62d"],
Cell[495874, 12566, 424, 12, 36, "Input",ExpressionUUID->"f3a39ea1-fc1f-412e-b25d-581db29828c8"],
Cell[496301, 12580, 1276, 37, 161, "Input",ExpressionUUID->"6f12e30b-40e0-4b89-bee9-47bc8c5bba4b"]
}, Closed]],
Cell[CellGroupData[{
Cell[497614, 12622, 620, 15, 53, "Subsubsection",ExpressionUUID->"0f137fdb-8857-4067-b77f-e843e5587af9"],
Cell[498237, 12639, 256, 6, 37, "Text",ExpressionUUID->"7cf00b3f-1346-45ae-adad-0e82f9abaf34"],
Cell[498496, 12647, 3667, 96, 415, "Input",ExpressionUUID->"fbefb1a1-a637-4b7e-b909-e48eff3e4008"],
Cell[502166, 12745, 1327, 36, 162, "Input",ExpressionUUID->"c3e1c8f5-a70b-4cb3-839b-f8157e389d60"]
}, Closed]],
Cell[CellGroupData[{
Cell[503530, 12786, 157, 3, 45, "Subsubsection",ExpressionUUID->"7cf6b7ff-2172-4644-9250-e8a50c366703"],
Cell[503690, 12791, 857, 22, 106, "Input",ExpressionUUID->"71545a9d-741d-4483-8e89-1eb88b470688"]
}, Closed]],
Cell[CellGroupData[{
Cell[504584, 12818, 159, 3, 45, "Subsubsection",ExpressionUUID->"eef0be72-1ea2-4b12-8252-5e50fc98e936"],
Cell[504746, 12823, 5399, 161, 458, "Input",ExpressionUUID->"37b7670a-f878-4a3b-a876-a5601c563e9c"],
Cell[510148, 12986, 1733, 28, 322, "Input",ExpressionUUID->"b94fff76-2e15-4624-a961-ba8eed755517"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[511930, 13020, 159, 3, 67, "Subsection",ExpressionUUID->"82d8fdaf-c6f6-4287-87ae-85d6374d74e6"],
Cell[512092, 13025, 8424, 274, 832, "Input",ExpressionUUID->"66670448-d337-426c-8735-4862a86be3b4"],
Cell[520519, 13301, 154, 3, 60, "Input",ExpressionUUID->"ae93b09c-5b10-437b-a937-5f6307e8756b"]
}, Closed]],
Cell[CellGroupData[{
Cell[520710, 13309, 175, 3, 46, "Subsection",ExpressionUUID->"bb2d36fd-6360-4eea-ab9e-0e50c1439d99"],
Cell[CellGroupData[{
Cell[520910, 13316, 293, 4, 56, "Subsubsection",ExpressionUUID->"fd478802-201f-4a9c-8f60-48522f5fff44"],
Cell[521206, 13322, 174, 3, 37, "Input",ExpressionUUID->"234d1dda-4c64-43a8-bced-dd290f533820"],
Cell[521383, 13327, 8067, 143, 631, "Input",ExpressionUUID->"08ada059-ec15-41c2-bfa2-bf4affe26090"]
}, Closed]],
Cell[CellGroupData[{
Cell[529487, 13475, 278, 4, 45, "Subsubsection",ExpressionUUID->"1ff26699-75c0-4a58-826f-871ba375c0ae"],
Cell[529768, 13481, 12085, 272, 1090, "Input",ExpressionUUID->"838e8830-6ea6-4947-a841-6cc82434561b"],
Cell[541856, 13755, 177, 3, 37, "Input",ExpressionUUID->"2bf27998-35c5-47e1-86dc-0c7ee9a63b5b"]
}, Closed]]
}, Open  ]]
}
]
*)

